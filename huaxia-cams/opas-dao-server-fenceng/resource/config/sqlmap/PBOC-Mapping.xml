<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="PBOC">
  <resultMap id="resultSummaryInfo" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoScBzk" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr" jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon" jdbcType="VARCHAR" />
		<result column="PAY_COMP1" property="payCompZ" jdbcType="VARCHAR" />
		<result column="PAY_STATUS1" property="payStatusZ" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME1" property="infoUpdTimeZ" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDepositZ" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRateZ" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="PERSONCOMPRATE" property="personCompRate" jdbcType="VARCHAR" />
		<result column="PAY_COMP2" property="payCompY" jdbcType="VARCHAR" />
		<result column="PAY_STATUS2" property="payStatusY" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME2" property="infoUpdTimeY" jdbcType="VARCHAR" />
		<result column="CUR_MPAY_AMT" property="curMpayAmtY" jdbcType="VARCHAR" />
		<result column="PERSON_PAY_BASE" property="personPayBaseY" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoZxSpBzk" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company1" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr1" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME1" property="infoUpdTime1" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME2" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="PERSONCOMPRATE" property="personCompRate" jdbcType="VARCHAR" />
		<result column="NO_PD_CARD_BANK_MAX_CREDIT_LIM" property="noPdCardBankMaxCreditLim" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="resultSummaryInfoZxSpBzk2" type="java.util.Map">
		<result column="COMPANY" property="company2" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr2" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime2" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoYdj" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company1" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr1" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime1" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME2" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="PERSONCOMPRATE" property="personCompRate" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_ACCT_NUM" property="loanOverDueAcctNum" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_MONTH_NUM" property="loanOverDueMonthNum" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_OVER_DUE_AMT" property="loanOverDueOverDueAmt" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_LONGEST_OVER_DUE" property="loanOverDueLongestOverDue" jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_ACCT_NUM" property="debitCardOverDueAcctNum" jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_MONTH_NUM" property="debitCardOverDueMonthNum" jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_OVER_DUE_AMT" property="debitCoDueOverDueAmt" jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_LONGEST_OVER_DUE" property="debitCoDueLongestOverDue" jdbcType="VARCHAR" />
	</resultMap>

	<!-- 查询人行的家庭住址和单位地址用于录入审查比对页面匹配账单地址wangtao -->
	<select id="queryThirtyAddress" resultType="java.util.Map">
		select 	APP_ID,LST_UPD_TIME,RESIDENT_ADDR,COMP_ADDR from (
			select t1.APP_ID,t1.LST_UPD_TIME,t2.RESIDENT_ADDR,t3.COMP_ADDR
			from OPAS_PBOC_PERSONAL_INFO t1
			left join OPAS_PBOC_RESIDENCE_INFO t2 on t1.APP_ID = t2.APP_ID
			left join OPAS_PBOC_PROFESSION_INFO t3 on t3.APP_ID = t3.APP_ID
			where t1.APP_ID = #{appId,jdbcType=VARCHAR} 
			order by t1.LST_UPD_TIME desc
		)
		where rownum = 1
	</select>
	
<!-- 人行摘要信息-标准卡审查 -->
	<select id="querySummaryInfoScBzk" parameterType="java.lang.String"
		resultMap="resultSummaryInfoScBzk">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t1.resi_tel,
               t1.communication_addr,
               TO_CHAR(TO_DATE(t1.query_req_time,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') AS query_req_time,
               t2.company,
               t2.comp_addr,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'),'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp AS pay_comp1,
               t4.pay_status AS pay_status1,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time1,
               t4.monthly_deposit,
               t4.person_deposit_rate,
               t5.pay_comp AS pay_comp2,
               t5.pay_status AS pay_status2,
               TO_CHAR(TO_DATE(t5.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t5.cur_mpay_amt,
               t5.person_pay_base
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join (select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate from 
          (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,pay_comp,pay_status ,info_upd_time,cur_mpay_amt,
          person_pay_base from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc)rn,
          t.APP_ID, t.pay_comp ,t.pay_status,t.info_upd_time,t.cur_mpay_amt,t.person_pay_base from opas_pboc_public_eninsurdep t)
          where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id =  #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc)
          where rownum = 1
	</select>
		<select id="selectListPbocScBzkByAppId" parameterType="java.lang.String"
		resultMap="resultSummaryInfoScBzk">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t1.resi_tel,
               t1.communication_addr,
               TO_CHAR(TO_DATE(t1.query_req_time,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') AS query_req_time,
               t2.company,
               t2.comp_addr,
               t2.INFO_UPD_TIME,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'),'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp AS pay_comp1,
               t4.pay_status AS pay_status1,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time1,
               t4.monthly_deposit,
               t4.person_deposit_rate,
               t4.COMP_DEPOSIT_RATE,
               case when t4.PERSONCOMPRATE is not null then t4.PERSONCOMPRATE||'%' else '' end as PERSONCOMPRATE,
               t5.pay_comp AS pay_comp2,
               t5.pay_status AS pay_status2,
               TO_CHAR(TO_DATE(t5.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t5.cur_mpay_amt,
               t5.person_pay_base
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join (select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate,COMP_DEPOSIT_RATE,
          to_char((to_number(substr(person_deposit_rate,1,length(person_deposit_rate)-1))+to_number(substr(COMP_DEPOSIT_RATE,1,length(COMP_DEPOSIT_RATE)-1)))) as PERSONCOMPRATE
          from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate,t.COMP_DEPOSIT_RATE from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,pay_comp,pay_status ,info_upd_time,cur_mpay_amt,
          person_pay_base from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc)rn,
          t.APP_ID, t.pay_comp ,t.pay_status,t.info_upd_time,t.cur_mpay_amt,t.person_pay_base from opas_pboc_public_eninsurdep t)
          where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id =  #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc)
          where rownum &lt;=2
	</select>
	
<!-- 人行摘要信息-标准卡征信审批 -->
	<select id="querySummaryInfoZxSpBzk" parameterType="java.lang.String"
		resultMap="resultSummaryInfoZxSpBzk">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t1.communication_addr,
               t2.company,
               t2.comp_addr,
               TO_CHAR(TO_DATE(t2.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time1,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'),'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp,
               t4.pay_status,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t4.monthly_deposit,
               t4.person_deposit_rate,
               t4.COMP_DEPOSIT_RATE,
               case when t4.PERSONCOMPRATE is not null then t4.PERSONCOMPRATE||'%' else '' end as PERSONCOMPRATE,
               t5.no_pd_card_bank_max_credit_lim
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join (select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate,COMP_DEPOSIT_RATE,
          to_char((to_number(substr(person_deposit_rate,1,length(person_deposit_rate)-1))+to_number(substr(COMP_DEPOSIT_RATE,1,length(COMP_DEPOSIT_RATE)-1)))) as PERSONCOMPRATE
          from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate,t.COMP_DEPOSIT_RATE from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,no_pd_card_bank_max_credit_lim
          from (select row_number() over(partition by APP_ID order by LST_UPD_TIME  desc)rn,
          t.APP_ID, t.no_pd_card_bank_max_credit_lim from opas_pboc_shareanddebt_info t)
          where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id = #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc)
          where rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批-工作单位、单位地址、更新时间第二条数据 -->
	<select id="querySummaryInfoZxSpBzk2" parameterType="java.lang.String"
		resultMap="resultSummaryInfoZxSpBzk2">
		select *
  from (SELECT t2.company,
               t2.comp_addr,
               t2.info_upd_time
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
         where t1.app_id = #{appId,jdbcType=VARCHAR}
         order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc
                  )
 where rownum &lt;= 2
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-欠税记录信息 -->
	<select id="querySummaryInfoErr1" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_TAXARREAR
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-民事判决记录信息 -->
	<select id="querySummaryInfoErr2" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_CIVJUDGE
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-强制执行记录信息 -->
	<select id="querySummaryInfoErr3" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_FORCEEXE
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-养老保险金缴存记录信息 -->
	<select id="querySummaryInfoErr4" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ENINSURDEP
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-养老保险金发放记录信息 -->
	<select id="querySummaryInfoErr5" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ENINSURDEL
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-行政处罚记录信息 -->
	<select id="querySummaryInfoErr6" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ADMINPUNISH
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-贷款当前逾期总额 -->
	<select id="querySummaryInfoAmt1" parameterType="java.lang.String"
		resultType="java.lang.String">
		select sum(over_due_cur_over_due_amt)
  from OPAS_PBOC_LOAN_CARD_INFO
 where app_id = #{appId,jdbcType=VARCHAR} and
       mess_type = '01'
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-信用卡当前逾期总额 -->
	<select id="querySummaryInfoAmt2" parameterType="java.lang.String"
		resultType="java.lang.String">
		select sum(over_due_cur_over_due_amt)
  from OPAS_PBOC_LOAN_CARD_INFO
 where app_id = #{appId,jdbcType=VARCHAR} and
       mess_type = '02'
	</select>
	<resultMap id="resultLostTrustMap" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="CASE_STATUS" property="caseStatus" jdbcType="VARCHAR" />
	</resultMap>
<!-- 人行摘要信息-标准卡征信审批/易达金-是否列入失信被执行人名单 -->
	<select id="querySummaryInfoCase" parameterType="java.lang.String" resultMap="resultLostTrustMap">
		select APP_ID ,CASE_STATUS from OPAS_PBOC_PUBLIC_FORCEEXE where APP_ID = #{appId,jdbcType=VARCHAR} 
	</select>
	
<!-- 人行摘要信息-标准卡征信审批/易达金-信用卡状态异常 -->
	<select id="querySummaryInfoCredit" parameterType="java.lang.String"
		resultType="java.lang.String">
		select distinct LOAN_OR_CREDIT_ACCT_STATUS
  from OPAS_PBOC_LOAN_CARD_INFO
 where APP_ID = #{appId,jdbcType=VARCHAR} and
       MESS_TYPE = '02'  and  (LOAN_OR_CREDIT_ACCT_STATUS LIKE '5%' or
       LOAN_OR_CREDIT_ACCT_STATUS LIKE '3%' or
       LOAN_OR_CREDIT_ACCT_STATUS LIKE '2%')
      <!-- (LOAN_OR_CREDIT_ACCT_STATUS LIKE '%呆账%' or
       LOAN_OR_CREDIT_ACCT_STATUS LIKE '%止付%' or
       LOAN_OR_CREDIT_ACCT_STATUS LIKE '%冻结%') -->
	</select>

<!-- 人行摘要信息-易达金 -->
	<select id="querySummaryInfoYdj" parameterType="java.lang.String"
		resultMap="resultSummaryInfoYdj">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t2.company,
               t2.comp_addr,
               t2.info_upd_time,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'), 
                       'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp,
               t4.pay_status,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t4.monthly_deposit,
               t4.person_deposit_rate,
               t4.COMP_DEPOSIT_RATE,
               case when t4.PERSONCOMPRATE is not null then  t4.PERSONCOMPRATE||'%' else '' end as PERSONCOMPRATE,
               t5.loan_overdue_acct_num,
               t5.loan_overdue_month_num,
               t5.loan_overdue_over_due_amt,
               t5.loan_overdue_longest_over_due,
               t5.debit_card_over_due_acct_num,
               t5.debit_card_over_due_month_num,
               t5.debit_co_due_over_due_amt,
               t5.debit_co_due_longest_over_due
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join(select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate,COMP_DEPOSIT_RATE,
          to_char((to_number(substr(person_deposit_rate,1,length(person_deposit_rate)-1))+to_number(substr(COMP_DEPOSIT_RATE,1,length(COMP_DEPOSIT_RATE)-1)))) as PERSONCOMPRATE
          from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate,t.COMP_DEPOSIT_RATE from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,loan_overdue_acct_num,loan_overdue_month_num,loan_overdue_over_due_amt,
          loan_overdue_longest_over_due, debit_card_over_due_acct_num,debit_card_over_due_month_num,
          debit_co_due_over_due_amt,debit_co_due_longest_over_due from 
          (select row_number() over(partition by APP_ID order by LST_UPD_TIME  desc)rn, t.APP_ID,t.loan_overdue_acct_num,
           t.loan_overdue_month_num, t.loan_overdue_over_due_amt,t.loan_overdue_longest_over_due,
           t.debit_card_over_due_acct_num,t.debit_card_over_due_month_num, t.debit_co_due_over_due_amt,
           t.debit_co_due_longest_over_due from opas_pboc_overdueandfellback t)
           where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id = #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,
                  t2.INFO_UPD_TIME desc)
 where rownum = 1
	</select>
<!-- 人行摘要信息-易达金-贷款异常情况 -->
	<select id="querySummaryInfoRecSeq" parameterType="java.lang.String"
		resultType="java.lang.String">
        select a.r1
  from(select rownum r1,ACC_CLASS5STATE
      from OPAS_PBOC_LOAN_CARD_INFO
      where APP_ID = #{appId,jdbcType=VARCHAR} and
             MESS_TYPE = '01') a
 where a.ACC_CLASS5STATE LIKE '%关注%' or
       a.ACC_CLASS5STATE LIKE '%次级%' or
       a.ACC_CLASS5STATE LIKE '%可疑%' or
       a.ACC_CLASS5STATE LIKE '%损失%'
	</select>
	
<!-- 人行摘要信息-易达金-担保信息异常情况 -->
	<select id="querySummaryInfoLoanSort5" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_GRURANTEE
 where APP_ID = #{appId,jdbcType=VARCHAR} and (substr(GUAR_LOAN_SORT5,1,1) in ('2','3','4','5')) and  rownum=1
      <!-- (GUAR_LOAN_SORT5 LIKE '%关注%' or
       GUAR_LOAN_SORT5 LIKE '%次级%' or
       GUAR_LOAN_SORT5 LIKE '%可疑%' or
       GUAR_LOAN_SORT5 LIKE '%损失%') -->
	</select>
	
<!-- 人行摘要信息-易达金-到期未结清贷款笔数 -->
	<select id="querySummaryInfoExpireLoansNum" parameterType="java.lang.String"
		resultType="java.lang.String">
		select count(*)
  from (SELECT t1.loan_exp_date,
               t2.crt_date
          FROM opas_pboc_loan_card_info t1
          left join opas_biz_inp_appl_c1 t2 on t1.app_id = t2.app_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and
          to_char(isdate2(t1.loan_exp_date),'yyyy-mm-dd') &lt;=  to_char(t2.crt_date,'yyyy-mm-dd') and 
              t1.mess_type = '01' and
              t1.acc_corpus_bal > 0)
	</select>
	
<!-- 人行摘要信息-易达金-即将到期贷款笔数 -->
	<select id="querySummaryInfoAboutExpireLoansNum" parameterType="java.lang.String"
		resultType="java.lang.String">
		select count(1)
  from (SELECT t1.loan_exp_date,
               t2.crt_date
          FROM opas_pboc_loan_card_info t1
          left join opas_biz_inp_appl_c1 t2 on t1.app_id = t2.app_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and
               to_char(isdate2(t1.loan_exp_date),'yyyy-mm-dd') >  to_char(t2.crt_date,'yyyy-mm-dd') and
               t2.crt_date  &gt;=   (isdate2(t1.loan_exp_date)-15) and
               t1.acc_corpus_bal > 0 and
               t1.mess_type = '01')

	</select>
	
	<!-- 人行摘要信息 -->
	<select id="queryPbocInfo" parameterType="java.lang.String"
		resultMap="resultSummaryInfo">
		<!-- select a.cell_phone,a.c_comp_phone,a.resi_tel,b.company,b.comp_addr,c.resident_addr
		  from OPAS_PBOC_PERSONAL_INFO   a,
		       OPAS_PBOC_PROFESSION_INFO b,
		       OPAS_PBOC_RESIDENCE_INFO  c
		 where a.app_id = b.app_id
		   and a.app_id = c.app_id -->
		 select a.cell_phone,a.c_comp_phone,a.resi_tel,d.company,d.comp_addr,e.resident_addr
		 from OPAS_PBOC_PERSONAL_INFO  a,
         (select max(b.APP_ID) as APP_ID, max(b.company) as COMPANY,max(b.comp_addr)as COMP_ADDR , 
		  max(b.lst_upd_time)from OPAS_PBOC_PROFESSION_INFO  b group by b.app_id) d 
         ,( select max(c.APP_ID) as APP_ID, max(c.resident_addr) as RESIDENT_ADDR ,	
         max(c.lst_upd_time) from OPAS_PBOC_RESIDENCE_INFO c group by c.app_id ) e  
         where a.app_id = d.app_id
		 AND a.app_id = e.app_id
		 AND a.app_id = #{appId,jdbcType=VARCHAR}
	</select>	

	<resultMap id="resultBsaeInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="VARCHAR" />
		<result column="REPORT_NO" property="reportNo" jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="REPORT_TIME" property="reportTime" jdbcType="VARCHAR" />
		<result column="PRODUCT_TYPE" property="productType" jdbcType="VARCHAR" />
		<result column="PRODUCT_FORMAT" property="productFormat"
			jdbcType="VARCHAR" />
		<result column="PRODUCT_VERSION" property="productVersion"
			jdbcType="VARCHAR" />
		<result column="QUERYED_NAME" property="queryedName" jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_TYPE" property="queryedCertType"
			jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_NO" property="queryedCertNo"
			jdbcType="VARCHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="QUERY_ORG" property="queryOrg" jdbcType="VARCHAR" />
		<result column="QRY_OPERATOR" property="qryOperator" jdbcType="VARCHAR" />
		<result column="QUERY_RESULT_PROMPT" property="queryResultPrompt"
			jdbcType="VARCHAR" />
		<result column="GENDER" property="gender" jdbcType="VARCHAR" />
		<result column="BIRTH_DAY" property="birthDay" jdbcType="VARCHAR" />
		<result column="MARITAL_STATUS" property="maritalStatus"
			jdbcType="VARCHAR" />
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="RESIDENCY_STATUS" property="residencyStatus"
			jdbcType="VARCHAR" />
		<result column="DEGREE" property="degree" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="DOMICILE_ADDR" property="domicileAddr"
			jdbcType="VARCHAR" />
		<result column="MATE_NAME" property="mateName" jdbcType="VARCHAR" />
		<result column="MATE_CERT_TYPE" property="mateCertType"
			jdbcType="VARCHAR" />
		<result column="MATE_CERT_NO" property="mateCertNo" jdbcType="VARCHAR" />
		<result column="MATE_COMPANY" property="mateCompany" jdbcType="VARCHAR" />
		<result column="MATE_CONTACT_TEL" property="mateContactTel"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="VARCHAR" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="VARCHAR" />
		<result column="REC_STATUS" property="recStatus" jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 个人基本信息查询 -->
	<select id="queryBsaeInfo" parameterType="java.lang.String"
		resultMap="resultBsaeInfo">

		 SELECT
		 REPORT_NO, 
		 QUERY_REQ_TIME, 
		 REPORT_TIME,
		 PRODUCT_TYPE,
		 PRODUCT_FORMAT,
		 PRODUCT_VERSION,
		 QUERYED_NAME,
		 QUERYED_CERT_TYPE,
		 QUERYED_CERT_NO,
		 QRY_REASON, 
		 QUERY_ORG,
		 QRY_OPERATOR, 
		 QUERY_RESULT_PROMPT, 
		 GENDER,
		 BIRTH_DAY,
		 MARITAL_STATUS,
		decode(lengthb(CELL_PHONE),12,substr(CELL_PHONE,2,11),CELL_PHONE)	as 	CELL_PHONE,
		C_COMP_PHONE, RESI_TEL, RESIDENCY_STATUS, DEGREE,
		COMMUNICATION_ADDR,
		DOMICILE_ADDR,
		MATE_NAME, MATE_CERT_TYPE,
		MATE_CERT_NO, MATE_COMPANY, MATE_CONTACT_TEL,APP_ID
		FROM
		OPAS_PBOC_PERSONAL_INFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}

	</select>

	<resultMap id="queryResideInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr"
			jdbcType="VARCHAR" />
		<result column="RESIDE_STATE" property="resideState" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="VARCHAR" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="VARCHAR" />
		<result column="REC_STATUS" property="recStatus" jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
	</resultMap>

	<select id="selectResideInfo" parameterType="java.lang.String"
		resultMap="queryResideInfo">
		SELECT RESIDENT_ADDR, RESIDE_STATE,INFO_UPD_TIME
		FROM OPAS_PBOC_RESIDENCE_INFO
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
		ORDER BY INFO_UPD_TIME desc
	</select>


	<resultMap id="resultProessionInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="JOB" property="job" jdbcType="VARCHAR" />
		<result column="INDUSTRY_TYPE" property="industryType"
			jdbcType="VARCHAR" />
		<result column="OCCUPATION_CODE" property="occupationCode"
			jdbcType="VARCHAR" />
		<result column="TECHNICAL_TITLE" property="technicalTitle"
			jdbcType="VARCHAR" />
		<result column="CUR_COMP_WORK_STAT_Y" property="curCompWorkStatY"
			jdbcType="CHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>
<!-- 职业信息 -->
	<select id="queryProessionInfo" parameterType="java.lang.String"
		resultMap="resultProessionInfo">
		SELECT COMPANY,COMP_ADDR,JOB,INDUSTRY_TYPE,OCCUPATION_CODE,TECHNICAL_TITLE,CUR_COMP_WORK_STAT_Y,INFO_UPD_TIME
		FROM OPAS_PBOC_PROFESSION_INFO
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
		ORDER BY  INFO_UPD_TIME DESC
	</select>


	<resultMap id="resultMessageInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="PERSON_HOU_LOAN_NO" property="personHouLoanNo"
			jdbcType="VARCHAR" />
		<result column="PERSON_COM_HOU_LOAN_NO" property="personComHouLoanNo"
			jdbcType="VARCHAR" />
		<result column="OTHER_LOAN_NUM" property="otherLoanNum"
			jdbcType="VARCHAR" />
		<result column="FRS_LOAN_GRANT_MON" property="frsLoanGrantMon"
			jdbcType="VARCHAR" />
		<result column="CREDIT_CARD_ACCT_NUM" property="creditCardAcctNum"
			jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon"
			jdbcType="VARCHAR" />
		<result column="SEMI_CRED_ACCT_NUM" property="semiCredAcctNum"
			jdbcType="VARCHAR" />
		<result column="FRS_SEMI_CRED_ISSU_MON" property="frsSemiCredIssuMon"
			jdbcType="VARCHAR" />
		<result column="SELF_ANNOUNCE_CNT" property="selfAnnounceCnt"
			jdbcType="VARCHAR" />
		<result column="DISSENT_COUNT" property="dissentCount"
			jdbcType="VARCHAR" />
		<result column="NUMBER_READ" property="numberRead" jdbcType="VARCHAR" />
		<result column="OPPOSITE_POSITION" property="oppositePosition"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="REPORT_NO" property="reportNo" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryMessageInfo" parameterType="java.lang.String"
		resultMap="resultMessageInfo">
		SELECT
		PERSON_HOU_LOAN_NO,PERSON_COM_HOU_LOAN_NO,OTHER_LOAN_NUM,FRS_LOAN_GRANT_MON,
		CREDIT_CARD_ACCT_NUM,FRS_CRED_CRD_ISSUE_MON,SEMI_CRED_ACCT_NUM,FRS_SEMI_CRED_ISSU_MON,
		SELF_ANNOUNCE_CNT,DISSENT_COUNT,NUMBER_READ,OPPOSITE_POSITION,REPORT_NO
		FROM OPAS_PBOC_CREDIT_CUE
		WHERE APP_ID=#{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultOverdueInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="BAD_DEBT_NUM" property="badDebtNum" jdbcType="VARCHAR" />
		<result column="BAD_DEBT_BALANCE" property="badDebtBalance"
			jdbcType="VARCHAR" />
		<result column="ASS_DIS_NUM" property="assDisNum" jdbcType="VARCHAR" />
		<result column="ASS_DIS_BALANCE" property="assDisBalance"
			jdbcType="VARCHAR" />
		<result column="GUA_COMPEN_NUM" property="guaCompenNum"
			jdbcType="VARCHAR" />
		<result column="GUA_COMPEN_BALANCE" property="guaCompenBalance"
			jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_ACCT_NUM" property="loanOverdueAcctNum"
			jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_MONTH_NUM" property="loanOverdueMonthNum"
			jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_OVER_DUE_AMT" property="loanOverdueOverDueAmt"
			jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_LONGEST_OVER_DUE" property="loanOverdueLongestOverDue"
			jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_ACCT_NUM" property="debitCardOverDueAcctNum"
			jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_MONTH_NUM" property="debitCardOverDueMonthNum"
			jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_OVER_DUE_AMT" property="debitCoDueOverDueAmt"
			jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_LONGEST_OVER_DUE" property="debitCoDueLongestOverDue"
			jdbcType="VARCHAR" />
		<result column="DEB_C60OVERD_ACCT_NUM" property="debC60overdAcctNum"
			jdbcType="VARCHAR" />
		<result column="DEB_C60OVERD_MONTH_NUM" property="debC60overdMonthNum"
			jdbcType="VARCHAR" />
		<result column="DEB_C60OVERD_OVER_DUE_AMT" property="debC60overdOverDueAmt"
			jdbcType="VARCHAR" />
		<result column="DEB_C60OVERD_LONGEST_OVER_DUE" property="debC60overdLongestOverDue"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryOverdueInfo" parameterType="java.lang.String"
		resultMap="resultOverdueInfo">
		SELECT
		case when BAD_DEBT_NUM is not null then BAD_DEBT_NUM  else '0' end as BAD_DEBT_NUM,
		BAD_DEBT_BALANCE,
		case when  ASS_DIS_NUM is not null then ASS_DIS_NUM else '0' end as ASS_DIS_NUM,
		ASS_DIS_BALANCE,
		case when   GUA_COMPEN_NUM  is not null then  GUA_COMPEN_NUM else '0' end  as GUA_COMPEN_NUM,
		GUA_COMPEN_BALANCE,
		case when  LOAN_OVERDUE_ACCT_NUM is not null then LOAN_OVERDUE_ACCT_NUM else '0' end as LOAN_OVERDUE_ACCT_NUM,
		case  when   LOAN_OVERDUE_MONTH_NUM is not null then LOAN_OVERDUE_MONTH_NUM else '0' end as LOAN_OVERDUE_MONTH_NUM,
		LOAN_OVERDUE_OVER_DUE_AMT,
		case when LOAN_OVERDUE_LONGEST_OVER_DUE is not null then LOAN_OVERDUE_LONGEST_OVER_DUE else '0' end as LOAN_OVERDUE_LONGEST_OVER_DUE,
		case when  DEBIT_CARD_OVER_DUE_ACCT_NUM is not null then DEBIT_CARD_OVER_DUE_ACCT_NUM else '0' end as DEBIT_CARD_OVER_DUE_ACCT_NUM,
		case when  DEBIT_CARD_OVER_DUE_MONTH_NUM is not null then DEBIT_CARD_OVER_DUE_MONTH_NUM else '0' end as DEBIT_CARD_OVER_DUE_MONTH_NUM,
		DEBIT_CO_DUE_OVER_DUE_AMT,
		case when  DEBIT_CO_DUE_LONGEST_OVER_DUE is not null then DEBIT_CO_DUE_LONGEST_OVER_DUE else '0' end as DEBIT_CO_DUE_LONGEST_OVER_DUE,
		case  when DEB_C60OVERD_ACCT_NUM is not null then DEB_C60OVERD_ACCT_NUM else '0' end as DEB_C60OVERD_ACCT_NUM,
		case when DEB_C60OVERD_MONTH_NUM is not null then DEB_C60OVERD_MONTH_NUM else '0' end as DEB_C60OVERD_MONTH_NUM,
		DEB_C60OVERD_OVER_DUE_AMT,
		case when  DEB_C60OVERD_LONGEST_OVER_DUE is not null then DEB_C60OVERD_LONGEST_OVER_DUE else '0' end as DEB_C60OVERD_LONGEST_OVER_DUE
		FROM OPAS_PBOC_OVERDUEANDFELLBACK
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultCreditInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" jdbcType="CHAR" property="insideAppNo" />
		<result column="OUTS_LOANS_LOAN_CORP_NUMBER" jdbcType="VARCHAR"
			property="outsLoansLoanCorpNumber" />
		<result column="OUTSTAND_LOANS_LOAN_ORG_NUMBER" jdbcType="VARCHAR"
			property="outstandLoansLoanOrgNumber" />
		<result column="OUTSTAND_LOANS_ACCT_NUM" jdbcType="VARCHAR"
			property="outstandLoansAcctNum" />
		<result column="OUTSTAND_LOANS_CONTRACT_AMT" jdbcType="VARCHAR"
			property="outstandLoansContractAmt" />
		<result column="OUTSTAND_LOANS_BALANCE" jdbcType="VARCHAR"
			property="outstandLoansBalance" />
		<result column="OUTSTAND_LOANS_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="outstandLoans6monthAvePay" />
		<result column="NO_PD_CARD_LOAN_CORP_NUMBER" jdbcType="VARCHAR"
			property="noPdCardLoanCorpNumber" />
		<result column="NO_PD_CARD_LOAN_ORG_NUMBER" jdbcType="VARCHAR"
			property="noPdCardLoanOrgNumber" />
		<result column="NO_PIN_DEBIT_CARD_ACCT_NUM" jdbcType="VARCHAR"
			property="noPinDebitCardAcctNum" />
		<result column="NO_PIN_DEBIT_CARD_CONTRACT_AMT" jdbcType="VARCHAR"
			property="noPinDebitCardContractAmt" />
		<result column="NO_PD_CARD_BANK_MAX_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPdCardBankMaxCreditLim" />
		<result column="NO_PD_CARD_BANK_MIN_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPdCardBankMinCreditLim" />
		<result column="NO_PD_CODRAFT_AMT" jdbcType="VARCHAR" property="noPdCodraftAmt" />
		<result column="NO_PD_CARD_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="noPdCard6monthAvePay" />
		<result column="NO_PADC_LOAN_CORP_NUMBER" jdbcType="VARCHAR"
			property="noPadcLoanCorpNumber" />
		<result column="NO_PADC_LOAN_ORG_NUMBER" jdbcType="VARCHAR"
			property="noPadcLoanOrgNumber" />
		<result column="NO_PIN_APP_DEBIT_CARD_ACCT_NUM" jdbcType="VARCHAR"
			property="noPinAppDebitCardAcctNum" />
		<result column="NO_PADC_CONTRACT_AMT" jdbcType="VARCHAR"
			property="noPadcContractAmt" />
		<result column="NO_PADC_BANK_MAX_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPadcBankMaxCreditLim" />
		<result column="NO_PADC_BANK_MIN_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPadcBankMinCreditLim" />
		<result column="NO_PAD_CODRAFT_AMT" jdbcType="VARCHAR"
			property="noPadCodraftAmt" />
		<result column="NO_PADC_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="noPadc6monthAvePay" />
		<result column="GUARANTY_GUARANTEE_NUM" jdbcType="VARCHAR"
			property="guarantyGuaranteeNum" />
		<result column="GUARANTY_GUARANTEE_AMT" jdbcType="VARCHAR"
			property="guarantyGuaranteeAmt" />
		<result column="GUARANTY_ASSURE_BALANCE" jdbcType="VARCHAR"
			property="guarantyAssureBalance" />
		<result column="CRT_TIME" jdbcType="VARCHAR" property="crtTime" />
		<result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
		<result column="LST_UPD_TIME" jdbcType="TIMESTAMP" property="lstUpdTime" />
		<result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
		<result column="BATCH_DATE" jdbcType="TIMESTAMP" property="batchDate" />
		<result column="REC_STATUS" jdbcType="CHAR" property="recStatus" />
		<result column="APP_ID" jdbcType="CHAR" property="appId" />
	</resultMap>

	<select id="queryCreditInfo" parameterType="java.lang.String"
		resultMap="resultCreditInfo">
		SELECT OUTS_LOANS_LOAN_CORP_NUMBER,
		OUTSTAND_LOANS_LOAN_ORG_NUMBER, OUTSTAND_LOANS_ACCT_NUM,
		OUTSTAND_LOANS_CONTRACT_AMT, OUTSTAND_LOANS_BALANCE,
		OUTSTAND_LOANS_6MONTH_AVE_PAY, NO_PD_CARD_LOAN_CORP_NUMBER,
		NO_PD_CARD_LOAN_ORG_NUMBER, NO_PIN_DEBIT_CARD_ACCT_NUM,
		NO_PIN_DEBIT_CARD_CONTRACT_AMT, NO_PD_CARD_BANK_MAX_CREDIT_LIM,
		NO_PD_CARD_BANK_MIN_CREDIT_LIM, NO_PD_CODRAFT_AMT,
		NO_PD_CARD_6MONTH_AVE_PAY, NO_PADC_LOAN_CORP_NUMBER,
		NO_PADC_LOAN_ORG_NUMBER, NO_PIN_APP_DEBIT_CARD_ACCT_NUM,
		NO_PADC_CONTRACT_AMT, NO_PADC_BANK_MAX_CREDIT_LIM,
		NO_PADC_BANK_MIN_CREDIT_LIM, NO_PAD_CODRAFT_AMT,
		NO_PADC_6MONTH_AVE_PAY,
		case when  GUARANTY_GUARANTEE_NUM is not null then GUARANTY_GUARANTEE_NUM else '0' end as GUARANTY_GUARANTEE_NUM,
		GUARANTY_GUARANTEE_AMT, GUARANTY_ASSURE_BALANCE
		FROM
		OPAS_PBOC_SHAREANDDEBT_INFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}

	</select>
	<resultMap id="allRecordSummaryMap" type="java.util.Map">
		
		<result column="QUERY_ORG_1M_SUM2" property="sumH" jdbcType="VARCHAR" />
		<result column="QUERY_ORG_1M_SUM3" property="sumC" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM2" property="sumTimeH" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM3" property="sumTimeC" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM4" property="sumTimeS" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM1" property="sumM2Y" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM5" property="sumA2Y" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM6" property="sumR2Y" jdbcType="VARCHAR" />
	</resultMap>
<select id="selectPbocAllRecordSummary" parameterType="java.util.Map"
		resultMap="allRecordSummaryMap">
		SELECT
		QUERY_ORG_1M_SUM2,QUERY_ORG_1M_SUM3,
	    QUERY_REC_1M_SUM2,QUERY_REC_1M_SUM3, QUERY_REC_1M_SUM4,
	    QUERY_REC_2Y_SUM1,QUERY_REC_2Y_SUM5, QUERY_REC_2Y_SUM6
		FROM PBOC_QUERYINFO_NEW
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultAssetInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="ASSETS_MANAGE_COMP" property="assetsManageComp"
			jdbcType="VARCHAR" />
		<result column="DEBT_RECE_DATE" property="debtReceDate"
			jdbcType="VARCHAR" />
		<result column="RECE_DEBT_AMT" property="receDebtAmt" jdbcType="VARCHAR" />
		<result column="LATEST_PAYMENT_DATE" property="latestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAssetInfo" parameterType="java.lang.String"
		resultMap="resultAssetInfo">
		SELECT ASSETS_MANAGE_COMP,DEBT_RECE_DATE,
		RECE_DEBT_AMT,LATEST_PAYMENT_DATE,BALANCE
		FROM OPAS_PBOC_ASSETDISPOSITION
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAssureInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="ERAPAY_ORG" property="erapayOrg" jdbcType="VARCHAR" />
		<result column="LATEST_ERAPAY_DATE" property="latestErapayDate"
			jdbcType="VARCHAR" />
		<result column="CUMUL_ERAPAY_AMT" property="cumulErapayAmt"
			jdbcType="VARCHAR" />
		<result column="LATEST_PAYMENT_DATE" property="latestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAssureInfo" parameterType="java.lang.String"
		resultMap="resultAssureInfo">
		SELECT ERAPAY_ORG, LATEST_ERAPAY_DATE,
		CUMUL_ERAPAY_AMT, LATEST_PAYMENT_DATE, BALANCE
		FROM OPAS_PBOC_ASSURERREPAY
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultArrearageInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="TAX_ORG_NAME" property="taxOrgName" jdbcType="VARCHAR" />
		<result column="OUTSTD_TAXES_AMT_SUM" property="outstdTaxesAmtSum"
			jdbcType="VARCHAR" />
		<result column="OUTSTD_TAX_STAT_DT" property="outstdTaxStatDt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryArrearageInfo" parameterType="java.lang.String"
		resultMap="resultArrearageInfo">
		SELECT TAX_ORG_NAME, OUTSTD_TAXES_AMT_SUM,OUTSTD_TAX_STAT_DT
		FROM OPAS_PBOC_PUBLIC_TAXARREAR
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
	</select>



	<resultMap id="resultJudgmentInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="REG_COURT" property="regCourt" jdbcType="VARCHAR" />
		<result column="CASE_REASON" property="caseReason" jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_WAY" property="closeCaseWay"
			jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_RST" property="judgMediateRst"
			jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_EFFCT_DT" property="judgMediateEffctDt"
			jdbcType="VARCHAR" />
		<result column="LAW_OBJECT" property="lawObject" jdbcType="VARCHAR" />
		<result column="LAW_OBJECT_AMT" property="lawObjectAmt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryJudgmentInfo" parameterType="java.lang.String"
		resultMap="resultJudgmentInfo">
		SELECT REG_COURT, CASE_REASON,REG_DATE,
		CLOSE_CASE_WAY, JUDG_MEDIATE_RST,
		JUDG_MEDIATE_EFFCT_DT, LAW_OBJECT,
		LAW_OBJECT_AMT
		FROM OPAS_PBOC_PUBLIC_CIVJUDGE
		WHERE APP_ID=#{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultForceInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="EXECUTE_COURT" property="executeCourt"
			jdbcType="VARCHAR" />
		<result column="EXECUTE_CASE_RSN" property="executeCaseRsn"
			jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_WAY" property="closeCaseWay"
			jdbcType="VARCHAR" />
		<result column="CASE_STATUS" property="caseStatus" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_DATE" property="closeCaseDate"
			jdbcType="VARCHAR" />
		<result column="APPLY_EXE_OBJ" property="applyExeObj" jdbcType="VARCHAR" />
		<result column="APPLY_EXE_OBJ_AMT" property="applyExeObjAmt"
			jdbcType="VARCHAR" />
		<result column="ALREADY_EXE_OBJ" property="alreadyExeObj"
			jdbcType="VARCHAR" />
		<result column="ALREADY_EXE_OBJ_AMT" property="alreadyExeObjAmt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryForceInfo" parameterType="java.lang.String"
		resultMap="resultForceInfo">
		SELECT EXECUTE_COURT,EXECUTE_CASE_RSN,
		REG_DATE,CLOSE_CASE_WAY, CASE_STATUS,
		CLOSE_CASE_DATE,APPLY_EXE_OBJ,
		APPLY_EXE_OBJ_AMT,ALREADY_EXE_OBJ,ALREADY_EXE_OBJ_AMT
		FROM OPAS_PBOC_PUBLIC_FORCEEXE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultPenaltyInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="PUNISH_ORGANIZ" property="punishOrganiz"
			jdbcType="VARCHAR" />
		<result column="PUNISH_CONTENT" property="punishContent"
			jdbcType="VARCHAR" />
		<result column="PUNISH_AMT" property="punishAmt" jdbcType="VARCHAR" />
		<result column="EFFECT_DATE" property="effectDate" jdbcType="VARCHAR" />
		<result column="END_DATE" property="endDate" jdbcType="VARCHAR" />
		<result column="AD_REVIEW_RESULT" property="adReviewResult"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryPenaltyInfo" parameterType="java.lang.String"
		resultMap="resultPenaltyInfo">
		SELECT PUNISH_ORGANIZ,PUNISH_CONTENT,
		PUNISH_AMT,EFFECT_DATE,END_DATE,AD_REVIEW_RESULT
		FROM OPAS_PBOC_PUBLIC_ADMINPUNISH
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultHousingInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="JOIN_SOCL_INSU_PL" property="joinSoclInsuPl"
			jdbcType="VARCHAR" />
		<result column="JOIN_SOCL_INSU_DT" property="joinSoclInsuDt"
			jdbcType="VARCHAR" />
		<result column="FIRST_DEPOSIT_YM" property="firstDepositYm"
			jdbcType="VARCHAR" />
		<result column="PAY_YM" property="payYm" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryHousingInfo" parameterType="java.lang.String"
		resultMap="resultHousingInfo">
		SELECT
		JOIN_SOCL_INSU_PL, JOIN_SOCL_INSU_DT,
		FIRST_DEPOSIT_YM, PAY_YM, PAY_STATUS,
		MONTHLY_DEPOSIT,PERSON_DEPOSIT_RATE, COMP_DEPOSIT_RATE,
		PAY_COMP, INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_ACCFUND
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
		ORDER BY  INFO_UPD_TIME desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc
	</select>


	<resultMap id="resultPayAnnuityInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="JOIN_SOCL_INSU_PL" property="joinSoclInsuPl"
			jdbcType="VARCHAR" />
		<result column="JOIN_SOCL_INSU_YM" property="joinSoclInsuYm"
			jdbcType="VARCHAR" />
		<result column="CUMUL_PAY_MONTHS" property="cumulPayMonths"
			jdbcType="VARCHAR" />
		<result column="WORK_MONTHS" property="workMonths" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="PERSON_PAY_BASE" property="personPayBase"
			jdbcType="VARCHAR" />
		<result column="CUR_MPAY_AMT" property="curMpayAmt" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAUSE_PAY_REASON" property="pausePayReason"
			jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>
	<select id="queryPayAnnuityInfo" parameterType="java.lang.String"
		resultMap="resultPayAnnuityInfo">
		SELECT
		JOIN_SOCL_INSU_PL, JOIN_SOCL_INSU_YM,
		CUMUL_PAY_MONTHS, WORK_MONTHS, PAY_STATUS,
		PERSON_PAY_BASE,
		CUR_MPAY_AMT, PAY_COMP,
		PAUSE_PAY_REASON, INFO_UPD_TIME
		FROM
		OPAS_PBOC_PUBLIC_ENINSURDEP
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultGrantAnnuityInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="DISTRIBUTED_AREA" property="distributedArea"
			jdbcType="VARCHAR" />
		<result column="RETIRED_TYPE" property="retiredType" jdbcType="VARCHAR" />
		<result column="RETIRED_DATE" property="retiredDate" jdbcType="VARCHAR" />
		<result column="WORK_MONTHS" property="workMonths" jdbcType="VARCHAR" />
		<result column="CUR_MREAL_PAY_PENS" property="curMrealPayPens"
			jdbcType="VARCHAR" />
		<result column="PAUSE_PAY_REASON" property="pausePayReason"
			jdbcType="VARCHAR" />
		<result column="ORI_COMP_NAME" property="oriCompName" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryGrantAnnuityInfo" parameterType="java.lang.String"
		resultMap="resultGrantAnnuityInfo">
		SELECT DISTRIBUTED_AREA,RETIRED_TYPE,RETIRED_DATE,WORK_MONTHS,CUR_MREAL_PAY_PENS,
		PAUSE_PAY_REASON,ORI_COMP_NAME,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_ENINSURDEL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultLowHouseholdInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="PERSONNEL_TYPE" property="personnelType"
			jdbcType="VARCHAR" />
		<result column="PLACE" property="place" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="HOME_MINCOME" property="homeMincome" jdbcType="VARCHAR" />
		<result column="APP_DATE" property="appDate" jdbcType="VARCHAR" />
		<result column="PASS_DATE" property="passDate" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryLowHouseholdInfo" parameterType="java.lang.String"
		resultMap="resultLowHouseholdInfo">
		SELECT PERSONNEL_TYPE,PLACE,
		COMPANY,HOME_MINCOME,APP_DATE,
		PASS_DATE,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_SALVATION
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultOccupationInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="COMPETENCY_NAME" property="competencyName"
			jdbcType="VARCHAR" />
		<result column="RANK" property="rank" jdbcType="VARCHAR" />
		<result column="AWARD_DATE" property="awardDate" jdbcType="VARCHAR" />
		<result column="EXP_DATE" property="expDate" jdbcType="VARCHAR" />
		<result column="REVOKE_DATE" property="revokeDate" jdbcType="VARCHAR" />
		<result column="AWARD_ORG" property="awardOrg" jdbcType="VARCHAR" />
		<result column="ORG_PLACE" property="orgPlace" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryOccupationInfo" parameterType="java.lang.String"
		resultMap="resultOccupationInfo">
		SELECT COMPETENCY_NAME,RANK,AWARD_DATE,EXP_DATE,REVOKE_DATE,AWARD_ORG,ORG_PLACE
		FROM OPAS_PBOC_PUBLIC_COMPETENCE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAwardInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="REWARD_ORG" property="rewardOrg" jdbcType="VARCHAR" />
		<result column="REWARD_CONTENT" property="rewardContent"
			jdbcType="VARCHAR" />
		<result column="EFFECT_DATE" property="effectDate" jdbcType="VARCHAR" />
		<result column="END_DATE" property="endDate" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAwardInfo" parameterType="java.lang.String"
		resultMap="resultAwardInfo">
		SELECT REWARD_ORG,REWARD_CONTENT,EFFECT_DATE,END_DATE
		FROM OPAS_PBOC_PUBLIC_ADMINAWARD
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultVehicleInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="SEND_ORG_NO" property="sendOrgNo" jdbcType="VARCHAR" />
		<result column="PLATE_NO" property="plateNo" jdbcType="VARCHAR" />
		<result column="BRAND" property="brand" jdbcType="VARCHAR" />
		<result column="CAR_TYPE" property="carType" jdbcType="VARCHAR" />
		<result column="CAR_USE_PROP" property="carUseProp" jdbcType="VARCHAR" />
		<result column="CAR_STATUS" property="carStatus" jdbcType="VARCHAR" />
		<result column="PLEDGE_FLAG" property="pledgeFlag" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryVehicleInfo" parameterType="java.lang.String"
		resultMap="resultVehicleInfo">
		SELECT SEND_ORG_NO,PLATE_NO,BRAND,CAR_TYPE,
		CAR_USE_PROP,CAR_STATUS,PLEDGE_FLAG,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_VEHICLE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultTelecomInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="TELECOM_FACILITATOR" property="telecomFacilitator"
			jdbcType="VARCHAR" />
		<result column="BUSI_TYPE" property="busiType" jdbcType="VARCHAR" />
		<result column="BUSI_OPN_DATE" property="busiOpnDate" jdbcType="VARCHAR" />
		<result column="CUR_PAY_STAT" property="curPayStat" jdbcType="VARCHAR" />
		<result column="CUR_DEBT_AMT" property="curDebtAmt" jdbcType="VARCHAR" />
		<result column="CUR_DEBT_MONTHS" property="curDebtMonths"
			jdbcType="VARCHAR" />
		<result column="PREST24MPAY_STAT" property="prest24mpayStat"
			jdbcType="VARCHAR" />
		<result column="TALLY_YM" property="tallyYm" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryTelecomInfo" parameterType="java.lang.String"
		resultMap="resultTelecomInfo">
		SELECT TELECOM_FACILITATOR,BUSI_TYPE,
		BUSI_OPN_DATE,CUR_PAY_STAT,CUR_DEBT_AMT,
		CUR_DEBT_MONTHS,PREST24MPAY_STAT,TALLY_YM
		FROM OPAS_PBOC_PUBLIC_TELPAYMENT
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAnnounceInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="DECLARE_CONTENT" property="declareContent"
			jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="addDate" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAnnounceInfo" parameterType="java.lang.String"
		resultMap="resultAnnounceInfo">
		SELECT DECLARE_CONTENT,ADD_DATE
		FROM OPAS_PBOC_ANNOUNCE_ANNINFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultDissentInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="DECLARE_CONTENT" property="declareContent"
			jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="addDate" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryDissentInfo" parameterType="java.lang.String"
		resultMap="resultDissentInfo">
		SELECT DECLARE_CONTENT,ADD_DATE
		FROM OPAS_PBOC_ANNOUNCE_DISINFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultReCreditInfo" type="java.util.Map">
		<result column="FA_REC_SEQ" property="faRecSeq" jdbcType="CHAR" />
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="QRY_DATE" property="qryDate" jdbcType="VARCHAR" />
		<result column="QRY_OPERATOR" property="qryOperator" jdbcType="VARCHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryReCreditInfo" parameterType="java.lang.String"
		resultMap="resultReCreditInfo">
		select
		FA_REC_SEQ, INSIDE_APP_NO, QRY_DATE,
		QRY_OPERATOR,
		QRY_REASON, CRT_TIME,
		CRT_USER, LST_UPD_TIME, LST_UPD_USER,
		BATCH_DATE,
		REC_STATUS
		from OPAS_PBOC_QUERYREC_RECDETAIL
		where APP_ID =
		#{appId,jdbcType=VARCHAR}
		order by QRY_DATE desc

	</select>


	<resultMap id="resultCreditGradeInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" jdbcType="CHAR" property="insideAppNo" />
		<result column="DESC_CONTENT" jdbcType="VARCHAR" property="descContent" />
		<result column="CRT_TIME" jdbcType="VARCHAR" property="crtTime" />
		<result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
		<result column="LST_UPD_TIME" jdbcType="TIMESTAMP" property="lstUpdTime" />
		<result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
		<result column="BATCH_DATE" jdbcType="TIMESTAMP" property="batchDate" />
		<result column="REC_STATUS" jdbcType="CHAR" property="recStatus" />
		<result column="APP_ID" jdbcType="CHAR" property="appId" />
		<result column="NUMBER_READ" jdbcType="VARCHAR" property="numberRead" />
		<result column="OPPOSITE_POSITION" jdbcType="VARCHAR" property="oppositePosition" />
	</resultMap>

	<select id="queryCreditGradeInfo" parameterType="java.lang.String"
		resultMap="resultCreditGradeInfo">
		select s.DESC_CONTENT,c.NUMBER_READ,c.OPPOSITE_POSITION
		from OPAS_PBOC_CREDIT_CUE c full join OPAS_PBOC_CREDITSCORE_SCOREELE s on s.APP_ID=c.APP_ID
		where  c.APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultDegreeMap" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="SUM" property="sum" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryPaymentInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_ORGSUM
		WHERE
		QRY_REASON='02|贷款审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryCartInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_ORGSUM
		WHERE
		QRY_REASON='03|信用卡审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryPaymentTimeInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='02|贷款审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryCartTimeInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='03|信用卡审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="querySelfInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='04|本人查询' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>


	<select id="queryManage2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='01|贷后管理' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>

	<select id="queryAssure2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='08|担保资格审查' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>

	<select id="queryRealName2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='19|特约商户实名审查' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>
	<resultMap id="loanCardInfo" type="com.huaxia.opas.domain.thirdparty.LoanCardInfo">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="BASIC_INFO_PROMPT" property="basicInfoPrompt"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ORG" property="loanOrCreditOrg"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ORG_TYPE" property="loanOrCreditOrgType"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_BUSI_NO" property="loanOrCreditBusiNo"
			jdbcType="VARCHAR" />
		<result column="LOAN_LOAN_TYPE_SEG" property="loanLoanTypeSeg"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CCY" property="loanOrCreditCcy"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate"
			jdbcType="VARCHAR" />
		<result column="LOAN_EXP_DATE" property="loanExpDate" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_GUARANTEE_MODE" property="loanOrCreditGuaranteeMode"
			jdbcType="VARCHAR" />
		<result column="LOAN_PAYMENT_FREQ" property="loanPaymentFreq"
			jdbcType="VARCHAR" />
		<result column="LOAN_PAYMENT_CYC_NUM" property="loanPaymentCycNum"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loanOrCreditAcctStatus"
			jdbcType="VARCHAR" />
		<result column="ACC_STATE_END_DATE" property="accStateEndDate"
			jdbcType="VARCHAR" />
		<result column="ACC_CLASS5STATE" property="accClass5state"
			jdbcType="VARCHAR" />
		<result column="ACC_CORPUS_BAL" property="accCorpusBal"
			jdbcType="VARCHAR" />
		<result column="ACC_REM_PAYMENT_CYC_NUM" property="accRemPaymentCycNum"
			jdbcType="VARCHAR" />
		<result column="ACC_CUR_MDUE_PAY_BAL" property="accCurMduePayBal"
			jdbcType="VARCHAR" />
		<result column="ACC_DUE_PAYMENT_DATE" property="accDuePaymentDate"
			jdbcType="VARCHAR" />
		<result column="ACC_CUR_MREAL_PAY_AMT" property="accCurMrealPayAmt"
			jdbcType="VARCHAR" />
		<result column="ACC_LATEST_PAYMENT_DATE" property="accLatestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_CUR_OVER_DUE_NUM" property="overDueCurOverDueNum"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_CUR_OVER_DUE_AMT" property="overDueCurOverDueAmt"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR31TO60D" property="overDueUnPayCor31to60d"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR61TO90D" property="overDueUnPayCor61to90d"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR91TO180" property="overDueUnPayCor91to180"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR180DPLUS" property="overDueUnPayCor180dplus"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_STR_MONTH" property="m24PaymentStrMonth"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_END_MONTH" property="m24PaymentEndMonth"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_STATUS" property="m24PaymentStatus"
			jdbcType="VARCHAR" />
		<result column="M60_OVER_DUE_STR_MONTH" property="m60OverDueStrMonth"
			jdbcType="VARCHAR" />
		<result column="M60_OVER_DUE_END_MONTH" property="m60OverDueEndMonth"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="REC_SEQ" property="recSeq" jdbcType="CHAR" />
		<result column="MESS_TYPE" property="messType" jdbcType="CHAR" />
		<result column="DEB_CARD_PAY_OVERDRAFT_AMT" property="debCardPayOverdraftAmt"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_SHARE_LIMIT" property="debCardPayShareLimit"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_6MAVG_USED_AMT" property="debCardPay6mavgUsedAmt"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_MAX_USED_BAL" property="debCardPayMaxUsedBal"
			jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>
	<!-- 贷记卡 -->
	<select id="queryloanCardInfoByAppId" parameterType="java.util.Map"
		resultMap="loanCardInfo">
		select * from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
			ORDER BY LOAN_OR_CREDIT_ISSU_DATE desc
		</where>
	</select>
	<select id="selectLoanCardDataByMap" parameterType="java.util.Map"
		resultMap="loanCardInfo">
	  select  BASIC_INFO_PROMPT, LOAN_OR_CREDIT_ORG, 
      LOAN_OR_CREDIT_ORG_TYPE, LOAN_OR_CREDIT_BUSI_NO, 
      LOAN_LOAN_TYPE_SEG, LOAN_OR_CREDIT_CCY, LOAN_OR_CREDIT_ISSU_DATE, 
      LOAN_EXP_DATE, LOAN_OR_CREDIT_CONT_AMT, LOAN_OR_CREDIT_GUARANTEE_MODE, 
      LOAN_PAYMENT_FREQ, LOAN_PAYMENT_CYC_NUM, LOAN_OR_CREDIT_ACCT_STATUS, 
      ACC_STATE_END_DATE, ACC_CLASS5STATE, ACC_CORPUS_BAL, 
      ACC_REM_PAYMENT_CYC_NUM, ACC_CUR_MDUE_PAY_BAL, 
      ACC_DUE_PAYMENT_DATE, ACC_CUR_MREAL_PAY_AMT, ACC_LATEST_PAYMENT_DATE, 
      OVER_DUE_CUR_OVER_DUE_NUM, OVER_DUE_CUR_OVER_DUE_AMT, 
      OVER_DUE_UN_PAY_COR31TO60D, OVER_DUE_UN_PAY_COR61TO90D, 
      OVER_DUE_UN_PAY_COR91TO180, OVER_DUE_UN_PAY_COR180DPLUS, 
      M24_PAYMENT_STR_MONTH, M24_PAYMENT_END_MONTH,
      M24_PAYMENT_STATUS, M60_OVER_DUE_STR_MONTH, M60_OVER_DUE_END_MONTH,
      REC_SEQ, MESS_TYPE, DEB_CARD_PAY_OVERDRAFT_AMT, 
      DEB_CARD_PAY_SHARE_LIMIT, DEB_CARD_PAY_6MAVG_USED_AMT, 
      DEB_CARD_PAY_MAX_USED_BAL, APP_ID from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
			<if test="loanOrCreditAcctStatus != null and loanOrCreditAcctStatus !='' ">
				AND substr(LOAN_OR_CREDIT_ACCT_STATUS,1,1) = #{loanOrCreditAcctStatus}
			</if>
			<if test="loanOrCreditGuaranteeMode != null and loanOrCreditGuaranteeMode =='4'.toString() ">
				AND substr(LOAN_OR_CREDIT_GUARANTEE_MODE,1,1) ='4'
			</if>
			<if test="loanOrCreditGuaranteeMode != null and loanOrCreditGuaranteeMode =='0'.toString() ">
				AND substr(LOAN_OR_CREDIT_GUARANTEE_MODE,1,1) !='4'
			</if>
			<if test="bank != null and bank =='0'.toString() and loanOrCreditOrg != null and loanOrCreditOrg !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${loanOrCreditOrg}%'
			</if>
			<if test="bank != null and bank =='1'.toString() and loanOrCreditOrg != null and loanOrCreditOrg !='' ">
				AND (LOAN_OR_CREDIT_ORG NOT LIKE '%${loanOrCreditOrg}%' OR LOAN_OR_CREDIT_ORG is null)
			</if>
			ORDER BY LOAN_OR_CREDIT_ISSU_DATE asc
		</where>
	</select>
	<select id="queryloanCardInfoById" parameterType="java.lang.String"
		resultMap="loanCardInfo">
		select * from OPAS_PBOC_LOAN_CARD_INFO
		where REC_SEQ =
		#{recSeq,jdbcType=CHAR}
	</select>
	<resultMap id="last5yearOverdue" type="com.huaxia.opas.domain.thirdparty.last5yearOverdue" >
	    <result column="FA_REC_SEQ" property="faRecSeq" jdbcType="CHAR" />
	    <result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
	    <result column="MSG_TYPE" property="msgType" jdbcType="CHAR" />
	    <result column="MONTH" property="month" jdbcType="VARCHAR" />
	    <result column="LAST_MONTHS_STR" property="lastMonthsStr" jdbcType="VARCHAR" />
	    <result column="AMT" property="amt" jdbcType="VARCHAR" />
	    <result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
	    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
	    <result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
	    <result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
	    <result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
	    <result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
	    <result column="APP_ID" property="appId" jdbcType="CHAR" />
  	</resultMap>
  	<select id="querylast5yearOverdue" parameterType="java.util.Map"
		resultMap="last5yearOverdue">
		SELECT MONTH,LAST_MONTHS_STR,AMT
		FROM OPAS_PBOC_LAST5YEAR_OVERDUE
		<where>
		    <if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq} ORDER BY MONTH desc
			</if>
		</where>
	</select>
	<select id="querylast5yearOverdueCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		select count(1) from OPAS_PBOC_LAST5YEAR_OVERDUE
		<where>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq}
			</if>
		</where>
	</select>
	<resultMap id="scBzkMyBankLoanMap" type="java.util.Map" >
	    <result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate" jdbcType="VARCHAR" />
	    <result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt" jdbcType="VARCHAR" />
	    <result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loanOrCreditAcctStatus" jdbcType="VARCHAR" />
  	</resultMap>
	<select id="selectScBzkMyBankLoanCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		select count(*) from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="myBank != null and myBank !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${myBank}%'
			</if>
			<if test="appId != null and appId !='' ">
				AND APP_ID =#{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
		</where>
	</select>
	<select id="selectScBzkMyBankLoanList" parameterType="java.util.Map"
		resultMap="scBzkMyBankLoanMap">
		select LOAN_OR_CREDIT_ISSU_DATE,LOAN_OR_CREDIT_CONT_AMT,LOAN_OR_CREDIT_ACCT_STATUS from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="myBank != null and myBank !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${myBank}%'
			</if>
			<if test="appId != null and appId !='' ">
				AND APP_ID =#{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
		</where>
		ORDER BY LOAN_OR_CREDIT_ISSU_DATE desc
	</select>
	<resultMap id="Grurantee" type="com.huaxia.opas.domain.thirdparty.Grurantee" >
    <result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
    <result column="GUARANTEE_TYPE" property="guaranteeType" jdbcType="VARCHAR" />
    <result column="SEC_LOAN_OR_CREDIT_ISS_ORG" property="secLoanOrCreditIssOrg" jdbcType="VARCHAR" />
    <result column="LOAN_CON_AMT" property="loanConAmt" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_GRANT_DATE" property="guarLoanGrantDate" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_GRANT_EXP_DT" property="guarLoanGrantExpDt" jdbcType="VARCHAR" />
    <result column="GUARANTEE_AMT" property="guaranteeAmt" jdbcType="VARCHAR" />
    <result column="LOAN_AMT" property="loanAmt" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_SORT5" property="guarLoanSort5" jdbcType="VARCHAR" />
    <result column="DUE_PAYMENT_DATE" property="duePaymentDate" jdbcType="VARCHAR" />
    <result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
    <result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
    <result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
    <result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
    <result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
    <result column="APP_ID" property="appId" jdbcType="CHAR" />
  </resultMap>
  <select id="queryGruranteeByAppId" parameterType="java.util.Map"
		resultMap="Grurantee">
	  SELECT  GUARANTEE_TYPE,SEC_LOAN_OR_CREDIT_ISS_ORG, 
      LOAN_CON_AMT, GUAR_LOAN_GRANT_DATE, GUAR_LOAN_GRANT_EXP_DT, 
      GUARANTEE_AMT, LOAN_AMT, GUAR_LOAN_SORT5,
      DUE_PAYMENT_DATE FROM OPAS_PBOC_GRURANTEE
	 <where>
		<if test="appId != null and appId !='' ">
			AND APP_ID = #{appId}
		</if>
		<if test="guaranteeType != null and guaranteeType !='' ">
			AND substr(GUARANTEE_TYPE,1,1) = #{guaranteeType}
		</if>
	 </where>
	</select> 
	<resultMap id="resultBankMessageMap" type="java.util.Map">
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	<select id="selectListPbocInfoPersonBankMessage" parameterType="java.lang.String"
		resultMap="resultBankMessageMap">
		SELECT a.cell_phone,a.c_comp_phone,a.resi_tel,b.company,b.comp_addr,c.resident_addr, b.INFO_UPD_TIME 
		FROM OPAS_PBOC_PERSONAL_INFO a left join  OPAS_PBOC_PROFESSION_INFO b on  a.app_id = b.app_id left join  
		(select d.resident_addr,d.app_id from ( select e.resident_addr,e.app_id from OPAS_PBOC_RESIDENCE_INFO e where e.app_id = #{appId,jdbcType=VARCHAR} order by e.INFO_UPD_TIME desc)d 
        where rownum=1)c on  a.app_id =c.app_id WHERE  a.app_id = #{appId,jdbcType=VARCHAR} 
		ORDER BY a.LST_UPD_TIME  desc,b.INFO_UPD_TIME desc
	</select>
	
	<resultMap id="resultMonthAvePay" type="java.util.Map">
		<result column="OUTSTAND_LOANS_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="outstandLoans6monthAvePay" />
		<result column="NO_PD_CARD_BANK_MAX_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPdCardBankMaxCreditLim" />
		<result column="NO_PD_CARD_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="noPdCard6monthAvePay" />
	</resultMap>
	<select id="queryMonthAvePayById" parameterType="java.lang.String"
		resultMap="resultMonthAvePay">
		select NO_PD_CARD_BANK_MAX_CREDIT_LIM
		from OPAS_PBOC_SHAREANDDEBT_INFO 
		where APP_ID = #{appId,jdbcType=VARCHAR} AND ROWNUM &lt; 2 order by NO_PD_CARD_BANK_MAX_CREDIT_LIM desc
	</select>
	
	<select id="queryOriCompName" parameterType="java.lang.String"
		resultMap="resultGrantAnnuityInfo">
		select
		ORI_COMP_NAME
		from OPAS_PBOC_PUBLIC_ENINSURDEL
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultLoanNoInfo" type="java.util.Map">
	    <result column="FRS_CRED_CRD_ISSUE_MON" jdbcType="VARCHAR" property="frsCredCrdIssueMon" />
	</resultMap>
	
	<select id="queryloanTypeById" parameterType="java.lang.String"
		resultMap="resultLoanNoInfo">
		select
		FRS_CRED_CRD_ISSUE_MON
		from OPAS_PBOC_CREDIT_CUE
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<select id="quertLoanSituation" parameterType="java.lang.String"
		resultType="java.util.Map">
		select (to_number(CREDIT_CARD_ACCT_NUM) + to_number(PERSON_HOU_LOAN_NO)
                +to_number(PERSON_COM_HOU_LOAN_NO) + to_number(OTHER_LOAN_NUM) )as count
        from OPAS_PBOC_CREDIT_CUE
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="loanTypeInfo" type="java.util.Map">
		<result column="LOAN_LOAN_TYPE_SEG" property="loanLoanTypeSeg" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt" jdbcType="VARCHAR" />
		<result column="ACC_CUR_MDUE_PAY_BAL" property="accCurMduePayBal" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loadOrCreditAcctStatus" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="quertPbocLoadCardInfo" parameterType="java.lang.String"
		resultMap="loanTypeInfo">
		select * from  
  		(select distinct b.LOAN_OR_CREDIT_CONT_AMT,b.app_id,b.LOAN_LOAN_TYPE_SEG,b.LOAN_OR_CREDIT_ISSU_DATE,
  	 	b.MESS_TYPE, b.ACC_CUR_MDUE_PAY_BAL, b.LOAN_OR_CREDIT_ACCT_STATUS,
		SUBSTR(b.LOAN_OR_CREDIT_ACCT_STATUS,0,1) AS ACC_STATUS,
		SUBSTR(b.LOAN_LOAN_TYPE_SEG,0,2) AS TYPE_SEG
		from OPAS_PBOC_LOAN_CARD_INFO b )e
		where e.APP_ID = #{appId,jdbcType=VARCHAR} AND e.MESS_TYPE= '01' AND e.ACC_STATUS != '5' AND ROWNUM &lt; 4
		order by e.ACC_STATUS asc,e.TYPE_SEG asc,e.LOAN_OR_CREDIT_ISSU_DATE desc
	</select>
	<resultMap id="loanSpecialDeal" type="java.util.Map">
	<result column="FA_REC_SEQ" jdbcType="CHAR" property="faRecSeq" />
    <result column="MESS_TYPE" jdbcType="CHAR" property="messType" />
    <result column="INSIDE_APP_NO" jdbcType="CHAR" property="insideAppNo" />
    <result column="TYPE" jdbcType="VARCHAR" property="type" />
    <result column="OCCUR_DATE" jdbcType="VARCHAR" property="occurDate" />
    <result column="CHANGING_MONTHS" jdbcType="VARCHAR" property="changingMonths" />
    <result column="OCCUR_AMT" jdbcType="VARCHAR" property="occurAmt" />
    <result column="DETAIL_REC" jdbcType="VARCHAR" property="detailRec" />
    <result column="CRT_TIME" jdbcType="VARCHAR" property="crtTime" />
    <result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
    <result column="LST_UPD_TIME" jdbcType="VARCHAR" property="lstUpdTime" />
    <result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
    <result column="BATCH_DATE" jdbcType="VARCHAR" property="batchDate" />
    <result column="REC_STATUS" jdbcType="CHAR" property="recStatus" />
    <result column="APP_ID" jdbcType="CHAR" property="appId" />
	</resultMap>
	<select id="selectLoanSpecialDealByMap" parameterType="java.util.Map"
		resultMap="loanSpecialDeal">
	  SELECT TYPE,OCCUR_DATE, CHANGING_MONTHS, 
      OCCUR_AMT, DETAIL_REC FROM  OPAS_PBOC_LOAN_CARD_SPETRAD
      WHERE APP_ID = #{appId} AND FA_REC_SEQ = #{faRecSeq} AND MESS_TYPE = #{messType}
	  ORDER BY LST_UPD_TIME asc
	</select>
	<select id="selectLoanSpecialDealCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		 SELECT count(*) FROM  OPAS_PBOC_LOAN_CARD_SPETRAD
      <where>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
	  </where>
	</select>
	
	<resultMap id="queryPbocCompanyAndAddressByAppIdResult" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="ccompPhone" jdbcType="VARCHAR" />
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="queryAllCompPhoneAndCellphoneByAppIdResult" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="UNIT_PHONE" property="ccompPhone" jdbcType="VARCHAR" />
		<result column="PHONE_NUM" property="cellPhone" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryPbocCompanyAndAddressByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
					select APP_ID,COMPANY, COMP_ADDR
		  from OPAS_PBOC_PROFESSION_INFO
		 where app_id = #{appId,jdbcType=VARCHAR}
		 order by info_upd_time desc
	</select>
	
	<select id="queryCompPhoneByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
				 select APP_ID, C_COMP_PHONE,CELL_PHONE
  			 from OPAS_PBOC_PERSONAL_INFO
 			 where app_id = #{appId,jdbcType=VARCHAR}
	</select>
	
	<select id="queryAllCompPhoneByAppId" parameterType="java.lang.String"
		resultMap="queryAllCompPhoneAndCellphoneByAppIdResult">
			 select APP_ID, UNIT_PHONE
  			 from OPAS_PBOC_PROFESSION_INFO
 			 where app_id = #{appId,jdbcType=VARCHAR}
 			 order by info_upd_time desc
	</select>
	
	<select id="queryAllCellphoneByAppId" parameterType="java.lang.String"
		resultMap="queryAllCompPhoneAndCellphoneByAppIdResult">
			 select APP_ID, PHONE_NUM
  			 from PBOC_PHONE_NUMBER_DETAIL
 			 where app_id = #{appId,jdbcType=VARCHAR}
 			 order by  UPDATED_DATE desc
	</select>
	
	<select id="queryResidentAddrByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
			 select APP_ID,RESIDENT_ADDR
         from OPAS_PBOC_RESIDENCE_INFO
        where app_id = #{appId,jdbcType=VARCHAR}
        order by INFO_UPD_TIME desc
	</select>
	<select id="queryMonthApplyCount" parameterType="java.lang.String"
		resultType="java.lang.Integer">
		select QUERY_ORG_1M_SUM3 from (select nvl(max(s.QUERY_ORG_1M_SUM3),0) as QUERY_ORG_1M_SUM3
		from PBOC_QUERYINFO_NEW s where s.app_id = #{appId,jdbcType=VARCHAR}
		order by crt_time desc )
		where rownum=1
	</select>
	<select id="queryNowOrOverdueCount" parameterType="java.lang.String"
		resultType="java.lang.Integer">
			select greatest((select OVER_DUE_CUR_OVER_DUE_AMT
                  from (select nvl(max(to_number(OVER_DUE_CUR_OVER_DUE_AMT)),0) as OVER_DUE_CUR_OVER_DUE_AMT
                          from OPAS_PBOC_LOAN_CARD_INFO
                         where app_id = #{appId,jdbcType=VARCHAR}
                           and OVER_DUE_CUR_OVER_DUE_AMT is not null
                         order by OVER_DUE_CUR_OVER_DUE_AMT desc)
                 where rownum = 1),
                (select AMT
                   from (select nvl(max(to_number(amt)),0) as amt
                           from OPAS_PBOC_LAST5YEAR_OVERDUE
                          where AMT is not null
                            and app_id = #{appId,jdbcType=VARCHAR}
                          order by amt desc)
                  where rownum = 1)) as max
 			 from dual

	</select>
	<select id="queryCurOverdueMax" parameterType="java.lang.String" resultType="java.lang.Integer">
		select greatest((case
	                  when (select overdue_total
	                          from (select to_number(case
	                                                   when (i.overdue_total is null or
	                                                        trim(i.overdue_total) is null) then
	                                                    '0'
	                                                   else
	                                                    i.overdue_total
	                                                 end) overdue_total
	                                  from pboc_debit_credit_basic_info b
	                                  left join PBOC_HISTORY_EXPRESS_INFO i on b.relate_id =
	                                                                           i.relate_id
	                                 where b.app_id = #{appId}
	                                   and b.account_type in ('D1', 'R1', 'R4', 'R2')
	                                   and i.REPAY_STATUS in
	                                       ('1', '2', '3', '4', '5', '6', '7')
	                                 order by overdue_total desc)
	                         where rownum = 1) is null then
	                   0
	                  else
	                   (select overdue_total
	                      from (select to_number(case
	                                               when (i.overdue_total is null or
	                                                    trim(i.overdue_total) is null) then
	                                                '0'
	                                               else
	                                                i.overdue_total
	                                             end) overdue_total
	                              from pboc_debit_credit_basic_info b
	                              left join PBOC_HISTORY_EXPRESS_INFO i on b.relate_id =
	                                                                       i.relate_id
	                             where b.app_id = #{appId}
	                               and b.account_type in ('D1', 'R1', 'R4', 'R2')
	                               and i.REPAY_STATUS in
	                                   ('1', '2', '3', '4', '5', '6', '7')
	                             order by overdue_total desc)
	                     where rownum = 1)
	                end),
	                (case
	                  when (select CUR_OVERDUE_TOTAL
	                          from (SELECT to_number(case
	                                                   when (m.CUR_OVERDUE_TOTAL is null or
	                                                        trim(m.CUR_OVERDUE_TOTAL) is null) then
	                                                    '0'
	                                                   else
	                                                    m.CUR_OVERDUE_TOTAL
	                                                 end) CUR_OVERDUE_TOTAL
	                                  FROM PBOC_DEBIT_CREDIT_BASIC_INFO b
	                                  LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M m ON m.RELATE_ID =
	                                                                             b.RELATE_ID
	                                 WHERE b.APP_ID = #{appId}
	                                   AND b.account_type in ('D1', 'R1', 'R2', 'R4')
	                                 order by CUR_OVERDUE_TOTAL desc)
	                         where rownum = 1) is null then
	                   0
	                  else
	                   (select CUR_OVERDUE_TOTAL
	                      from (SELECT to_number(case
	                                               when (m.CUR_OVERDUE_TOTAL is null or
	                                                    trim(m.CUR_OVERDUE_TOTAL) is null) then
	                                                '0'
	                                               else
	                                                m.CUR_OVERDUE_TOTAL
	                                             end) CUR_OVERDUE_TOTAL
	                              FROM PBOC_DEBIT_CREDIT_BASIC_INFO b
	                              LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M m ON m.RELATE_ID =
	                                                                         b.RELATE_ID
	                             WHERE b.APP_ID = #{appId}
	                               AND b.account_type in ('D1', 'R1', 'R2', 'R4')
	                             order by CUR_OVERDUE_TOTAL desc)
	                     where rownum = 1)
	                end)) as max
	  from dual
	</select>
	
	
	
	<select id="selectCountPbocPersonInfoByAppId" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(*) from  opas_pboc_personal_info
		WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<select id="queryLoanAccountsNum" parameterType="java.lang.String" resultType="java.lang.String">
	   select count(app_id) from opas_pboc_loan_card_info  a where mess_type='01' 
	   and app_id = #{appId,jdbcType=VARCHAR} and a.loan_or_credit_acct_status !='3|结清'
	</select>
	
</mapper>
