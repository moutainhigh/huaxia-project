<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="AllotApply">
	<resultMap id="AllotApplyResultMap" type="com.huaxia.opas.domain.allot.AllotApply">
		<!-- 申请件分配表 -->
		<result column="APP_ID" property="appId" jdbcType="VARCHAR"/>
		<result column="appNo" property="appNo" jdbcType="VARCHAR"/>
		<result column="CURR_OPT_QUEUE" property="currQueue" jdbcType="VARCHAR"/>
		<result column="LAST_OPT_QUEUE" property="lastQueue" jdbcType="VARCHAR"/>
		<result column="CURR_OPT_GROUP" property="currGroup" jdbcType="VARCHAR"/>
		<result column="LAST_OPT_GROUP" property="lastGroup" jdbcType="VARCHAR"/>
		<result column="CURR_OPT_USER" property="currUser" jdbcType="VARCHAR"/>
		<result column="LAST_OPT_USER" property="lastUser" jdbcType="VARCHAR"/>
		<result column="CURR_STATUS" property="currStatus" jdbcType="CHAR"/>
		<result column="CURR_NODE" property="currNode" jdbcType="VARCHAR"/>
		<result column="DEL_STATUS" property="delStatus" jdbcType="CHAR"/>
		<result column="CRT_TEAM_DATE" property="crtTeamDate" jdbcType="TIMESTAMP"/>
		<result column="LST_TEAM_DATE" property="lstTeamDate" jdbcType="TIMESTAMP"/>
		<result column="SUBMIT_TYPE" property="submitType" jdbcType="VARCHAR"/>
		<result column="REVIEW_STATUS" property="reviewStatus" jdbcType="CHAR"/>
		<result column="SUBMIT_STATUS" property="submitStatus" jdbcType="CHAR"/>
		<result column="SUBMIT_MEMO" property="submitMemo" jdbcType="VARCHAR"/>
		<result column="QUEUE_DATE" property="queueDate" jdbcType="TIMESTAMP"/>
		<result column="GROUP_DATE" property="groupDate" jdbcType="TIMESTAMP"/>
		<result column="USER_DATE" property="userDate" jdbcType="TIMESTAMP"/>
		<result column="PROCESS_ID" property="processId" jdbcType="VARCHAR"/>
		<result column="YDJ_FLAG" property="ydjFlag" jdbcType="CHAR"/>
		<result column="MATCHING_CARD_FLAG" property="matchingCardFlag" jdbcType="CHAR"/>
		<result column="SYN_FLAG" property="synFlag" jdbcType="VARCHAR" />
		<result column="BACK_FLAG" property="backFlag" jdbcType="VARCHAR" />
		<result column="LAOJIANFLAG" property="laoJianFlag" jdbcType="VARCHAR" />
		<result column="CURR_USER_NAME" property="currUserName" jdbcType="VARCHAR" />
		<result column="num" property="num" jdbcType="NUMERIC"/>
		<result column="num2" property="num2" jdbcType="NUMERIC"/>
		<result column="num3" property="num3" jdbcType="NUMERIC"/>
		<result column="appCity" property="appCity" jdbcType="VARCHAR"/>
		<result column="appCity2" property="appCity2" jdbcType="VARCHAR"/>
		<result column="appCity3" property="appCity3" jdbcType="VARCHAR"/>
		<result column="GROUP_TEAM_DATE" property="groupTeamDate" jdbcType="TIMESTAMP"/>
		<result column="FRAUD_DATE" property="fraudDate" jdbcType="TIMESTAMP"/>
		<result column="CHECK_MEUOFLAG" property="check_meuoFlag" jdbcType="CHAR"/>
		<result column="BATCH_OPERATE_FLAG" property="batchOperateFlag" jdbcType="VARCHAR"/>
		<result column="BATCH_CREDIT_FLAG" property="batchCreditFlag" jdbcType="CHAR"/>
		<result column="BATCH_APPROVAL_FLAG" property="batchApprovalFlag" jdbcType="CHAR"/>
		<result column="ZSHY_INNER_CHECK" property="zshyInnerCheck" jdbcType="CHAR"/>
		<result column="ALLOT_VERSION" property="allotVersion" jdbcType="NUMERIC"/>
		<!-- 申请件信息表 -->
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="VARCHAR"/>
		<result column="APP_PROD" property="appProd" jdbcType="VARCHAR"/>
		<result column="C1_CNAME" property="c1Cname" jdbcType="VARCHAR"/>
		<result column="C1_CONAME" property="c1CoName" jdbcType="VARCHAR"/>
		<result column="CRT_TIME" property="crtTime" jdbcType="TIMESTAMP"/>
		<result column="C4_APBATCH" property="c4ApBatch" jdbcType="VARCHAR"/>
		<result column="C4_CYCADD1" property="c4CyCadd1" jdbcType="VARCHAR"/>
		<result column="C4_CYCADD2" property="c4CyCadd2" jdbcType="VARCHAR"/>
		<result column="ALLOT_STATUS" property="allotStatus" jdbcType="VARCHAR"/>
		<result column="C4_ABUSER" property="c4AbUser" jdbcType="VARCHAR"/>
		<result column="C5_ABCODE" property="c5AbCode" jdbcType="VARCHAR"/>
		<result column="QUICK_CARD_FLAG" property="quickCardFlag" jdbcType="VARCHAR"/>
		<result column="EXIST_CARD_FLAG" property="existCardFlag" jdbcType="VARCHAR"/> 
		<result column="C5_JCTYPE" property="c5JcType" jdbcType="VARCHAR"/>
		<!-- 三方表 -->
		<result column="NUMBER_READ" property="numberRead" jdbcType="VARCHAR"/>
		
		<!-- 公安链接状态  公安表无申请件编号 appId 需要关联查询  -->
		 <result column="pubPolice" property="pubPolice" jdbcType="VARCHAR"/>
		 <result column="IDENTITY_NO_CHECK_RST" property="ideRst" jdbcType="VARCHAR"/>
		 <result column="NAME_CHECK_RST" property="nameRst" jdbcType="VARCHAR"/>
		<!--決策额度及人行不良 -->
		<result column="PROPOSED_LMT" property="proposedLmt" jdbcType="DOUBLE"/>
		<result column="PBOC_RST_FIN_DESP" property="pbocRstFinDesp" jdbcType="VARCHAR"/>
		<!-- 征信策略 -->
		<result column="CREDIT_DECISION_RESULT" property="creditDecisionResult" jdbcType="VARCHAR"/>
		<result column="CREDIT_DECISION_DESC" property="creditResultDescription" jdbcType="VARCHAR"/>
		<result column="CREDIT_DECISION_LAYER" property="creditDecisionLayer" jdbcType="VARCHAR"/>
		<!-- 审核 -->
		<result column="BATCH_CODE" property="batchCode" jdbcType="CHAR"/>
		<!-- 征信 -->
		<result column="BLOCK_CODE" property="blockCode" jdbcType="VARCHAR"/>
		<result column="CREDIT_REFUSE_REASON" property="creditRefuseReason" jdbcType="VARCHAR"/>
		<result column="AUTO_ID" property="autoId" jdbcType="VARCHAR"/>
		<result column="CRT_DATE" property="crtDate" jdbcType="TIMESTAMP"/>
		<!-- 审批 -->
		<result column="MEMO" property="memo" jdbcType="VARCHAR"/>
		<result column="REFUSE_CODE1" property="refuseCode1" jdbcType="VARCHAR"/>
		<result column="REFUSE_CODE2" property="refuseCode2" jdbcType="VARCHAR"/>
		<result column="REFUSE_CODE3" property="refuseCode3" jdbcType="VARCHAR"/>
		<result column="APPROVE_TIME" property="approveTime" jdbcType="TIMESTAMP"/>
		
		<!-- 腾讯天域分 -->
		<result column="RISKSCORE" property="riskScore" jdbcType="VARCHAR"/>
		<result column="minRiskScore" property="minRiskScore" jdbcType="VARCHAR"/>
		<result column="maxRiskScore" property="maxRiskScore" jdbcType="VARCHAR"/>
		<!-- 最后征信人员（审批显示） -->
		<result column="CREDITER_NAME" property="crediterName" jdbcType="VARCHAR"/>
		<result column="APPROVE_RETURN" property="approveReturn" jdbcType="VARCHAR"/>
	</resultMap>
	<resultMap id="BaseResultMap" type="com.huaxia.opas.domain.report.KeyMessageModify">
		<!-- 关键信息修改 -->
		<result column="AUTO_ID" property="autoId" jdbcType="VARCHAR"/>
		<result column="APP_ID" property="appId" jdbcType="VARCHAR"/>
		<result column="OPERATOR" property="operator" jdbcType="VARCHAR"/>
		<result column="YDJ_FLAG" property="ydjFlag" jdbcType="CHAR"/>
	</resultMap>
	<!-- 定时器批量 -->
	<select id="selectYdjAppFromC1" parameterType="java.lang.String" resultMap="AllotApplyResultMap">
		select app.APP_ID,app.MATCHING_CARD_FLAG from OPAS_BIZ_INP_APPL_C1 app
		where app.ALLOT_STATUS IS NULL AND app.YDJ_FLAG='1'
	</select>
	<select id="selectBzkAppFromC1" parameterType="java.lang.String" resultMap="AllotApplyResultMap">
		select app.APP_ID,app.MATCHING_CARD_FLAG from OPAS_BIZ_INP_APPL_C1 app
		where app.ALLOT_STATUS IS NULL AND app.YDJ_FLAG='2'
	</select>
	<insert id="insertAppBatch" parameterType="java.util.List">
		insert into OPAS_ALLOT_APPLY_ALLOT 
		(APP_ID,PROCESS_ID,CURR_OPT_QUEUE,LAST_OPT_QUEUE,CURR_OPT_GROUP,LAST_OPT_GROUP,CURR_OPT_USER,CURR_USER_NAME,
		LAST_OPT_USER,CURR_STATUS,CURR_NODE,DEL_STATUS,CRT_TEAM_DATE,LST_TEAM_DATE,SUBMIT_TYPE,REVIEW_STATUS,SUBMIT_STATUS,
		YDJ_FLAG,MATCHING_CARD_FLAG,SYN_FLAG,BACK_FLAG
		) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
				#{item.appId,jdbcType=VARCHAR},
				#{item.processId,jdbcType=VARCHAR},
				#{item.currQueue,jdbcType=VARCHAR},
				#{item.lastQueue,jdbcType=VARCHAR},
				#{item.currGroup,jdbcType=VARCHAR},
				#{item.lastGroup,jdbcType=VARCHAR},
				#{item.currUser,jdbcType=VARCHAR},
				#{item.currUserName,jdbcType=VARCHAR},
				#{item.lastUser,jdbcType=VARCHAR},
				#{item.currStatus,jdbcType=CHAR},
				#{item.currNode,jdbcType=VARCHAR},
				#{item.delStatus,jdbcType=CHAR},
				#{item.crtTeamDate,jdbcType=TIMESTAMP},
				CURRENT_DATE,
				#{item.submitType,jdbcType=VARCHAR},
				#{item.reviewStatus,jdbcType=CHAR},
				#{item.submitStatus,jdbcType=CHAR},
				#{item.ydjFlag,jdbcType=CHAR},
				#{item.matchingCardFlag,jdbcType=CHAR},
				#{item.synFlag,jdbcType=VARCHAR},
				#{item.backFlag,jdbcType=VARCHAR}
			from dual
			)
	    </foreach>
	</insert>
	<update id="updateC1Batch" parameterType="java.util.List">
    	begin  
        <foreach collection="list" item="item" index="index" separator=";" > 
            update OPAS_BIZ_INP_APPL_C1 app
            <set>
            <if test="item.allotStatus !=null and item.allotStatus!=''">
                app.ALLOT_STATUS = #{item.allotStatus}
            </if>
            </set>
            where app.APP_ID = #{item.appId}
            </foreach>
        ;end;
    </update>
	<!-- END -->
	<!-- 批量更新 -->
	<!-- 批量插入临时分配主表 -->
	<insert id="inserBatchByTemp" parameterType="java.util.List">
		insert into OPAS_ALLOT_APPLY_ALLOT_TEMP 
		(APP_ID,CURR_OPT_QUEUE,LAST_OPT_QUEUE,
		CURR_OPT_GROUP,LAST_OPT_GROUP,
		CURR_OPT_USER,CURR_USER_NAME,LAST_OPT_USER,
		CURR_STATUS,CURR_NODE,DEL_STATUS,
		QUEUE_DATE,GROUP_DATE,USER_DATE,LST_TEAM_DATE
		) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
				#{item.appId,jdbcType=VARCHAR},
				#{item.currQueue,jdbcType=VARCHAR},
				#{item.lastQueue,jdbcType=VARCHAR},
				#{item.currGroup,jdbcType=VARCHAR},
				#{item.lastGroup,jdbcType=VARCHAR},
				#{item.currUser,jdbcType=VARCHAR},
				#{item.currUserName,jdbcType=VARCHAR},
				#{item.lastUser,jdbcType=VARCHAR},
				#{item.currStatus,jdbcType=CHAR},
				#{item.currNode,jdbcType=VARCHAR},
				#{item.delStatus,jdbcType=CHAR},
			    #{item.queueDate,jdbcType=TIMESTAMP},
		        #{item.groupDate,jdbcType=TIMESTAMP},
		        #{item.userDate,jdbcType=TIMESTAMP},
		        CURRENT_TIMESTAMP
			from dual
			)
	    </foreach>
	</insert>
	<!-- 根据临时分配主表 关联更新 分配表 -->
	<update id="updateBatchByTemp" parameterType="java.util.ArrayList">
		update  OPAS_ALLOT_APPLY_ALLOT allot
		set (CURR_OPT_QUEUE,LAST_OPT_QUEUE,CURR_OPT_GROUP,LAST_OPT_GROUP,
		     CURR_OPT_USER,CURR_USER_NAME,LAST_OPT_USER,
			CURR_STATUS,CURR_NODE,DEL_STATUS,
			QUEUE_DATE,	GROUP_DATE,USER_DATE,LST_TEAM_DATE
		     )=
		     (
		     select 
			temp.CURR_OPT_QUEUE as b2,temp.LAST_OPT_QUEUE as c2,
			temp.CURR_OPT_GROUP as d2,temp.LAST_OPT_GROUP as e2,
			temp.CURR_OPT_USER as f2,temp.CURR_USER_NAME as g2,temp.LAST_OPT_USER as h2,
			temp.CURR_STATUS as i2,temp.CURR_NODE as j2,temp.DEL_STATUS as k2,
			temp.QUEUE_DATE as l2,temp.GROUP_DATE as m2,temp.USER_DATE as n2,
			temp.LST_TEAM_DATE as o2
			from   OPAS_ALLOT_APPLY_ALLOT_TEMP temp
			where 
			allot.APP_ID=temp.APP_ID
		     )
		   where exists
		   (
		   	select 1 from OPAS_ALLOT_APPLY_ALLOT_TEMP temp
		   	where allot.APP_ID=temp.APP_ID
		   )  
	</update>
	<update id="updateBatchList" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		update OPAS_ALLOT_APPLY_ALLOT allot
		<set>
		   <if test="currQueue !=null and currQueue !=''">
	            allot.CURR_OPT_QUEUE = #{currQueue},
	        </if>
           <if test="lastQueue !=null and lastQueue!=''">
               allot.LAST_OPT_QUEUE = #{lastQueue},
           </if>
           <if test="currGroup !=null and currGroup !=''">
               allot.CURR_OPT_GROUP = #{currGroup},
           </if>
           <if test="lastGroup !=null and lastGroup!=''">
               allot.LAST_OPT_GROUP = #{lastGroup},
           </if>
           <if test="currUser !=null and currUser !=''">
               allot.CURR_OPT_USER = #{currUser},
           </if>
            <if test="currUserName !=null and currUserName !=''">
               allot.CURR_USER_NAME = #{currUserName},
           </if>
           <if test="lastUser !=null and lastUser !=''">
               allot.LAST_OPT_USER = #{lastUser},
           </if> 
           <if test="currStatus !=null and currStatus !=''">
               allot.CURR_STATUS = #{currStatus},
           </if>
           <if test="currNode !=null and currNode !=''">
               allot.CURR_NODE = #{currNode},
           </if>
            <if test="delStatus !=null and delStatus !=''">
               allot.DEL_STATUS = #{delStatus},
           </if>
            <if test="queueDate !=null and queueDate !=''">
               allot.QUEUE_DATE = #{queueDate},
           </if>
            <if test="groupDate !=null and groupDate !=''">
               allot.GROUP_DATE = #{groupDate},
           </if>
           <if test="userDate !=null and userDate !=''">
               allot.USER_DATE = #{userDate},
           </if>
            <if test="batchOperateFlag !=null and batchOperateFlag !=''">
               allot.BATCH_OPERATE_FLAG = #{batchOperateFlag},
           </if>
           <if test="batchCreditFlag !=null and batchCreditFlag !=''">
               allot.BATCH_CREDIT_FLAG = #{batchCreditFlag},
           </if>
            <if test="batchApprovalFlag !=null and batchApprovalFlag !=''">
               allot.BATCH_APPROVAL_FLAG = #{batchApprovalFlag},
            </if>
            <if test="groupTeamDate !=null and groupTeamDate !=''">
	           allot.GROUP_TEAM_DATE = #{groupTeamDate},
	        </if>
            <if test="fraudDate !=null and fraudDate !=''">
               allot.FRAUD_DATE = #{fraudDate},
            </if>
            <if test="allotVersion !=null and allotVersion !=''">
               allot.ALLOT_VERSION = #{allotVersion},
            </if>
            <if test="synFlag != null and synFlag !='' ">
            	allot.SYN_FLAG = #{synFlag},
            </if>
           	   allot.LST_TEAM_DATE = CURRENT_DATE	
		</set>
		where 
		<foreach collection="ids" item="item" open="" close="" separator="OR">
		       allot.APP_ID = #{item} 
		</foreach>
    </update>
	<update id="updateBatchApply" parameterType="java.util.ArrayList">
		<foreach collection="list" item="item" index="index" open="begin" separator=";" close=";end;">
			update OPAS_ALLOT_APPLY_ALLOT allot
			<set>
			   <if test="item.currQueue !=null and item.currQueue !=''">
	               allot.CURR_OPT_QUEUE = #{item.currQueue},
	           </if>
	           <if test="item.lastQueue !=null and item.lastQueue!=''">
	               allot.LAST_OPT_QUEUE = #{item.lastQueue},
	           </if>
	           <if test="item.currGroup !=null and item.currGroup !=''">
	               allot.CURR_OPT_GROUP = #{item.currGroup},
	           </if>
	           <if test="item.lastGroup !=null and item.lastGroup!=''">
	               allot.LAST_OPT_GROUP = #{item.lastGroup},
	           </if>
	           <if test="item.currUser !=null and item.currUser !=''">
	               allot.CURR_OPT_USER = #{item.currUser},
	           </if>
	            <if test="item.currUserName !=null and item.currUserName !=''">
	               allot.CURR_USER_NAME = #{item.currUserName},
	           </if>
	           <if test="item.lastUser !=null and item.lastUser !=''">
	               allot.LAST_OPT_USER = #{item.lastUser},
	           </if>
	           <if test="item.currStatus !=null and item.currStatus !=''">
	               allot.CURR_STATUS = #{item.currStatus},
	           </if>
	           <if test="item.currNode !=null and item.currNode !=''">
	               allot.CURR_NODE = #{item.currNode},
	           </if>
	            <if test="item.delStatus !=null and item.delStatus !=''">
	               allot.DEL_STATUS = #{item.delStatus},
	           </if>
	            <if test="item.queueDate !=null and item.queueDate !=''">
	               allot.QUEUE_DATE = #{item.queueDate},
	           </if>
	            <if test="item.groupDate !=null and item.groupDate !=''">
	               allot.GROUP_DATE = #{item.groupDate},
	           </if>
	           <if test="item.userDate !=null and item.userDate !=''">
	               allot.USER_DATE = #{item.userDate},
	           </if>
	           <if test="item.batchOperateFlag !=null and item.batchOperateFlag !=''">
               		allot.BATCH_OPERATE_FLAG = #{item.batchOperateFlag},
	           </if>
	           <if test="item.batchCreditFlag !=null and item.batchCreditFlag !=''">
	               allot.BATCH_CREDIT_FLAG = #{item.batchCreditFlag},
	           </if>
	            <if test="item.batchApprovalFlag !=null and item.batchApprovalFlag !=''">
	               allot.BATCH_APPROVAL_FLAG = #{item.batchApprovalFlag},
	            </if>
	            <if test="item.groupTeamDate !=null and item.groupTeamDate !=''">
	               allot.GROUP_TEAM_DATE = #{item.groupTeamDate},
	            </if>
	            <if test="item.fraudDate !=null and item.fraudDate !=''">
	               allot.FRAUD_DATE = #{item.fraudDate},
	           </if>
	           <if test="item.allotVersion !=null and item.allotVersion !=''">
              	 allot.ALLOT_VERSION = (#{item.allotVersion}+1),
               </if>
	           	   allot.LST_TEAM_DATE = CURRENT_DATE	
	         </set>
			 where allot.APP_ID = #{item.appId} AND  allot.ALLOT_VERSION = #{item.allotVersion}
		</foreach>
	</update>
	<!-- 审批 转移   回收   分组时间不变  审查可变      征信存在不变 不存在赋值  -->
	<update id="updateByPrimaryKey" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		update OPAS_ALLOT_APPLY_ALLOT
		set
		CURR_OPT_QUEUE = #{currQueue,jdbcType=VARCHAR},
		LAST_OPT_QUEUE = #{lastQueue,jdbcType=VARCHAR},
		CURR_OPT_GROUP = #{currGroup,jdbcType=VARCHAR},
		LAST_OPT_GROUP = #{lastGroup,jdbcType=VARCHAR},
		CURR_OPT_USER = #{currUser,jdbcType=VARCHAR},
		CURR_USER_NAME = #{currUserName,jdbcType=VARCHAR},
		LAST_OPT_USER = #{lastUser,jdbcType=VARCHAR},
		CURR_STATUS = #{currStatus,jdbcType=CHAR},
		CURR_NODE = #{currNode,jdbcType=VARCHAR},
		DEL_STATUS = #{delStatus,jdbcType=CHAR},
		QUEUE_DATE = #{queueDate,jdbcType=TIMESTAMP},
		GROUP_DATE = #{groupDate,jdbcType=TIMESTAMP},
		USER_DATE = #{userDate,jdbcType=TIMESTAMP},
		GROUP_TEAM_DATE = #{groupTeamDate,jdbcType=TIMESTAMP},
		<if test=" check_meuoFlag!=null and check_meuoFlag!=''">
 		CHECK_MEUOFLAG= #{check_meuoFlag,jdbcType=CHAR},
		</if>
		ZSHY_INNER_CHECK = #{zshyInnerCheck,jdbcType=CHAR},
		ALLOT_VERSION = (#{allotVersion,jdbcType=NUMERIC}+1),
		LST_TEAM_DATE=CURRENT_TIMESTAMP
		where APP_ID = #{appId,jdbcType=VARCHAR} AND ALLOT_VERSION = #{allotVersion,jdbcType=NUMERIC} AND 
		CURR_NODE = #{currNode,jdbcType=VARCHAR}
	</update>
	<update id="updateBatchByIds" parameterType="java.util.ArrayList">
		<foreach collection="list" item="item" index="index" open="begin" separator=";" close=";end;">
			update OPAS_ALLOT_APPLY_ALLOT allot
			<set>
				CURR_OPT_QUEUE = #{item.currQueue,jdbcType=VARCHAR},
				LAST_OPT_QUEUE = #{item.lastQueue,jdbcType=VARCHAR},
				CURR_OPT_GROUP = #{item.currGroup,jdbcType=VARCHAR},
				LAST_OPT_GROUP = #{item.lastGroup,jdbcType=VARCHAR},
				CURR_OPT_USER = #{item.currUser,jdbcType=VARCHAR},
				CURR_USER_NAME = #{item.currUserName,jdbcType=VARCHAR},
				LAST_OPT_USER = #{item.currUser,jdbcType=VARCHAR},
				CURR_STATUS = #{item.currStatus,jdbcType=CHAR},
				CURR_NODE = #{item.currNode,jdbcType=VARCHAR},
				DEL_STATUS = #{item.delStatus,jdbcType=CHAR},
				QUEUE_DATE = #{item.queueDate,jdbcType=TIMESTAMP},
				GROUP_DATE = #{item.groupDate,jdbcType=TIMESTAMP},
				USER_DATE = #{item.userDate,jdbcType=TIMESTAMP},
				GROUP_TEAM_DATE = #{item.groupTeamDate,jdbcType=TIMESTAMP},
				<if test=" item.check_meuoFlag!=null and item.check_meuoFlag!=''">
		 		CHECK_MEUOFLAG= #{item.check_meuoFlag,jdbcType=CHAR},
				</if>
				ZSHY_INNER_CHECK = #{item.zshyInnerCheck,jdbcType=CHAR},
				ALLOT_VERSION = #{item.allotVersion,jdbcType=NUMERIC},
				LST_TEAM_DATE=CURRENT_TIMESTAMP
	         </set>
			 where allot.APP_ID = #{item.appId} 
		</foreach>
	</update>
	<!-- 更新  不加乐观锁标识 -->
	<update id="updateAllotApply" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		update OPAS_ALLOT_APPLY_ALLOT
		<set>
			<if test="currQueue != null  ">CURR_OPT_QUEUE = #{currQueue,jdbcType=VARCHAR},</if>
			<if test="lastQueue != null  ">LAST_OPT_QUEUE = #{lastQueue,jdbcType=VARCHAR},</if>
			<if test="currGroup != null  ">CURR_OPT_GROUP = #{currGroup,jdbcType=VARCHAR},</if>
			<if test="lastGroup != null  ">LAST_OPT_GROUP = #{lastGroup,jdbcType=VARCHAR},</if>
			<if test="currUser != null  ">CURR_OPT_USER = #{currUser,jdbcType=VARCHAR},</if>
			<if test="currUserName != null  ">CURR_USER_NAME = #{currUserName,jdbcType=VARCHAR},</if>
			<if test="lastUser != null ">LAST_OPT_USER = #{lastUser,jdbcType=VARCHAR},</if>
			<if test="currStatus != null  ">CURR_STATUS = #{currStatus,jdbcType=CHAR},</if>
			<if test="currNode != null  ">CURR_NODE = #{currNode,jdbcType=VARCHAR},</if>
			<if test="delStatus != null  ">DEL_STATUS = #{delStatus,jdbcType=CHAR},</if>
			<if test="queueDate != null ">QUEUE_DATE = #{queueDate,jdbcType=TIMESTAMP},</if>
			<if test="groupDate != null">GROUP_DATE = #{groupDate,jdbcType=TIMESTAMP},</if>
			USER_DATE = #{userDate,jdbcType=TIMESTAMP},
			<if test="crtTeamDate != null">CRT_TEAM_DATE = #{crtTeamDate,jdbcType=TIMESTAMP},</if>
			LST_TEAM_DATE=CURRENT_TIMESTAMP,
			<if test="submitType != null  ">SUBMIT_TYPE = #{submitType,jdbcType=VARCHAR},</if>
			<if test="reviewStatus != null  ">REVIEW_STATUS = #{reviewStatus,jdbcType=CHAR},</if>
			<if test="submitStatus != null ">SUBMIT_STATUS = #{submitStatus,jdbcType=CHAR},</if>
			<if test="submitMemo != null  ">SUBMIT_MEMO = #{submitMemo,jdbcType=VARCHAR},</if>
			<if test="processId != null  ">PROCESS_ID = #{processId,jdbcType=VARCHAR},</if>
			<if test="ydjFlag != null  ">YDJ_FLAG = #{ydjFlag,jdbcType=CHAR},</if>
			<if test="matchingCardFlag != null ">MATCHING_CARD_FLAG = #{matchingCardFlag,jdbcType=CHAR},</if>
			<if test="synFlag != null  ">SYN_FLAG = #{synFlag,jdbcType=VARCHAR},</if>
			<if test="backFlag != null  ">BACK_FLAG = #{backFlag,jdbcType=VARCHAR},</if>
			<if test="laoJianFlag != null ">LAOJIANFLAG = #{laoJianFlag,jdbcType=VARCHAR},</if>
			<if test="batchOperateFlag != null ">BATCH_OPERATE_FLAG = #{batchOperateFlag,jdbcType=CHAR},</if>
			<if test="batchCreditFlag != null ">BATCH_CREDIT_FLAG = #{batchCreditFlag,jdbcType=CHAR},</if>
			<if test="batchApprovalFlag != null ">BATCH_APPROVAL_FLAG = #{batchApprovalFlag,jdbcType=CHAR},</if>
			<if test="groupTeamDate != null">GROUP_TEAM_DATE = #{groupTeamDate,jdbcType=TIMESTAMP},</if>
			<if test="fraudDate != null">FRAUD_DATE = #{fraudDate,jdbcType=TIMESTAMP},</if>
			<if test="check_meuoFlag != null">CHECK_MEUOFLAG = #{check_meuoFlag,jdbcType=CHAR},</if>
			<if test="zshyInnerCheck != null">ZSHY_INNER_CHECK = #{zshyInnerCheck,jdbcType=CHAR},</if>
			<if test="allotVersion != null">ALLOT_VERSION =(#{allotVersion,jdbcType=NUMERIC}+1) </if>
		</set>
		where APP_ID = #{appId,jdbcType=VARCHAR} 
	</update>
	<!-- 节点之间更新 -->
	<update id="update" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		update OPAS_ALLOT_APPLY_ALLOT
		set
			CURR_OPT_QUEUE = #{currQueue,jdbcType=VARCHAR},
			LAST_OPT_QUEUE = #{lastQueue,jdbcType=VARCHAR},
			CURR_OPT_GROUP = #{currGroup,jdbcType=VARCHAR},
			LAST_OPT_GROUP = #{lastGroup,jdbcType=VARCHAR},
			CURR_OPT_USER = #{currUser,jdbcType=VARCHAR},
			CURR_USER_NAME = #{currUserName,jdbcType=VARCHAR},
			LAST_OPT_USER = #{currUser,jdbcType=VARCHAR},
			CURR_STATUS = #{currStatus,jdbcType=CHAR},
			CURR_NODE = #{currNode,jdbcType=VARCHAR},
			DEL_STATUS = #{delStatus,jdbcType=CHAR},
			QUEUE_DATE = #{queueDate,jdbcType=TIMESTAMP},
			GROUP_DATE = #{groupDate,jdbcType=TIMESTAMP},
			USER_DATE = #{userDate,jdbcType=TIMESTAMP},
			CRT_TEAM_DATE = #{crtTeamDate,jdbcType=TIMESTAMP},
			LST_TEAM_DATE = #{lstTeamDate,jdbcType=TIMESTAMP},
			SUBMIT_TYPE = #{submitType,jdbcType=VARCHAR},
			REVIEW_STATUS = #{reviewStatus,jdbcType=CHAR},
			SUBMIT_STATUS = #{submitStatus,jdbcType=CHAR},
			SUBMIT_MEMO = #{submitMemo,jdbcType=VARCHAR},
			PROCESS_ID = #{processId,jdbcType=VARCHAR},
			YDJ_FLAG = #{ydjFlag,jdbcType=CHAR},
			MATCHING_CARD_FLAG = #{matchingCardFlag,jdbcType=CHAR},
			SYN_FLAG = #{synFlag,jdbcType=VARCHAR},
			BACK_FLAG = #{backFlag,jdbcType=VARCHAR},
			LAOJIANFLAG = #{laoJianFlag,jdbcType=VARCHAR},
			GROUP_TEAM_DATE = #{groupTeamDate,jdbcType=TIMESTAMP},
		    FRAUD_DATE = #{fraudDate,jdbcType=TIMESTAMP}
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</update>
	<!-- end -->
	<insert id="insertAllotApply" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		insert into OPAS_ALLOT_APPLY_ALLOT (
		APP_ID,CURR_OPT_QUEUE,LAST_OPT_QUEUE,CURR_OPT_GROUP,
		LAST_OPT_GROUP,	CURR_OPT_USER,CURR_USER_NAME,LAST_OPT_USER,
		CURR_STATUS,CURR_NODE,DEL_STATUS,CRT_TEAM_DATE,LST_TEAM_DATE,
		SUBMIT_TYPE,REVIEW_STATUS,SUBMIT_STATUS,SUBMIT_MEMO,
		QUEUE_DATE,GROUP_DATE,USER_DATE,PROCESS_ID,YDJ_FLAG,MATCHING_CARD_FLAG,
		SYN_FLAG,BACK_FLAG,LAOJIANFLAG,GROUP_TEAM_DATE,FRAUD_DATE
		) 
		values (
			#{appId,jdbcType=VARCHAR},
			#{currQueue,jdbcType=VARCHAR},
			#{lastQueue,jdbcType=VARCHAR},
			#{currGroup,jdbcType=VARCHAR},
			#{lastGroup,jdbcType=VARCHAR},
			#{currUser,jdbcType=VARCHAR},
			#{currUserName,jdbcType=VARCHAR},
			#{lastUser,jdbcType=VARCHAR},
			#{currStatus,jdbcType=CHAR},
			#{currNode,jdbcType=VARCHAR},
			#{delStatus,jdbcType=CHAR},
			#{crtTeamDate,jdbcType=TIMESTAMP},
			CURRENT_DATE,
			#{submitType,jdbcType=VARCHAR},
			#{reviewStatus,jdbcType=CHAR},
			#{submitStatus,jdbcType=CHAR},
			#{submitMemo,jdbcType=VARCHAR},
			#{queueDate,jdbcType=TIMESTAMP},
			#{groupDate,jdbcType=TIMESTAMP},
			#{userDate,jdbcType=TIMESTAMP},
			#{processId,jdbcType=VARCHAR},
			#{ydjFlag,jdbcType=CHAR},
			#{matchingCardFlag,jdbcType=CHAR},
			#{synFlag,jdbcType=VARCHAR},
			#{backFlag,jdbcType=VARCHAR},
			#{laoJianFlag,jdbcType=VARCHAR},
			#{groupTeamDate,jdbcType=TIMESTAMP},
			#{fraudDate,jdbcType=TIMESTAMP}
		)
	</insert>
	<insert id="insertAllotApplySelective" parameterType="com.huaxia.opas.domain.allot.AllotApply">
		insert into OPAS_ALLOT_APPLY_ALLOT
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="appId != null">APP_ID,</if>
			<if test="currQueue != null">CURR_OPT_QUEUE,</if>
			<if test="lastQueue != null">LAST_OPT_QUEUE,</if>
			<if test="currGroup != null">CURR_OPT_GROUP,</if>
			<if test="lastGroup != null">LAST_OPT_GROUP,</if>
			<if test="currUser != null">CURR_OPT_USER,</if>
			<if test="currUserName != null">CURR_USER_NAME,</if>
			<if test="lastUser != null">LAST_OPT_USER,</if>
			<if test="currStatus != null">CURR_STATUS,</if>
			<if test="currNode != null">CURR_NODE,</if>
			<if test="delStatus != null">DEL_STATUS,</if>
			<if test="crtTeamDate != null">CRT_TEAM_DATE,</if>
			LST_TEAM_DATE,
			<if test="submitType != null">SUBMIT_TYPE,</if>
			<if test="reviewStatus != null">REVIEW_STATUS,</if>
			<if test="submitStatus != null">SUBMIT_STATUS,</if>
			<if test="submitMemo != null">SUBMIT_MEMO,</if>
			<if test="queueDate != null">QUEUE_DATE,</if>
			<if test="groupDate != null">GROUP_DATE,</if>
			<if test="userDate != null">USER_DATE,</if>
			<if test="processId != null">PROCESS_ID,</if>
			<if test="ydjFlag != null">YDJ_FLAG,</if>
			<if test="matchingCardFlag != null">MATCHING_CARD_FLAG,</if>
			<if test="synFlag != null">SYN_FLAG,</if>
			<if test="backFlag != null">BACK_FLAG,</if>
			<if test="laoJianFlag != null">LAOJIANFLAG,</if>
			<if test="groupTeamDate != null">GROUP_TEAM_DATE,</if>
			<if test="fraudDate != null">FRAUD_DATE</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="appId != null">#{appId,jdbcType=VARCHAR},</if>
			<if test="currQueue != null">#{currQueue,jdbcType=VARCHAR},</if>
			<if test="lastQueue != null">#{lastQueue,jdbcType=VARCHAR},</if>
			<if test="currGroup != null">#{currGroup,jdbcType=VARCHAR},</if>
			<if test="lastGroup != null">#{lastGroup,jdbcType=VARCHAR},</if>
			<if test="currUser != null">#{currUser,jdbcType=VARCHAR},</if>
			<if test="currUserName != null">#{currUserName,jdbcType=VARCHAR},</if>
			<if test="lastUser != null">#{lastUser,jdbcType=VARCHAR},</if>
			<if test="currStatus != null">#{currStatus,jdbcType=CHAR},</if>
			<if test="currNode != null">#{currNode,jdbcType=CHAR},</if>
			<if test="delStatus != null">#{delStatus,jdbcType=CHAR},</if>
			<if test="crtTeamDate != null">#{crtTeamDate,jdbcType=TIMESTAMP},</if>
			CURRENT_DATE,
			<if test="submitType != null">#{submitType,jdbcType=VARCHAR},</if>
			<if test="reviewStatus != null">#{reviewStatus,jdbcType=CHAR},</if>
			<if test="submitStatus != null">#{submitStatus,jdbcType=CHAR},</if>
			<if test="submitMemo != null">#{submitMemo,jdbcType=VARCHAR},</if>
			<if test="queueDate != null">#{queueDate,jdbcType=TIMESTAMP},</if>
			<if test="groupDate != null">#{groupDate,jdbcType=TIMESTAMP},</if>
			<if test="userDate != null">#{userDate,jdbcType=TIMESTAMP},</if>
			<if test="processId != null">#{processId,jdbcType=CHAR},</if>
			<if test="ydjFlag != null">#{ydjFlag,jdbcType=CHAR},</if>
			<if test="matchingCardFlag != null">#{matchingCardFlag,jdbcType=CHAR},</if>
			<if test="synFlag != null">#{synFlag,jdbcType=VARCHAR},</if>
			<if test="backFlag != null">#{backFlag,jdbcType=VARCHAR},</if>
			<if test="laoJianFlag != null">#{laoJianFlag,jdbcType=VARCHAR},</if>
			<if test="groupTeamDate != null">#{groupTeamDate,jdbcType=TIMESTAMP},</if>
			<if test="fraudDate != null">#{fraudDate,jdbcType=TIMESTAMP}</if>
		</trim>
	</insert>
	<!-- 手动申请件各环节待分配件数量 -->
	<select id="selectCount"  parameterType="java.util.Map" resultType="java.lang.Integer"> 
		select count(1) from
			 (
			 	select 
				distinct substr(allot.app_id,1,15) 
			 	from 
			 	opas_allot_apply_allot allot
			 	left join OPAS_BIZ_INP_APPL_C1  ac on  allot.APP_ID=ac.APP_ID
			 	left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
			 	 where 
			 	  allot.SYN_FLAG='0' 
				and allot.DEL_STATUS in ('0','2','3') 
				<if test=" stopStr != null and stopStr !=''  ">
				    ${stopStr}
			    </if>
				<if test="currNode != null and currNode !='' ">
						and allot.CURR_NODE = #{currNode} 
				</if>
				<if test="quickStr != null and quickStr !=''  ">
				    ${quickStr}
			    </if>
				<if test="ydjStr != null and ydjStr !='' ">
				        ${ydjStr}
			    </if>
				<if test="ydjFlag != null and ydjFlag !='' ">
						and allot.YDJ_FLAG = #{ydjFlag} 
				</if>
				<if test="currStatusList != null and currStatusList.size() != 0 ">
					AND allot.CURR_STATUS in
					<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
					close=")">
						#{item}
					</foreach>
				</if>
				<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			    </if>
			    <if test="fraudStr != null and fraudStr !=''  ">
				    ${fraudStr}
			    </if>
			    <if test="currQueue != null and currQueue !='' ">
					 AND allot.CURR_OPT_QUEUE =#{currQueue}
				</if>
				 <if test="currGroup != null and currGroup !='' ">
					  AND allot.CURR_OPT_GROUP =#{currGroup}
			    </if>
			    <if test="currUser != null and currUser !='' ">
					 AND allot.CURR_OPT_USER =#{currUser}
				</if>
				<if test="submitStr != null and submitStr !='' ">
					  and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
				</if>
				<if test="submitStr == null or submitStr =='' ">
					 and allot.SUBMIT_TYPE is not null
				</if>
			 ) apply
 		
	</select> 
	<!-- 根据组  查询组内  未分配件 页面展示 success-->
	<select id="selectAllotApplyByGroup" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select distinct substr(allot.app_id,1,15) as appNo,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK  
		 from  OPAS_ALLOT_APPLY_ALLOT allot
		 left join OPAS_BIZ_INP_APPL_C1  ac on  allot.APP_ID=ac.APP_ID
	 	 left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	         where rn=1) info on allot.APP_ID=info.APP_ID
		where 
		    allot.DEL_STATUS in ('0','2','3') 
		    and allot.SYN_FLAG='0' 
		     <if test=" stopStr != null and stopStr !=''  ">
				    ${stopStr}
			 </if>
			<if test="currStatusList != null and currStatusList.size() != 0 ">
				AND allot.CURR_STATUS in
				<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
				close=")">
					#{item}
				</foreach>
			</if>
			<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP =#{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE =#{currNode}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG =#{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				        ${ydjStr}
		    </if>
	    	<if test="submitStr != null and submitStr !='' ">
			 		 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
					 and allot.SUBMIT_TYPE is not null
			</if>
	</select>
	<!-- 团办号去重 -->
	<select id="selectC4ApBatch" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select  ac.C4_APBATCH,substr(ac.APP_ID,9,2) as appCity ,count(substr(ac.APP_ID,9,2)) as num  
		from OPAS_ALLOT_APPLY_ALLOT  allot
	    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
        left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 where 
		 	ac.C4_APBATCH is not null
		 	and allot.SYN_FLAG='0' 
		 	and allot.DEL_STATUS in ('0', '2','3')
	 		<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if>
		 	<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if>
             group by  ac.C4_APBATCH,substr(ac.APP_ID,9,2)
	</select> 
	<select id="countC4ApBatch" parameterType="java.util.Map" resultType="java.lang.Integer">
			select count(1) from 
			(select  ac.C4_APBATCH,substr(ac.APP_ID,9,2) as appCity ,count(substr(ac.APP_ID,9,2)) as num
			  from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 	where 
		 	 allot.SYN_FLAG='0' 
		 	and ac.C4_APBATCH is not null
		 	and allot.DEL_STATUS in ('0','2','3') 
		 	<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if>
		 	<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="submitStr != null and submitStr !='' ">
				 AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if> 
             group by  ac.C4_APBATCH,substr(ac.APP_ID,9,2))  d
	</select>
	<!-- 项目号去重 -->
	<select id="selectC5JCType" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select  ac.C5_JCTYPE,substr(ac.APP_ID,9,2) as appCity ,count(substr(ac.APP_ID,9,2)) as num  
		from OPAS_ALLOT_APPLY_ALLOT  allot
	    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
        left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 where 
			allot.SYN_FLAG='0' 
		 	and ac.C5_JCTYPE is not null
		 	and allot.DEL_STATUS in ('0', '2','3')
	 		<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if>
		 	<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if>
             group by  ac.C5_JCTYPE,substr(ac.APP_ID,9,2)
	</select> 
	<select id="countC5JCType" parameterType="java.util.Map" resultType="java.lang.Integer">
			select count(1) from 
			(select  ac.C5_JCTYPE,substr(ac.APP_ID,9,2) as appCity ,count(substr(ac.APP_ID,9,2)) as num
			  from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 	where 
		 	 allot.SYN_FLAG='0' 
		 	and ac.C5_JCTYPE is not null
		 	and allot.DEL_STATUS in ('0','2','3') 
		 	<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if>
		 	<if test="prodStr != null and prodStr !='' ">
					 ${prodStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="submitStr != null and submitStr !='' ">
				 AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if> 
             group by  ac.C5_JCTYPE,substr(ac.APP_ID,9,2))  d
	</select>
	<!-- 推广机构 -->
	<select id="selectC5AbCode" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select  ac.C5_ABCODE,substr(ac.APP_ID,9,2) as appCity2,count(substr(ac.APP_ID,9,2)) as num2
		   from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 where 
		  allot.SYN_FLAG='0' 
		 and   ac.C5_ABCODE is not null
		 and allot.DEL_STATUS in ('0','2','3') 
		 <if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		 </if>
	 	<if test="prodStr != null and prodStr !='' ">
				 ${prodStr}
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
		</if>
		<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
		</if>
		<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
		</if>
		<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
		</if>
		<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
		</if>
		<if test="submitStr != null and submitStr !='' ">
			AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 AND allot.SUBMIT_TYPE is not null
		</if>
		group by ac.C5_ABCODE,substr(ac.APP_ID,9,2)
	</select> 
	<select id="countC5AbCode" parameterType="java.util.Map" resultType="java.lang.Integer">
		select count(1) from 
			(select  ac.C5_ABCODE,substr(ac.APP_ID,9,2) as appCity2,count(substr(ac.APP_ID,9,2)) as num2 
			from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 	where 
		 	 allot.SYN_FLAG='0' 
		 	and ac.C5_ABCODE is not null
		 	and allot.DEL_STATUS in ('0','2','3')
		 	<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if> 
		 	<if test="prodStr != null and prodStr !='' ">
				 ${prodStr}
		    </if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="submitStr != null and submitStr !='' ">
			     AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if>
             group by  ac.C5_ABCODE,substr(ac.APP_ID,9,2))  d
	</select>
	<!-- 推广人员 -->
	<select id="selectC4AbUser" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select  ac.C4_ABUSER,substr(ac.APP_ID,9,2) as appCity3 ,count(substr(ac.APP_ID,9,2)) as num3
		 from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 where 
		  allot.SYN_FLAG='0' 
		 and  ac.C4_ABUSER is not null
		 and allot.DEL_STATUS in ('0','2','3') 
		 <if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		 </if> 
		 <if test="prodStr != null and prodStr !='' ">
				 ${prodStr}
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
		</if>
		<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
		</if>
		<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
		</if>
		<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
		</if>
		<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
		</if>
		<if test="submitStr != null and submitStr !='' ">
		     AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 AND allot.SUBMIT_TYPE is not null
		</if>
		group by ac.C4_ABUSER,substr(ac.APP_ID,9,2)
	</select> 
	<select id="countC4AbUser" parameterType="java.util.Map" resultType="java.lang.Integer">
		select count(1) from 
			(select  ac.C4_ABUSER,substr(ac.APP_ID,9,2) as appCity3 ,count(substr(ac.APP_ID,9,2)) as num3 
			from  OPAS_ALLOT_APPLY_ALLOT  allot
		    left join OPAS_BIZ_INP_APPL_C1  ac on 	allot.APP_ID=ac.APP_ID 
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		 	where 
		 	allot.SYN_FLAG='0' 
		 	and  ac.C4_ABUSER is not null
		 	and allot.DEL_STATUS in ('0','2','3')
		 	<if test=" stopStr != null and stopStr !=''  ">
			    ${stopStr}
		    </if>  
		 	<if test="prodStr != null and prodStr !='' ">
				 ${prodStr}
		    </if>
			<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="submitStr != null and submitStr !='' ">
			     AND (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 AND allot.SUBMIT_TYPE is not null
			</if>
             group by  ac.C4_ABUSER,substr(ac.APP_ID,9,2))  d
	</select>
				  
	<!-- 申请件信息基本信息筛选 -->
	<select id="selectReviewApplication" parameterType="java.util.Map" resultType="java.lang.String">
			select  allot.APP_ID from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join  OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA  t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001  l  on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	     left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	 	where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	 	</if>
	 	 	left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 		left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
			left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
			left join TRD_OPERATOR_ONLINE ton on allot.APP_ID=ton.app_id
			left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
			left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
			left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID <!-- 网申平台风险调查-wenyh -->
			where 
			      allot.SYN_FLAG='0' 
			     AND allot.DEL_STATUS in ('0','2','3')
			 <if test="misszdResult != null and misszdResult !='' ">
				 AND wsri.MISSZD_RESULT = '1'
			 </if>
			 <if test="policeRxbd =='1'.toString() ">
				 AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			 </if>
			 <if test="policeRxbd =='2'.toString() ">
				 AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			 </if>
			 <if test="policeRxbd =='3'.toString() ">
				 AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			 </if>
			 <if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
			<if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test='c4AbUser != null and c4AbUser !="" '>
				AND ac.C4_ABUSER = #{c4AbUser}
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
					${nowStr}
			</if> 
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<!-- 易达金80 81 82 83 84 85  卡筛选  -->
	<select id="selectYdjTelAppProd" parameterType="Map" resultType="java.lang.String">
		select  allot.APP_ID
		 from  OPAS_ALLOT_APPLY_ALLOT allot
	 	 inner join  OPAS_BIZ_INP_APPL_C1 ac on  allot.APP_ID=ac.APP_ID
	 	 <if test="safeStr !=null and safeStr !='' ">
	 	 left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
         </if>
         left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
         left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
         left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	 where rn=1) info on allot.APP_ID=info.APP_ID
	   	 left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	 left join TRD_HAR_LD00001  l  on allot.APP_ID=l.APP_ID
	 	 <if test="fqzValue !=null and fqzValue !='' ">
	 	 left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	 where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	 </if>
	 	 left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
 		left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		 left join TRD_OPERATOR_ONLINE ton on allot.APP_ID=ton.app_id
		 left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
		 left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
		 left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID <!-- 网申平台风险调查-wenyh -->
		 where 
		      allot.SYN_FLAG='0' 
			 AND allot.DEL_STATUS in ('0','2','3') 
			  AND ac.APP_PROD in ('0080','0081','0082','0083','0084','0085') 
			<if test="misszdResult != null and misszdResult !='' ">
				AND wsri.MISSZD_RESULT = '1'
			</if>
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		    <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
			<if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if>
		  	<if test='c1CoName != null and c1CoName !="" '>
			    AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')=#{crtTime}
			</if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='c4AbUser != null and c4AbUser !="" '>
				AND ac.C4_ABUSER = #{c4AbUser}
			</if>
				<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<!-- 不安全推广人员 promoter.CURR_STATUS='1' 启用  -->
	<!-- 蚂蚁评分 及地址 电话 证件  等 -->
	<select id="selectReviewAppByIVS" parameterType="java.util.Map" resultType="java.lang.String">
			select ivs.APP_ID from OPAS_BIZ_ZM_IVS_DATA ivs,OPAS_ALLOT_APPLY_ALLOT allot
			where 
			allot.APP_ID=ivs.APP_ID
			AND allot.DEL_STATUS in ('0','2','3') 
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE  = #{currQueue}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP  = #{currGroup}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER  = #{currUser}
			</if>
			<if test="minIvsScore != null and minIvsScore !='' ">
			 	<![CDATA[AND  isnumber2(trimorre(ivs.IVS_SCORE)) >=#{minIvsScore,jdbcType=NUMERIC} ]]>
			</if>
			<if test="maxIvsScore != null and maxIvsScore !='' ">
			  	<![CDATA[AND isnumber2(trimorre(ivs.IVS_SCORE)) <=#{maxIvsScore,jdbcType=NUMERIC} ]]>
			</if> 
			<if test="certNo != null and certNo.size()>0 ">
				AND ivs.CODECERTNOENGLISH in 
					<foreach item="item" index="index" collection="certNo" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="name != null and name !=''  ">
				AND ivs.CODENAMEENGLISH = #{name,jdbcType=VARCHAR}
			</if> 
			<if test="email != null and email.size()>0 ">
				AND ivs.CODEEMAILENGLISH in 
					<foreach item="item" index="index" collection="email" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="mobile != null and mobile.size()>0 ">
				AND ivs.CODEPHOENENGLISH in 
					<foreach item="item" index="index" collection="mobile" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="address != null and address.size()>0 ">
				AND ivs.CODEADDRENGLISH in 
					<foreach item="item" index="index" collection="address" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE  = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
	</select>
	<!-- 芝麻评分 -->
	<select id="selectReviewAppByScor" parameterType="java.util.Map" resultType="java.lang.String">
			select scor.APP_ID from OPAS_BIZ_ZM_SCOR_DATA scor,OPAS_ALLOT_APPLY_ALLOT allot
			<where>
					allot.APP_ID=scor.APP_ID
					AND allot.DEL_STATUS in ('0','2','3') 
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="ydjStr != null and ydjStr !='' ">
				    ${ydjStr}
			   </if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="minZmScore != null and minZmScore !=''  ">
			 		<![CDATA[AND  isnumber2(trimorre(scor.ZM_SCORE)) >=#{minZmScore,jdbcType=NUMERIC} ]]>
				</if>
				<if test="maxZmScore != null and maxZmScore !=''  ">
			  		<![CDATA[AND  isnumber2(trimorre(scor.ZM_SCORE)) <=#{maxZmScore,jdbcType=NUMERIC} ]]>
				</if> 
			</where>
	</select>
	<!-- 中征信1000评分 -->
	<select id="selectReviewAppByCue" parameterType="java.util.Map" resultType="java.lang.String">
			select cue.APP_ID from OPAS_PBOC_CREDIT_CUE cue,OPAS_ALLOT_APPLY_ALLOT allot
			<where>
				allot.APP_ID=cue.APP_ID
				AND allot.DEL_STATUS in ('0','2','3') 
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
				    AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="ydjStr != null and ydjStr !='' ">
				    ${ydjStr}
			    </if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
					AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
				</if>
				<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
					AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
				</if> 
				<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
					AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
				</if>  
			</where>
	</select>
	<!-- 公安链接状态 -->
	<!-- 标准卡blaze决策额度及描述 人行不良PBOC_RST_FIN_DESP -->
	<select id="selectBzkAppByBlaze" parameterType="java.util.Map" resultType="java.lang.String">
			select sdBlaze.APP_ID from OPAS_FICO_SD_BLAZE sdBlaze, OPAS_ALLOT_APPLY_ALLOT allot
			<where>
				allot.APP_ID=sdBlaze.APP_ID
				AND allot.DEL_STATUS in ('0','2','3') 
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="triggerType == '1'.toString() ">
					AND (to_char(sdBlaze.TRIGGER_TYPE) is null  )
			    </if>
			    <if test="triggerType == '2'.toString() ">
				   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1}) and (sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2}) )
			    </if> 
			     <if test="triggerType == '3'.toString() ">
				     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
			    </if> 
			     <if test="triggerType == '4'.toString() ">
				      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} )
			    </if> 
				<if test="minProposedLmt != null and minProposedLmt !='' and minProposedLmt !=0.0 and minProposedLmt !='-2'">
					AND sdBlaze.PROPOSED_LMT &gt;=#{minProposedLmt}
				</if>
				<if test="maxProposedLmt != null and maxProposedLmt !='' and maxProposedLmt !=0.0  and maxProposedLmt !='-2' ">
					AND sdBlaze.PROPOSED_LMT &lt;=#{maxProposedLmt}
				</if> 
				<if test="minProposedLmt=='-2' and maxProposedLmt =='-2' ">
					AND sdBlaze.PROPOSED_LMT is null
				</if> 
				<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND sdBlaze.PBOC_RST_FIN_DESP is not null
				</if> 
			</where>
	</select>
	<!-- 易达金blaze决策额度及描述  人行不良  cdt_score 区分人行不良 -->
	<select id="selectYdjAppByBlaze" parameterType="java.util.Map" resultType="java.lang.String">
			select ydjBlaze.APP_ID from OPAS_FICO_YDJ_BLAZE ydjBlaze,OPAS_ALLOT_APPLY_ALLOT allot
			<where>
				 allot.APP_ID=ydjBlaze.APP_ID
				 AND allot.DEL_STATUS in ('0','2','3') 
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="triggerType == '1'.toString() ">
					AND (to_char(ydjBlaze.CDT_SCORE) is null  )
			    </if>
			    <if test="triggerType == '2'.toString() ">
				 	AND ( (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1}) and (ydjBlaze.CDT_SCORE &lt;= #{triggerType2}) )
			    </if> 
			     <if test="triggerType == '3'.toString() ">
				    AND ( ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
			    </if> 
			     <if test="triggerType == '4'.toString() ">
				    AND ( ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} )
			    </if> 
				<if test="minProposedLmt != null and minProposedLmt !='' ">
					AND ydjBlaze.PROPOSED_LMT &gt;=#{minProposedLmt}
				</if>
				<if test="maxProposedLmt != null and maxProposedLmt !='' ">
					AND ydjBlaze.PROPOSED_LMT &lt;=#{maxProposedLmt}
				</if> 
				<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
				</if> 
			</where>
	</select>
	<!-- 标准卡征信策略结果及描述及  易达金套卡    -->
	<select id="selectCreditAppByBzkDecision" parameterType="java.util.Map" resultType="java.lang.String">
			select  bzk.APP_ID from OPAS_BZK_SYSRESULT_INFO bzk,OPAS_ALLOT_APPLY_ALLOT allot
			<where>
				allot.APP_ID=bzk.APP_ID
				AND allot.DEL_STATUS in ('0','2','3') 
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG  = #{ydjFlag}
				</if>
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="creditList != null and creditList.size()>0 ">
					AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if> 
				<if test="creditResultList != null and creditResultList.size()>0 ">
					AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="creditLayerList != null and creditLayerList.size()>0 ">
					AND bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
			</where>
	</select>
	<!-- 易达金主卡  征信策略结果及描述 -->
	<select id="selectCreditAppByYdjDecision" parameterType="java.util.Map" resultType="java.lang.String">
			select  ydj.APP_ID from OPAS_YDJ_SYSRESULT_INFO ydj,OPAS_ALLOT_APPLY_ALLOT allot
			<where>
				allot.APP_ID=ydj.APP_ID
				AND allot.DEL_STATUS in ('0','2','3') 
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG  = #{ydjFlag}
				</if>
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE  = #{currQueue}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP  = #{currGroup}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER  = #{currUser}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE  = #{currNode}
				</if>
				<if test="creditList != null and creditList.size()>0 ">
					AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="creditResultList != null and creditResultList.size()>0 ">
					AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="creditLayerList != null and creditLayerList.size()>0 ">
					AND ydj.CREDIT_DECISION_LAYER in 
						<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
			</where>
	</select>
	<!-- 审查批量晒选 -->
	<select id="selectAppByReviewDecision" parameterType="java.util.Map" resultType="java.lang.String">
			select decision.APP_ID from OPAS_REVIEW_DECISION_RESULT decision,OPAS_ALLOT_APPLY_ALLOT allot
			where  allot.APP_ID=decision.APP_ID 
			AND  decision.BATCH_CODE='1'
			 AND allot.CURR_Status='0'
			 AND allot.DEL_STATUS in ('0','2','3') 
			 AND allot.YDJ_FLAG='2'
			 AND allot.CURR_NODE='01'
	</select>
	<!-- 查询数量 -->
	<select id="selectCountByOrder" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT count(allot.APP_ID)
		FROM  OPAS_BIZ_INP_APPL_C1 ac, OPAS_ALLOT_APPLY_ALLOT  allot, OPAS_TEMP_ALLOT temp
		WHERE 
		    allot.APP_ID=ac.APP_ID
		    AND allot.APP_ID=temp.ALLOT_ID 
		    AND allot.SYN_FLAG='0' 
			AND allot.DEL_STATUS in ('0','2','3') 
	 	<if test="currQueue != null and currQueue !='' ">
			AND allot.CURR_OPT_QUEUE  = #{currQueue}
		</if>
		<if test="currGroup != null and currGroup !='' ">
			AND allot.CURR_OPT_GROUP  = #{currGroup}
		</if>
		<if test="currUser != null and currUser !='' ">
			AND allot.CURR_OPT_USER  = #{currUser}
		</if>
		<if test="currStatusList != null and currStatusList.size()>0 ">
			AND allot.CURR_STATUS in 
			<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
 					#{item}  
				</foreach>
		</if>
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode}
		</if>
		<if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG = #{ydjFlag}
		</if> 
		<if test="submitStr != null and submitStr !='' ">
			 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 and allot.SUBMIT_TYPE is not null
		</if>
	</select>
	<!-- 全查询 分页展示排序 -->
	<select id="selectAppListByOrder" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		SELECT 
		 allot.APP_ID,allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
		 ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME,
		allot.CURR_OPT_QUEUE, allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.CURR_NODE,
		allot.DEL_STATUS,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,
		allot.USER_DATE,allot.GROUP_TEAM_DATE,allot.FRAUD_DATE
		FROM  OPAS_BIZ_INP_APPL_C1 ac, OPAS_ALLOT_APPLY_ALLOT  allot, OPAS_TEMP_ALLOT temp
		WHERE 
		    allot.APP_ID=ac.APP_ID
		    AND allot.APP_ID=temp.ALLOT_ID 
		    AND allot.SYN_FLAG='0' 
			AND allot.DEL_STATUS in ('0','2','3') 
	 	<if test="currQueue != null and currQueue !='' ">
			AND allot.CURR_OPT_QUEUE  = #{currQueue}
		</if>
		<if test="currGroup != null and currGroup !='' ">
			AND allot.CURR_OPT_GROUP  = #{currGroup}
		</if>
		<if test="currUser != null and currUser !='' ">
			AND allot.CURR_OPT_USER  = #{currUser}
		</if>
		<if test="currStatusList != null and currStatusList.size()>0 ">
			AND allot.CURR_STATUS in 
			<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
 					#{item}  
				</foreach>
		</if>
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode}
		</if>
		<if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG = #{ydjFlag}
		</if> 
		<if test="submitStr != null and submitStr !='' ">
			 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 and allot.SUBMIT_TYPE is not null
		</if>
		<if test="checkStr != null and checkStr !='' ">
			order by ${checkStr}
		</if>
		<if test="checkStr == null or checkStr =='' ">
			order by ac.CRT_TIME asc,allot.APP_ID asc
		</if>
	</select>
	<!-- 分件处理 排序-->
	<select id="selectAppNoByOrder" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		SELECT 
		 distinct substr(allot.APP_ID,1,15) as appNo,
		 allot.YDJ_FLAG
		FROM  OPAS_BIZ_INP_APPL_C1 ac, OPAS_ALLOT_APPLY_ALLOT  allot
		WHERE allot.APP_ID=ac.APP_ID
		<if test="list != null and list.size()>0 ">
			and  allot.APP_ID IN
			<foreach item="item" index="index" collection="list"
			open="(" separator="," close=")">
		            #{item}
		    </foreach>
		</if>
		<if test="submitStr != null and submitStr !='' ">
			  and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 and allot.SUBMIT_TYPE is not null
		</if>
		order by ac.CRT_TIME asc,allot.APP_ID asc
	</select>
	<resultMap id="TempAllotMap" type="com.huaxia.opas.domain.allot.TempAllot" >
	    <id column="TEMP_ID" property="tempId" jdbcType="CHAR" />
	    <result column="ALLOT_ID" property="allotId" jdbcType="VARCHAR" />
	    <result column="CRT_DATE" property="crtDate" jdbcType="TIMESTAMP" />
  	</resultMap>
	<!-- 往临时表  插入数据 -->
	 <insert id="insertTemp" parameterType="java.util.Map">
		insert into OPAS_TEMP_ALLOT 
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="tempId != null">TEMP_ID,</if>
			<if test="allotId != null">ALLOT_ID,</if>
			CRT_DATE
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="tempId != null">#{tempId,jdbcType=CHAR},</if>
			<if test="allotId != null">#{allotId,jdbcType=VARCHAR},</if>
			CURRENT_TIMESTAMP
		</trim>
	</insert> 
	<!-- 批量导入临时表 -->
	<insert id="insertTempBatch" parameterType="java.util.List" >
		insert into OPAS_TEMP_ALLOT 
		(TEMP_ID,
		ALLOT_ID,
		CRT_DATE
		) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
	      		#{item.tempId,jdbcType=CHAR},
				#{item.allotId,jdbcType=VARCHAR},
				CURRENT_TIMESTAMP
			from dual
			)
	    </foreach>
	</insert>
	<!-- 存储过程批量插入临时表 -->
	<resultMap id="cursorMap" type="java.util.HashMap">
		<id column="APP_ID" property="appId" jdbcType="VARCHAR" />
	    <result column="CURR_OPT_QUEUE" property="currQueue" jdbcType="VARCHAR" />
	    <result column="LAST_OPT_QUEUE" property="lastQueue" jdbcType="VARCHAR" />
	    <result column="CURR_OPT_GROUP" property="currGroup" jdbcType="VARCHAR" />
	    <result column="LAST_OPT_GROUP" property="lastGroup" jdbcType="VARCHAR" />
	    <result column="CURR_OPT_USER" property="currUser" jdbcType="VARCHAR" />
	    <result column="LAST_OPT_USER" property="lastUser" jdbcType="VARCHAR" />
	    <result column="CURR_STATUS" property="currStatus" jdbcType="CHAR" />
	    <result column="DEL_STATUS" property="delStatus" jdbcType="CHAR" />
	    <result column="CURR_NODE" property="currNode" jdbcType="VARCHAR" />
	    <result column="CRT_TEAM_DATE" property="crtTeamDate" jdbcType="TIMESTAMP" />
	    <result column="QUEUE_DATE" property="queueDate" jdbcType="TIMESTAMP" />
	    <result column="GROUP_DATE" property="groupDate" jdbcType="TIMESTAMP" />
	    <result column="SUBMIT_STATUS" property="submitStatus" jdbcType="CHAR" />
	    <result column="SUBMIT_TYPE" property="submitType" jdbcType="VARCHAR" />
	    <result column="LST_TEAM_DATE" property="lstTeamDate" jdbcType="TIMESTAMP" />
	    <result column="SUBMIT_MEMO" property="submitMemo" jdbcType="VARCHAR" />
	    <result column="YDJ_FLAG" property="ydjFlag" jdbcType="CHAR" />
	    <result column="REVIEW_STATUS" property="reviewStatus" jdbcType="CHAR" />
	    <result column="MATCHING_CARD_FLAG" property="matchingCardFlag" jdbcType="CHAR" />
	    <result column="PROCESS_ID" property="processId" jdbcType="VARCHAR" />
	    <result column="USER_DATE" property="userDate" jdbcType="TIMESTAMP" />
	    <result column="SYN_FLAG" property="synFlag" jdbcType="CHAR" />
	    <result column="BACK_FLAG" property="backFlag" jdbcType="VARCHAR" />
	    <result column="LAOJIANFLAG" property="laoJianFlag" jdbcType="VARCHAR" />
	    <result column="BATCH_OPERATE_FLAG" property="batchOperateFlag" jdbcType="CHAR"/>
	    <result column="BATCH_CREDIT_FLAG" property="batchCreditFlag" jdbcType="CHAR"/>
	    <result column="BATCH_APPROVAL_FLAG" property="batchApprovalFlag" jdbcType="CHAR"/>
	    <result column="GROUP_TEAM_DATE" property="groupTeamDate" jdbcType="TIMESTAMP"/>
	    <result column="FRAUD_DATE" property="fraudDate" jdbcType="TIMESTAMP"/>
	</resultMap>
	<parameterMap type="java.util.Map" id="callParame">
		<parameter property="list" mode="IN" jdbcType="ARRAY" javaType="java.util.List" typeHandler="com.huaxia.opas.util.ListHandler" />
		<parameter property="v_ydjFlag" mode="IN" jdbcType="CHAR" javaType="java.lang.String"/>
		<parameter property="v_currNode" mode="IN" jdbcType="VARCHAR" javaType="java.lang.String"/>
		<!-- <parameter property="v_checkStr" mode="IN" jdbcType="NUMERIC" javaType="java.lang.Integer"/> -->
		<!-- <parameter property="v_result" mode="OUT" jdbcType="DECIMAL" javaType="java.lang.Integer"/> -->
		<parameter property="v_cursor" mode="OUT" jdbcType="CURSOR" javaType="java.sql.ResultSet" resultMap="cursorMap" />
	</parameterMap>
	<select id="executeOpasPoTempAllot" statementType="CALLABLE" parameterMap="callParame" >
 		<![CDATA[CALL OPAS_PO_TEMP_ALLOT(?,?,?,?,?)]]>
	</select>
	<!-- 临时表  分配表  联合查询 -->
		<insert id="insertTempTab" parameterType="java.util.List" >
		insert into opas_allot_apply_allot_tempTab 
		(TEMP_ID,
		ALLOT_ID
		) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
	      		sys_guid(),
				#{item.allotId,jdbcType=VARCHAR}
			from dual
			)
	    </foreach>
	</insert>
	<select id="selectAppNoByTemp" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		SELECT 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION
		FROM  OPAS_BIZ_INP_APPL_C1 ac, OPAS_ALLOT_APPLY_ALLOT  allot, OPAS_ALLOT_APPLY_ALLOT_TEMPTAB temp
		WHERE 
		    allot.APP_ID=ac.APP_ID
		    AND allot.APP_ID=temp.ALLOT_ID 
		    AND allot.SYN_FLAG='0' 
			AND allot.DEL_STATUS in ('0','2','3') 
		<if test="currQueue != null and currQueue !='' ">
			AND allot.CURR_OPT_QUEUE  = #{currQueue}
		</if>
		<if test="currGroup != null and currGroup !='' ">
			AND allot.CURR_OPT_GROUP  = #{currGroup}
		</if>
		<if test="currUser != null and currUser !='' ">
			AND allot.CURR_OPT_USER  = #{currUser}
		</if>
		<if test="currStatusList != null and currStatusList.size()>0 ">
			AND allot.CURR_STATUS in 
			<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
 					#{item}  
				</foreach>
		</if>
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode}
		</if>
		<if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG = #{ydjFlag}
		</if> 
		<if test="submitStr != null and submitStr !='' ">
			 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
		</if>
		<if test="submitStr == null or submitStr =='' ">
			 and allot.SUBMIT_TYPE is not null
		</if>
		<if test="checkStr != null and checkStr !='' ">
			order by ${checkStr}
		</if>
		<if test="checkStr == null or checkStr =='' ">
			order by ac.CRT_TIME asc,allot.APP_ID asc
		</if>
	</select>
	
	<select id="selectKeyMessageApp"   resultMap="BaseResultMap">
			select distinct mess.APP_ID,mess.OPERATOR,mess.YDJ_FLAG 
			from OPAS_ALLOT_APPLY_ALLOT allot,OPAS_KEYMESSAGE_MODIFY mess
			where 
			allot.APP_ID=mess.APP_ID 
			AND allot.CURR_NODE='02'
			AND allot.CURR_STATUS='0'
		    AND allot.DEL_STATUS in ('0','2','3') 
	</select>
	<!--手动按申请件编号 -->
	<select id="selectHandCount" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(1) from OPAS_ALLOT_APPLY_ALLOT 
		 where APP_ID LIKE '${_parameter}%'
	</select>
	<select id="selectApplyListByAppId" parameterType="java.lang.String" resultMap="AllotApplyResultMap">
		select 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.CURR_NODE,allot.DEL_STATUS,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,allot.SYN_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION,c.CONCLUSION,c.SOURCE_TYPE 
		from OPAS_ALLOT_APPLY_ALLOT allot
		left join  CAMS_VOICE_CALL_RECORD c on allot.app_id=c.app_id 
		where allot.APP_ID LIKE '${_parameter}%'
	</select>
	<select id="selectHandNum" parameterType="Map" resultType="java.lang.Integer">
		select count(1) from OPAS_ALLOT_APPLY_ALLOT allot
		 where allot.APP_ID LIKE '${appId}%'
		 AND allot.DEL_STATUS in ('0','2','3') 
		<if test="currGroup != null and currGroup !='' ">
			AND allot.CURR_OPT_GROUP  = #{currGroup}
		</if>
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode,jdbcType=VARCHAR}
		</if>
		 <if test="currStatus != null and currStatus !='' ">
			AND allot.CURR_STATUS = #{currStatus,jdbcType=CHAR}
		</if>
		<if test="currStatusList != null and currStatusList.size() != 0 ">
				AND allot.CURR_STATUS in
				<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
				close=")">
					#{item}
				</foreach>
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG  = #{ydjFlag,jdbcType=CHAR}
		</if>
	</select>
	<select id="selectHandByAppId" parameterType="Map" resultMap="AllotApplyResultMap">
		select 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,allot.SYN_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,
		ac.APP_PROD,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION
		from OPAS_BIZ_INP_APPL_C1 ac , OPAS_ALLOT_APPLY_ALLOT allot
		where  allot.APP_ID=ac.APP_ID 
		AND allot.APP_ID LIKE '${appId}%'
		AND allot.DEL_STATUS in ('0','2','3') 
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode,jdbcType=VARCHAR}
		</if>
		 <if test="currStatus != null and currStatus !='' ">
			AND allot.CURR_STATUS = #{currStatus,jdbcType=CHAR}
		</if>
		<if test="currStatusList != null and currStatusList.size() != 0 ">
			AND allot.CURR_STATUS in
			<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
			close=")">
				#{item}
			</foreach>
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG  = #{ydjFlag,jdbcType=CHAR}
		</if>
	</select>
	<select id="selectSingleByAppId" parameterType="Map" resultMap="AllotApplyResultMap">
		select 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,allot.SYN_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,
		ac.APP_PROD,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION,allot.PROCESS_ID,c.APPROVE_RETURN
		from OPAS_BIZ_INP_APPL_C1 ac , OPAS_ALLOT_APPLY_ALLOT allot
		left join  CAMS_VOICE_CALL_RECORD c on allot.app_id=c.app_id and c.CONCLUSION='1' and c.SOURCE_TYPE='0'
		where  allot.APP_ID=ac.APP_ID 
		AND allot.APP_ID=#{appId,jdbcType=VARCHAR} 
		AND allot.DEL_STATUS in ('0','2','3') 
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode,jdbcType=VARCHAR}
		</if>
		 <if test="currStatus != null and currStatus !='' ">
			AND allot.CURR_STATUS = #{currStatus,jdbcType=CHAR}
		</if>
		<if test="currStatusList != null and currStatusList.size() != 0 ">
				AND allot.CURR_STATUS in
				<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
				close=")">
					#{item}
				</foreach>
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG  = #{ydjFlag,jdbcType=CHAR}
		</if>
	</select>
	<select id="selectHand" parameterType="Map" resultMap="AllotApplyResultMap">
		select 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,allot.SYN_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION 
		from OPAS_ALLOT_APPLY_ALLOT allot
		where 
		allot.APP_ID LIKE '${appId}%'
		AND allot.DEL_STATUS in ('0','2','3') 
		<if test="currNode != null and currNode !='' ">
			AND allot.CURR_NODE  = #{currNode,jdbcType=VARCHAR}
		</if>
		 <if test="currStatus != null and currStatus !='' ">
			AND allot.CURR_STATUS = #{currStatus,jdbcType=CHAR}
		</if>
		<if test="currStatusList != null and currStatusList.size() != 0 ">
				AND allot.CURR_STATUS in
				<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
				close=")">
					#{item}
				</foreach>
		</if>
		 <if test="ydjFlag != null and ydjFlag !='' ">
			AND allot.YDJ_FLAG  = #{ydjFlag,jdbcType=VARCHAR}
		</if>
	</select>
	<!-- 组  队列  组员未完成件或者审批池征信员件 -->
	<select id="selectAllotApplyByUser" parameterType="java.util.Map" resultMap="AllotApplyResultMap" >
		SELECT
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION 
		FROM OPAS_ALLOT_APPLY_ALLOT  allot 
		left join OPAS_BIZ_INP_APPL_C1  ac on  allot.APP_ID=ac.APP_ID
	 	left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
         where rn=1) info on allot.APP_ID=info.APP_ID
		where  
			 allot.SYN_FLAG='0' 
			AND  allot.DEL_STATUS in ('0','2','3') 
			<if test="fraudStr != null and fraudStr !=''  ">
				    ${fraudStr}
			</if> 
			<if test=" stopStr != null and stopStr !=''  ">
				    ${stopStr}
		    </if>
			<if test="ydjStr != null and ydjStr !='' ">
				  ${ydjStr}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size() != 0 ">
					AND allot.CURR_STATUS in
					<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
					close=")">
						#{item}
					</foreach>
			</if>
			<if test="prodStr != null and prodStr !='' ">
				 ${prodStr}
		    </if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE  = #{currNode}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG  = #{ydjFlag}
			</if>
			 <if test="submitStr != null and submitStr !='' ">
				  and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE  = #{currQueue}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP  = #{currGroup}
			</if> 
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER  = #{currUser}
			</if>
			<if test="lastUser !=null and lastUser !=''">
                AND allot.LAST_OPT_USER = #{lastUser}
            </if>
			<if test=" nowStr != null and nowStr !=''  ">
					${nowStr}
			</if> 
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<!-- 征信批量过件码 -->
	 <resultMap id="TelcheckResultMap" type="com.huaxia.opas.domain.input.TelcheckResult" >
	    <id column="APP_ID" property="appId" jdbcType="VARCHAR" />
	    <result column="AUTO_ID" property="autoId" jdbcType="VARCHAR" />
	    <result column="BLOCK_CODE" property="blockCode" jdbcType="VARCHAR" />
	    <result column="CREDIT_REFUSE_REASON" property="creditRefuseReason" jdbcType="VARCHAR" />
	    <result column="TELCHECK_RESULT" property="telcheckResult" jdbcType="VARCHAR" />
	    <result column="IDENTITY_RESULT" property="identityResult" jdbcType="VARCHAR" />
	    <result column="CREDIT_TIME" property="creditTime" jdbcType="TIMESTAMP" />
	    <result column="CREDITER" property="crediter" jdbcType="VARCHAR" />
	    <result column="CREDITER_NAME" property="crediterName" jdbcType="VARCHAR" />
	    <result column="CRT_DATE" property="crtDate" jdbcType="TIMESTAMP" />
	    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
	    <result column="CURR_OPT_GROUP" property="currOptGroup" jdbcType="VARCHAR" />
	  	 <result column="YDJ_FLAG" jdbcType="CHAR" property="ydjFlag" />
  	</resultMap>
	<insert id="insertBlockCodeBatch" parameterType="java.util.List">
		insert into OPAS_TELCHECK_RESULT 
		(AUTO_ID,
		APP_ID,
		BLOCK_CODE,
		CREDIT_REFUSE_REASON,YDJ_FLAG,
		CRT_USER,CREDITER,
		CRT_DATE,CREDIT_TIME,CURR_OPT_GROUP) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
	      		#{item.autoId,jdbcType=VARCHAR},
				#{item.appId,jdbcType=VARCHAR},
				#{item.blockCode,jdbcType=VARCHAR},
				#{item.creditRefuseReason,jdbcType=VARCHAR},
				#{item.ydjFlag,jdbcType=CHAR},
				#{item.crtUser,jdbcType=VARCHAR},
				#{item.crediter,jdbcType=VARCHAR},
				CURRENT_TIMESTAMP,
				CURRENT_TIMESTAMP,
				#{item.currOptGroup,jdbcType=VARCHAR}
			from dual
			)
	    </foreach>
	</insert>
	<select id="selectCountBlockCode" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(1) from OPAS_TELCHECK_RESULT
			where APP_ID = '${_parameter}'
	</select>
	<select id="selectBlockCodeList" parameterType="java.util.Map" resultMap="TelcheckResultMap">
		select * from (select AUTO_ID,
		APP_ID,
		BLOCK_CODE,
		CREDIT_REFUSE_REASON,
		YDJ_FLAG,
		CRT_USER,CREDITER,
		CRT_DATE,CREDIT_TIME,
		CURR_OPT_GROUP
		from OPAS_TELCHECK_RESULT 
		where  APP_ID = #{appId}
		order by CRT_DATE desc)
		where rownum = '1'
	</select>
	<insert id="insertBlockCode" parameterType="Map" >
		insert into OPAS_TELCHECK_RESULT
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="autoId != null">AUTO_ID,</if>
			<if test="appId != null">APP_ID,</if>
			<if test="blockCode != null">BLOCK_CODE,</if>
			<if test="creditRefuseReason != null">CREDIT_REFUSE_REASON,</if>
			<if test="ydjFlag != null">YDJ_FLAG,</if>
			<if test="crtUser != null">CRT_USER,</if>
			<if test="crediter != null">CREDITER,</if>
			CRT_DATE,
			CREDIT_TIME,
			<if test="currOptGroup != null">CURR_OPT_GROUP</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="autoId != null">#{autoId,jdbcType=VARCHAR},</if>
			<if test="appId != null">#{appId,jdbcType=VARCHAR},</if>
			<if test="blockCode != null">#{blockCode,jdbcType=VARCHAR},</if>
			<if test="creditRefuseReason != null">#{creditRefuseReason,jdbcType=VARCHAR},</if>
			<if test="ydjFlag != null">#{ydjFlag,jdbcType=CHAR},</if>
			<if test="crtUser != null">#{crtUser,jdbcType=VARCHAR},</if>
			<if test="crediter != null">#{crediter,jdbcType=VARCHAR},</if>
			CURRENT_TIMESTAMP,
			CURRENT_TIMESTAMP,
			<if test="currOptGroup != null">#{currOptGroup,jdbcType=VARCHAR}</if>
		</trim>
	</insert>
	<update id="updateBlockCode" parameterType="Map">
		update OPAS_TELCHECK_RESULT
		<set>
			CREDIT_REFUSE_REASON = #{creditRefuseReason,jdbcType=VARCHAR},
			CRT_USER = #{crtUser,jdbcType=VARCHAR},
			CREDITER = #{crediter,jdbcType=VARCHAR},
			CRT_DATE = CURRENT_TIMESTAMP,
			BLOCK_CODE = #{blockCode,jdbcType=VARCHAR},
			CURR_OPT_GROUP=#{currOptGroup,jdbcType=VARCHAR}
		</set>
		where AUTO_ID = #{autoId,jdbcType=VARCHAR}
	</update>
	<!-- 审批批量拒绝码 -->
	<resultMap id="BizResultMap" type="com.huaxia.opas.domain.thirdparty.BizApproval" >
	    <id column="AUTO_ID" property="autoId" jdbcType="VARCHAR" />
	    <result column="APP_ID" property="appId" jdbcType="VARCHAR" />
	    <result column="ID_TYPE" property="idType" jdbcType="VARCHAR" />
	    <result column="ID_NO" property="idNo" jdbcType="VARCHAR" />
	    <result column="REFUSE_CHILDCARD" property="refuseChildcard" jdbcType="CHAR" />
	    <result column="PRE_APPROVELIMIT" property="preApprovelimit" jdbcType="DECIMAL" />
	    <result column="APPLYER_NAME" property="applyerName" jdbcType="VARCHAR" />
	    <result column="APPLY_CARD" property="applyCard" jdbcType="VARCHAR" />
	    <result column="IS_AGREE_DEGRADE" property="isAgreeDegrade" jdbcType="CHAR" />
	    <result column="SYS_DECISION_TIME" property="sysDecisionTime" jdbcType="TIMESTAMP" />
	    <result column="MASTERCARD_DECRESULT" property="mastercardDecresult" jdbcType="VARCHAR" />
	    <result column="MASTERCARD_APPROVEREUSLT" property="mastercardApprovereuslt" jdbcType="VARCHAR" />
	    <result column="SYS_CREDIT_PRODUCE" property="sysCreditProduce" jdbcType="VARCHAR" />
	    <result column="CHILDCARD_DECRESULT" property="childcardDecresult" jdbcType="VARCHAR" />
	    <result column="CHILDCARD_APPROVEREUSLT" property="childcardApprovereuslt" jdbcType="VARCHAR" />
	    <result column="CREDIT_RESULT" property="creditResult" jdbcType="VARCHAR" />
	    <result column="CREDIT_REFUSE_REASON" property="creditRefuseReason" jdbcType="VARCHAR" />
	    <result column="WARNINGLIST_RESULT" property="warninglistResult" jdbcType="VARCHAR" />
	    <result column="APPROVE_RESULT" property="approveResult" jdbcType="CHAR" />
	    <result column="APPROVE_CREDIT_LIMIT" property="approveCreditLimit" jdbcType="DECIMAL" />
	    <result column="APPROVE_CREDIT_PRODUCT" property="approveCreditProduct" jdbcType="VARCHAR" />
	    <result column="MANUAL_LIMIT" property="manualLimit" jdbcType="DECIMAL" />
	    <result column="POLICY_CODE1" property="policyCode1" jdbcType="VARCHAR" />
	    <result column="POLICY_CODE2" property="policyCode2" jdbcType="VARCHAR" />
	    <result column="POLICY_CODE3" property="policyCode3" jdbcType="VARCHAR" />
	    <result column="VIOLATE_CODE1" property="violateCode1" jdbcType="VARCHAR" />
	    <result column="VIOLATE_CODE2" property="violateCode2" jdbcType="VARCHAR" />
	    <result column="VIOLATE_CODE3" property="violateCode3" jdbcType="VARCHAR" />
	    <result column="MEMO" property="memo" jdbcType="VARCHAR" />
	    <result column="REFUSE_CODE1" property="refuseCode1" jdbcType="VARCHAR" />
	    <result column="REFUSE_CODE2" property="refuseCode2" jdbcType="VARCHAR" />
	    <result column="REFUSE_CODE3" property="refuseCode3" jdbcType="VARCHAR" />
	    <result column="APPROVER" property="approver" jdbcType="VARCHAR" />
	    <result column="APPROVER_NAME" property="approverName" jdbcType="VARCHAR" />
	    <result column="HIGHLEVLE_APPROVER" property="highlevleApprover" jdbcType="VARCHAR" />
	    <result column="HIGHLEVLE_APPROVETIME" property="highlevleApprovetime" jdbcType="TIMESTAMP" />
	    <result column="SUBMIT_HIGHLEVLE_TIME" property="submitHighlevleTime" jdbcType="TIMESTAMP" />
	    <result column="APPROVE_TIME" property="approveTime" jdbcType="TIMESTAMP" />
	    <result column="CURR_OPT_GROUP" property="currOptGroup" jdbcType="CHAR" />
	    <result column="YDJ_FLAG" property="ydjFlag" jdbcType="VARCHAR" />
	    <result column="YEAR_FEE_DERATE_TYPE" property="yearFeeDerateType" jdbcType="VARCHAR" />
	    <result column="CARD_FACE_CODE" property="cardFaceCode" jdbcType="VARCHAR" />
  </resultMap>
	<insert id="insertRefuseCodeBatch" parameterType="java.util.List" >
		insert into OPAS_BIZ_APPROVAL 
		(AUTO_ID,
		APP_ID,
		REFUSE_CODE1,
		REFUSE_CODE2,
		REFUSE_CODE3,
		MEMO,
		APPROVE_RESULT,
		APPROVE_TIME) 
	  	<foreach collection="list" item="item" index="index" separator="union all" > 
	      	(select  
	      		#{item.autoId,jdbcType=VARCHAR},
				#{item.appId,jdbcType=VARCHAR},
				#{item.refuseCode1,jdbcType=VARCHAR},
				#{item.refuseCode2,jdbcType=VARCHAR},
				#{item.refuseCode3,jdbcType=VARCHAR},
				#{item.memo,jdbcType=VARCHAR},
				#{item.approveResult,jdbcType=CHAR},
				CURRENT_TIMESTAMP
			from dual
			)
	    </foreach>
	</insert>
	<select id="selectCountRefuseCode" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(1) from OPAS_BIZ_APPROVAL
			where APP_ID = '${_parameter}'
	</select>
	<select id="selectRefuseCodeList" parameterType="java.util.Map" resultMap="BizResultMap">
		select  AUTO_ID,
		APP_ID,
		REFUSE_CODE1,
		MEMO,
		APPROVE_RESULT,
		APPROVE_TIME from (select AUTO_ID,
		APP_ID,
		REFUSE_CODE1,
		MEMO,
		APPROVE_RESULT,
		APPROVE_TIME
		from OPAS_BIZ_APPROVAL 
		where  APP_ID = #{appId}
		order by APPROVE_TIME desc)
		where rownum = '1'
	</select>
	<insert id="insertRefuseCode" parameterType="java.util.Map" >
		insert into OPAS_BIZ_APPROVAL
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="autoId != null">AUTO_ID,</if>
			<if test="appId != null">APP_ID,</if>
			<if test="refuseCode1 != null">REFUSE_CODE1,</if>
			<if test="memo != null">MEMO,</if>
			<if test="approveResult != null">APPROVE_RESULT,</if>
			APPROVE_TIME
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="autoId != null">#{autoId,jdbcType=VARCHAR},</if>
			<if test="appId != null">#{appId,jdbcType=VARCHAR},</if>
			<if test="refuseCode1 != null">#{refuseCode1,jdbcType=VARCHAR},</if>
			<if test="memo != null">#{memo,jdbcType=VARCHAR},</if>
			<if test="approveResult != null">#{approveResult,jdbcType=CHAR},</if>
			CURRENT_TIMESTAMP
		</trim>
	</insert>
	<update id="updateRefuseCode" parameterType="java.util.Map">
		update OPAS_BIZ_APPROVAL
		<set>
			REFUSE_CODE1 = #{refuseCode1,jdbcType=VARCHAR},
			MEMO = #{memo,jdbcType=VARCHAR},
			APPROVE_RESULT=#{approveResult,jdbcType=CHAR},
			APPROVE_TIME = CURRENT_TIMESTAMP
		</set>
		where AUTO_ID = #{autoId,jdbcType=VARCHAR}
	</update>
	<!-- 当日接收申请件 -->
	<select id="selectTodayApp" parameterType="java.util.Map" resultType="java.lang.Integer">
		select count(1)
		from (
			select distinct substr(allot.app_id,1,15) from 
			OPAS_ALLOT_APPLY_ALLOT allot
			left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	         where rn=1) info on allot.APP_ID=info.APP_ID
		<where>
			  allot.SYN_FLAG='0' 
			  AND allot.DEL_STATUS in ('0','2','3')
			<if test="fraudStr != null and fraudStr !=''  ">
				    ${fraudStr}
			</if> 
			<if test=" stopStr != null and stopStr !=''  ">
				    ${stopStr}
		    </if> 
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE  = #{currQueue}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP  = #{currGroup}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER  = #{currUser}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
				<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE  = #{currNode}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				        ${ydjStr}
		    </if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				and allot.SUBMIT_TYPE is not null
			</if>
			<if test="startDate != null and startDate !='' and nowStr != null and nowStr !=''  ">
				${nowStr}
			</if>
		) 
		</where>
	</select>
	<!-- 特定分配  征信到审批 -->
	<select id="selectApplyBySpecialMen" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		SELECT 
		allot.APP_ID,
		allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
		allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
		allot.CURR_OPT_USER,allot.CURR_USER_NAME,allot.LAST_OPT_USER,
		allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
		allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
		allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
		allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
		allot.BACK_FLAG,allot.LAOJIANFLAG,
		allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
		allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
		allot.ALLOT_VERSION
		FROM OPAS_ALLOT_APPLY_ALLOT  allot
		left join OPAS_BIZ_INP_APPL_C1  ac on  allot.APP_ID=ac.APP_ID
	 	left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
         where rn=1) info on allot.APP_ID=info.APP_ID 
        join opas_telcheck_result m on m.APP_ID=allot.APP_ID
		where  
			   allot.SYN_FLAG='0' 
			   AND allot.DEL_STATUS in ('0','2','3') 
			   AND allot.BATCH_CREDIT_FLAG='0'
			<if test=" stopStr != null and stopStr !=''  ">
				    ${stopStr}
		    </if>
			<if test="ydjStr != null and ydjStr !='' ">
				  ${ydjStr}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size() != 0 ">
				AND allot.CURR_STATUS in
				<foreach item="item" index="index" collection="currStatusList" open="(" separator=","
				close=")">
					#{item}
				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE  = #{currNode}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG  = #{ydjFlag}
			</if>
			 <if test="submitStr != null and submitStr !='' ">
				  and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP  = #{currGroup}
			</if> 
			<if test="currUser != null and currUser !='' ">
				AND m.CREDITER  = #{currUser}
			</if>
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select> 
	<resultMap id="ApplC2ResultMap" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR"/>
		<result column="C2_CNAME" property="c2_cname" jdbcType="VARCHAR"/>
		<result column="C2_CONAME" property="c2_coname" jdbcType="VARCHAR"/>
	</resultMap>
	<select id="selectApplC2" parameterType="java.lang.String" resultMap="ApplC2ResultMap">
		select C2_CNAME,c2_coname from OPAS_BIZ_INP_APPL_C2 
			where APP_ID = '${_parameter}'
	</select>
	<!-- 综合分件查询 -->
	<select id="selectBzkCountByConditions" parameterType="java.util.Map" resultType="java.lang.Integer" >
			select count(1) from 
			(
				select ac.C4_ABUSER,ac.APP_ID,ac.APP_PROD,ac.ALLOT_STATUS from OPAS_BIZ_INP_APPL_C1 ac 
				where exists (
					select allot.APP_ID from OPAS_ALLOT_APPLY_ALLOT allot
					where ac.APP_ID=allot.APP_ID
					AND  allot.SYN_FLAG='0' 
					<if test="delStatusStr == null or delStatusStr =='' ">
						AND allot.DEL_STATUS in ('0','2','3')
					</if>
					<if test="delStatusStr != null and delStatusStr !='' ">
				 		AND allot.DEL_STATUS = #{delStatusStr}
					</if>
					<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
		    			AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
			    	</if>
			    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
			    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
			    	</if>
			    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
			    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
			    	</if>
			    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
			    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
			    	</if>
			    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
			    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
			    	</if>
			    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
			    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
			    	</if>
			    	<if test=" nowStr != null and nowStr !='' ">
						${nowStr}
					</if> 
					<if test="fraudStr != null and fraudStr !=''  ">
				    	${fraudStr}
					</if> 
					<if test="serialNumList != null and serialNumList.size()>0 ">
						AND substr(allot.APP_ID,11,1) in 
						<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="appRegionList != null and appRegionList.size()>0 ">
						AND substr(allot.APP_ID,9,2) in 
							<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
			  					#{item}  
			 				</foreach>
					</if>
					<if test="appChannelList != null and appChannelList.size()>0 ">
						AND substr(allot.APP_ID,8,1) in 
							<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
			  					#{item}  
			 				</foreach>
					</if>
					<if test="inputStr != null and inputStr !='' ">
						${inputStr}
					</if>
					<!-- <if test="appTime != null and appTime !='' ">
						AND substr(allot.APP_ID,1,6) = #{appTime}
					</if> -->
					<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
					    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
				    </if>
					<if test="submitStr != null and submitStr !='' ">
				 		and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
					</if>
					<if test="submitStr == null or submitStr =='' ">
						 and allot.SUBMIT_TYPE is not null
					</if>
					<if test='batchLabel != null and batchLabel !="" '>
						${batchStr}
					</if>
					<if test="currQueue != null and currQueue !='' ">
						AND allot.CURR_OPT_QUEUE = #{currQueue}
					</if>
					<if test="currUser != null and currUser !='' ">
						AND allot.CURR_OPT_USER = #{currUser}
					</if>
					<if test="currGroup != null and currGroup !='' ">
						AND allot.CURR_OPT_GROUP = #{currGroup}
					</if>
					<if test="groupBzk != null and groupBzk !='' ">
				 		AND allot.CURR_OPT_GROUP = #{groupBzk}
					</if>
					<if test="currStatus != null and currStatus !='' ">
						AND allot.CURR_STATUS  = #{currStatus}
					</if>
					<if test="currStatusList != null and currStatusList.size()>0 ">
						AND allot.CURR_STATUS in 
							<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
			  					#{item}  
			 				</foreach>
					</if>
					<if test="currNode != null and currNode !='' ">
						AND allot.CURR_NODE = #{currNode}
					</if>
					<if test="ydjStr != null and ydjStr !='' ">
						${ydjStr}
					</if>
					<if test="ydjFlag != null and ydjFlag !='' ">
						AND allot.YDJ_FLAG = #{ydjFlag}
					</if>
					<if test="appId != null and appId !='' ">
						AND allot.APP_ID  like '${appId}%'
					</if> 
				) 
				<if test="appProdList != null and appProdList.size()>0 ">
					AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="quickStr != null and quickStr !=''  ">
					${quickStr}
				</if>
				<if test='c1CoName != null and c1CoName !="" '>
					AND ac.C1_CONAME LIKE '${c1CoName}%'
				</if>
				<!-- <if test="crtTime != null and crtTime !='' ">
					AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
				</if> -->
				<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
					AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
			    </if>
				<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
					AND ac.C4_APBATCH in 
						<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="c5JcTypeList != null and c5JcTypeList.size()>0 ">
					AND ac.C5_JCTYPE in 
						<foreach item="item" index="index" collection="c5JcTypeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
					AND ac.C5_ABCODE in 
						<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
					AND ac.C4_ABUSER in 
					<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
					AND ac.C4_CYCADD1 = #{c4CyCadd1}
				</if>
				<if test='cardStr != null and cardStr !="" '>
					${cardStr}
				</if>
			) allot
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  allot.C4_ABUSER=promoter.PROMOTER_NO
			</if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_SD_BLAZE sdBlaze on allot.APP_ID=sdBlaze.APP_ID<!-- 标准卡次策略捞回wenyh20200807 -->
            left join OPAS_BZK_SYSRESULT_INFO bzk on allot.APP_ID=bzk.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE
	 	    where fqz_type='AF_ALL')  where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	    </if>
	 	    left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
		    left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		    left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		    left join TRD_OPERATOR_ONLINE ton on allot.APP_ID=ton.app_id
		    left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
	 	    left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	    <!-- 智能语音转人工队列  add intelVoiceToArtQueue by wenyh -->
		    left join CAMS_VOICE_CALL_RECORD znyy on allot.APP_ID=znyy.APP_ID
	 	    where allot.ALLOT_STATUS='0' 
	 	    <if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
	 	    <if test="YsjlStr != null and YsjlStr !='' ">
				AND exists (
				    select 1 from YS_RESULT_INFO rs
				    where rs.APP_ID=allot.APP_ID 
			    	<if test="approveResult != null and approveResult !='' ">
						AND rs.APPROVE_RESULT=#{approveResult}
					</if>
			    	<if test="resultInfoList != null and resultInfoList.size()>0 ">
						AND rs.APPROVE_CODE in 
						<foreach item="item" index="index" collection="resultInfoList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if> 
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>  
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
	 	     <if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1}) and (sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<!-- 智能语音转人工队列  add intelVoiceToArtQueue by wenyh -->
		    <if test="intelVoiceToArtQueue != null and intelVoiceToArtQueue !='' ">
				 AND znyy.FINISH = #{intelVoiceToArtQueue}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if> 
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if> 
			<!-- <if test="wsCode != null and wsCode !='' ">
				AND exists (
				    select 1 from ccard_app_ditch_info h
				    left join OPAS_NET_COOPERATIVE n on h.company_id=n.business_number
				    where h.APP_ID=allot.APP_ID 
			    	<if test="wsCodeList != null and wsCodeList.size()>0 ">
						AND n.business_number in 
						<foreach item="item" index="index" collection="wsCodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  -->
			<if test="wsCodeList != null and wsCodeList.size()>0 ">
				AND onc.business_number in 
					<foreach item="item" index="index" collection="wsCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="decisionResultList != null and decisionResultList.size()>0 ">
				AND sdBlaze.DECISION_RESULT in 
					<foreach item="item" index="index" collection="decisionResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="custFlag != null and custFlag!='' ">
				AND  regexp_like(sdBlaze.rz_lable_code,'('||#{custFlagInfo}||')')
			</if> 
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
				AND sdBlaze.PBOC_RST_FIN_DESP is not null
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
	</select>
	<select id="selectBzkByConditions" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
			select 
			allot.APP_ID,
			allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
			allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
			allot.CURR_OPT_USER,allot.LAST_OPT_USER,
			allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
			allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
			allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
			allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
			allot.BACK_FLAG,allot.LAOJIANFLAG,
			allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
			allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
			allot.ALLOT_VERSION,
			ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME,
			(case when r.CREDITER_NAME is null then '系统' else r.CREDITER_NAME end ) as CREDITER_NAME
			from
			(
			select 
			ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME,ac.C4_ABUSER,ac.APP_ID
			from OPAS_BIZ_INP_APPL_C1 ac
			where exists (
				select allot.APP_ID from OPAS_ALLOT_APPLY_ALLOT allot
				where  ac.APP_ID=allot.APP_ID
				AND  allot.SYN_FLAG='0' 
				<if test="delStatusStr == null or delStatusStr =='' ">
					AND allot.DEL_STATUS in ('0','2','3')
				</if>
				<if test="delStatusStr != null and delStatusStr !='' ">
			 		AND allot.DEL_STATUS = #{delStatusStr}
				</if>
				<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
		    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
		    	</if>
		    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
		    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
		    	</if>
		    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
		    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
		    	</if>
		    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
		    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
		    	</if>
		    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
		    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
		    	</if>
		    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
		    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
		    	</if>
			    <if test=" nowStr != null and nowStr !=''  ">
					${nowStr}
				</if> 
				<if test="fraudStr != null and fraudStr !=''  ">
			    	${fraudStr}
				</if>
				<if test="serialNumList != null and serialNumList.size()>0 ">
					AND substr(allot.APP_ID,11,1) in 
					<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="appRegionList != null and appRegionList.size()>0 ">
					AND substr(allot.APP_ID,9,2) in 
						<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="appChannelList != null and appChannelList.size()>0 ">
					AND substr(allot.APP_ID,8,1) in 
						<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="inputStr != null and inputStr !='' ">
					${inputStr}
				</if>
				<!-- <if test="appTime != null and appTime !='' ">
					AND substr(allot.APP_ID,1,6) = #{appTime}
				</if> -->
				<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
				    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
			    </if>
				<if test="submitStr != null and submitStr !='' ">
				 	and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
				</if>
				<if test="submitStr == null or submitStr =='' ">
					and allot.SUBMIT_TYPE is not null
				</if>
				<if test='batchLabel != null and batchLabel !="" '>
					${batchStr}
				</if>
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE = #{currQueue}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER = #{currUser}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
				</if>
				<if test="groupBzk != null and groupBzk !='' ">
			 		AND allot.CURR_OPT_GROUP = #{groupBzk}
				</if>
				<if test="currStatus != null and currStatus !='' ">
					AND allot.CURR_STATUS  = #{currStatus}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
						<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
				</if>
				<if test="ydjStr != null and ydjStr !='' ">
					${ydjStr}
				</if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="appId != null and appId !='' ">
					AND allot.APP_ID  like '${appId}%'
				</if>
				<if test="jiuCuoFlag == '1'.toString() ">
					AND allot.REVIEW_STATUS is null 
			    </if>
			    <if test="jiuCuoFlag == '2'.toString() ">
				    AND allot.REVIEW_STATUS is not null 
			    </if> 
			) 
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5JcTypeList != null and c5JcTypeList.size()>0 ">
				AND ac.C5_JCTYPE in 
					<foreach item="item" index="index" collection="c5JcTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
					<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if> ) ac
			inner join OPAS_ALLOT_APPLY_ALLOT allot on ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on ac.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on ac.APP_ID=cue.APP_ID
            left join OPAS_FICO_SD_BLAZE sdBlaze on ac.APP_ID=sdBlaze.APP_ID<!-- 标准卡次策略捞回wenyh20200807 -->
            left join OPAS_BZK_SYSRESULT_INFO bzk on ac.APP_ID=bzk.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on ac.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on ac.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on ac.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE
	 	    where fqz_type='AF_ALL')  where rn=1 ) big on ac.APP_ID=big.APP_ID
	 	    </if>
	 	    left join opas_telcheck_result r  on ac.APP_ID=r.APP_ID
	 	   left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		   left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		   left join TRD_OPERATOR_ONLINE ton on ac.APP_ID=ton.app_id
		   left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
		   left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
		   <!-- 智能语音转人工队列  add intelVoiceToArtQueue by wenyh -->
		   left join CAMS_VOICE_CALL_RECORD znyy on allot.APP_ID=znyy.APP_ID
			where 
				allot.SYN_FLAG='0' 
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="YsjlStr != null and YsjlStr !='' ">
				AND exists (
				    select 1 from YS_RESULT_INFO rs
				    where rs.APP_ID=allot.APP_ID 
				   <if test="approveResult != null and approveResult !='' ">
						AND rs.APPROVE_RESULT=#{approveResult}
					</if>
			    	<if test="resultInfoList != null and resultInfoList.size()>0 ">
						AND rs.APPROVE_CODE in 
						<foreach item="item" index="index" collection="resultInfoList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if> 
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
			<if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
   		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1}) and (sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<!-- 智能语音转人工队列  add intelVoiceToArtQueue by wenyh -->
		    <if test="intelVoiceToArtQueue != null and intelVoiceToArtQueue !='' ">
				 AND znyy.FINISH = #{intelVoiceToArtQueue}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if> 
			<!-- <if test="wsCode != null and wsCode !='' ">
				AND exists (
				    select 1 from ccard_app_ditch_info h
				    left join OPAS_NET_COOPERATIVE n on h.company_id=n.business_number
				    where h.APP_ID=allot.APP_ID 
			    	<if test="wsCodeList != null and wsCodeList.size()>0 ">
						AND n.business_number in 
						<foreach item="item" index="index" collection="wsCodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if> -->
			<if test="wsCodeList != null and wsCodeList.size()>0 ">
				AND onc.business_number in 
					<foreach item="item" index="index" collection="wsCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if> 
			<if test="decisionResultList != null and decisionResultList.size()>0 ">
				AND sdBlaze.DECISION_RESULT in 
					<foreach item="item" index="index" collection="decisionResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="custFlag != null and custFlag!='' ">
				AND  regexp_like(sdBlaze.rz_lable_code,'('||#{custFlagInfo}||')')
			</if> 
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
				AND sdBlaze.PBOC_RST_FIN_DESP is not null
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
			 	and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<select id="selectYdjCountByConditions" parameterType="java.util.Map" resultType="java.lang.Integer">
			select  count(1) from OPAS_ALLOT_APPLY_ALLOT allot
 			where 
		    exists (
		    	select *　from (
			select  allot.APP_ID from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID<!-- 易达金次策略捞回wenyh20200807 -->
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	     left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 		left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		   left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		   left join TRD_OPERATOR_ONLINE ton on ac.APP_ID=ton.app_id
		   left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
		   left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
			where 
			      allot.SYN_FLAG='0' 
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="groupYdj != null and groupYdj !='' ">
		 		AND allot.CURR_OPT_GROUP = #{groupYdj}
			</if>
			<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(ydjBlaze.CDT_SCORE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1}) and (ydjBlaze.CDT_SCORE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if> 
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
		    <!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5JcTypeList != null and c5JcTypeList.size()>0 ">
				AND ac.C5_JCTYPE in 
					<foreach item="item" index="index" collection="c5JcTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
		    ) a where substr(allot.APP_ID,1,15)=substr(a.APP_ID,1,15)
		    ) 	
		 	<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
		    <if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
	</select>
	<select id="selectYdjNumByConditions" parameterType="java.util.Map" resultType="java.lang.Integer">
			select count(1) from (
			select  distinct substr(allot.APP_ID,1,15) from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID<!-- 易达金次策略捞回wenyh20200807 -->
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	    left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 		left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		    left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		    left join TRD_OPERATOR_ONLINE ton on ac.APP_ID=ton.app_id
		    left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
			left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
			where 
			      allot.SYN_FLAG='0' 
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if> 
			<if test="groupYdj != null and groupYdj !='' ">
		 		AND allot.CURR_OPT_GROUP = #{groupYdj}
			</if>
			<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(ydjBlaze.CDT_SCORE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1}) and (ydjBlaze.CDT_SCORE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
		    <!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5JcTypeList != null and c5JcTypeList.size()>0 ">
				AND ac.C5_JCTYPE in 
					<foreach item="item" index="index" collection="c5JcTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>   )
	</select>
	<select id="selectYdjByConditions" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
			select  
 			allot.APP_ID,substr(allot.APP_ID,1,15) as appNo,
			allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
			allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
			allot.CURR_OPT_USER,allot.LAST_OPT_USER,
			allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
			allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
			allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
			allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
			allot.BACK_FLAG,allot.LAOJIANFLAG,
			allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
			allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
			allot.ALLOT_VERSION,
			ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME,
			(case when b.CREDITER_NAME is null then '系统' else b.CREDITER_NAME end ) as CREDITER_NAME
			from OPAS_BIZ_INP_APPL_C1 ac,OPAS_ALLOT_APPLY_ALLOT allot
			left join opas_telcheck_result b  on allot.APP_ID=b.APP_ID
		    where 
		     ac.APP_ID=allot.APP_ID
		     AND exists (
		     	select *　from 	(
			select  allot.APP_ID from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID<!-- 易达金次策略捞回wenyh20200807 -->
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	    left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 		left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		   left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		   left join TRD_OPERATOR_ONLINE ton on ac.APP_ID=ton.app_id
		   left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
		   left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
			where 
			      allot.SYN_FLAG='0' 
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="groupYdj != null and groupYdj !='' ">
		 		AND allot.CURR_OPT_GROUP = #{groupYdj}
			</if>
			<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(ydjBlaze.CDT_SCORE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1}) and (ydjBlaze.CDT_SCORE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
		    <!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5JcTypeList != null and c5JcTypeList.size()>0 ">
				AND ac.C5_JCTYPE in 
					<foreach item="item" index="index" collection="c5JcTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
		    ) a where  substr(allot.APP_ID,1,15)=substr(a.APP_ID,1,15)
		     )
		    <if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
		    <if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
		    <if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<select id="selectYdjAppNoByConditions" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
			select  allot.APP_ID,substr(allot.APP_ID,1,15) as appNo,
			allot.YDJ_FLAG
			 from  OPAS_ALLOT_APPLY_ALLOT allot
	 	    inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
	 	    <if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID<!-- 易达金次策略捞回wenyh20200807 -->
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	     left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 	     left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	     left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
		   left join opas_net_cooperative onc on onc.business_logo=cad.ditch and onc.business_number=cad.company_id and onc.module_number = cad.module_id
		   left join TRD_OPERATOR_ONLINE ton on ac.APP_ID=ton.app_id
		   left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
			where 
			      allot.SYN_FLAG='0' 
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="onlineTimeStr =='1'.toString() ">
				AND (ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
 				OR ton.RESULT_DATA is null
				)
			</if>
			<if test="onlineTimeStr =='2'.toString() ">
				AND ton.RESULT_DATA in 
				<foreach item="item" index="index" collection="onlineTimeList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
		    <if test="rcdSrcList != null and rcdSrcList.size()>0 ">
				AND onc.rcd_src in 
					<foreach item="item" index="index" collection="rcdSrcList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platTypeList != null and platTypeList.size()>0 ">
				AND onc.PLAT_TYPE in 
					<foreach item="item" index="index" collection="platTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="coprTypeList != null and coprTypeList.size()>0 ">
				AND onc.copr_Type in 
					<foreach item="item" index="index" collection="coprTypeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
		    <if test="platRiskLvlList != null and platRiskLvlList.size()>0 ">
				AND onc.plat_Risk_Lvl in 
					<foreach item="item" index="index" collection="platRiskLvlList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="ditchStr != null and ditchStr !='' ">
				AND cad.ditch='E'
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="groupYdj != null and groupYdj !='' ">
		 		AND allot.CURR_OPT_GROUP = #{groupYdj}
			</if>
			<if test="fenTime == '1'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '1'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.QUEUE_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '2'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.GROUP_TEAM_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime1 !=null and fenTime1 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &gt;= #{fenTime1}
	    	</if>
	    	<if test="fenTime == '3'.toString() and fenTime2 !=null and fenTime2 !='' ">
	    		AND to_char(allot.USER_DATE,'yyyy-mm-dd hh24:mi') &lt;= #{fenTime2}
	    	</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(ydjBlaze.CDT_SCORE) is null  )
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1}) and (ydjBlaze.CDT_SCORE &lt;= #{triggerType2}) )
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} )
		    </if> 
		    <if test='secondDecisionLH != null and secondDecisionLH !="" '>
				${secondDecisionLHStr}
			</if>
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="blockList != null and blockList.size()>0 ">
				AND r.BLOCK_CODE in 
					<foreach item="item" index="index" collection="blockList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>     
			<if test="creditList != null and creditList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
		    <!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
		    
	</select>
	<select id="selectFraudCountByConditions" parameterType="java.util.Map" resultType="java.lang.Integer">
		select  count(1)
 			from OPAS_ALLOT_APPLY_ALLOT allot
			where
			exists (
				select * from (
			select  allot.APP_ID from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE  cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_SD_BLAZE sdBlaze on allot.APP_ID=sdBlaze.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID
            left join OPAS_BZK_SYSRESULT_INFO bzk on allot.APP_ID=bzk.APP_ID
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on  allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	    left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 	    left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	    left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
	 	    left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
	 	    left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID <!-- 网申平台风险调查-wenyh -->
			where 
			      allot.SYN_FLAG='0' 
			<if test="misszdResult != null and misszdResult !='' ">
				AND wsri.MISSZD_RESULT = '1'
			</if>
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  or ydjBlaze.CDT_SCORE is null)
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} and sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
			   or  (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} and ydjBlaze.CDT_SCORE &lt;= #{triggerType2}))
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2} or ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} or ydjBlaze.CDT_SCORE &gt;=  #{triggerType1})
		    </if> 
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if> 
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND (ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
					OR sdBlaze.PBOC_RST_FIN_DESP is not null)
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				)
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or  bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				)
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
			<!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			) a where substr(allot.APP_ID,1,15)=substr(a.APP_ID,1,15)
			) 
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
		    <if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
	</select>
	<select id="selectFraudNumByConditions" parameterType="java.util.Map" resultType="java.lang.Integer">
			select  count(1) from (
			select distinct substr(allot.APP_ID,1,15) from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE  cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_SD_BLAZE sdBlaze on allot.APP_ID=sdBlaze.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID
            left join OPAS_BZK_SYSRESULT_INFO bzk on allot.APP_ID=bzk.APP_ID
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on  allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	     where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	     </if>
	 	     left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 	     left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	     left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
	 	     left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
	 	     left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID<!-- 网申平台风险调查-wenyh -->
			where 
			      allot.SYN_FLAG='0' 
			<if test="misszdResult != null and misszdResult !='' ">
				AND wsri.MISSZD_RESULT = '1'
			</if>
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  or ydjBlaze.CDT_SCORE is null)
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} and sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
			   or  (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} and ydjBlaze.CDT_SCORE &lt;= #{triggerType2}))
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2} or ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} or ydjBlaze.CDT_SCORE &gt;=  #{triggerType1})
		    </if> 
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND (ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
					OR sdBlaze.PBOC_RST_FIN_DESP is not null)
			</if> 
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				)
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or  bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				)
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
			<!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if> )
	</select>
	<select id="selectFraudByConditions" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
		select  
 			allot.APP_ID,substr(allot.APP_ID,1,15) as appNo,
			allot.CURR_OPT_QUEUE,allot.LAST_OPT_QUEUE,
			allot.CURR_OPT_GROUP,allot.LAST_OPT_GROUP,
			allot.CURR_OPT_USER,allot.LAST_OPT_USER,
			allot.CURR_STATUS,allot.DEL_STATUS,allot.CURR_NODE,
			allot.CRT_TEAM_DATE,allot.LST_TEAM_DATE,
			allot.QUEUE_DATE,allot.GROUP_DATE,allot.USER_DATE,
			allot.YDJ_FLAG,allot.MATCHING_CARD_FLAG,
			allot.BACK_FLAG,allot.LAOJIANFLAG,
			allot.BATCH_OPERATE_FLAG,allot.BATCH_CREDIT_FLAG,allot.BATCH_APPROVAL_FLAG,
			allot.GROUP_TEAM_DATE,allot.FRAUD_DATE,allot.CHECK_MEUOFLAG,allot.ZSHY_INNER_CHECK,
			allot.ALLOT_VERSION,
			ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME
			from 
			(
		    select 
		    ac.C1_CONAME,ac.APP_PROD,ac.C1_CNAME,ac.CRT_TIME,ac.C4_ABUSER,ac.APP_ID
		    from OPAS_BIZ_INP_APPL_C1 ac  where 
		    exists (
				select  allot.APP_ID from  OPAS_ALLOT_APPLY_ALLOT allot	
				left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
				left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0' <!-- 可信身份认证-wenyh -->
	            left join OPAS_PBOC_CREDIT_CUE  cue on allot.APP_ID=cue.APP_ID
	            left join OPAS_FICO_SD_BLAZE sdBlaze on allot.APP_ID=sdBlaze.APP_ID
	            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID
	            left join OPAS_BZK_SYSRESULT_INFO bzk on allot.APP_ID=bzk.APP_ID
	            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
	            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
		 	    where rn=1) info on allot.APP_ID=info.APP_ID
		 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on  allot.APP_ID=t.APP_ID
		 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
		 	    <if test="fqzValue !=null and fqzValue !='' ">
		 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	    	 where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	    	 </if>
	 	     	left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 	     	left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	     	left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
	 	        left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
	 	        left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID<!-- 网申平台风险调查-wenyh -->
				where 
				allot.APP_ID=ac.APP_ID
			    AND allot.SYN_FLAG='0' 
			<if test="misszdResult != null and misszdResult !='' ">
				AND wsri.MISSZD_RESULT = '1'
			</if>
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  or ydjBlaze.CDT_SCORE is null)
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} and sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
			   or  (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} and ydjBlaze.CDT_SCORE &lt;= #{triggerType2}))
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2} or ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} or ydjBlaze.CDT_SCORE &gt;=  #{triggerType1})
		    </if> 
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
				</if>  
				<if test="fqzValueList != null and fqzValueList.size()>0 ">
					AND big.FQZ_VALUE in 
						<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
			    <if test=" nowStr != null and nowStr !=''  ">
					${nowStr}
				</if> 
				<if test="fraudStr != null and fraudStr !=''  ">
			    	${fraudStr}
				</if>
				<if test="phoneList != null and phoneList.size()>0  ">
					AND (l.MAPPING in 
					<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
	 				OR  substr(cad.info_flag,3,1) in 
					<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
	 				OR  substr(jd.info_flag,3,1) in 
					<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach> 
	 				)
				</if>
				<if test="riskScore == '1'.toString() ">
					AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
			    </if>
			    <if test="riskScore == '2'.toString() ">
				   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
			    </if> 
			     <if test="riskScore == '3'.toString() ">
				     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
			    </if> 
			     <if test="riskScore == '4'.toString() ">
				      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
			    </if> 
				<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
					AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
				</if>
				<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
					AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
				</if> 
				<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
					AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
				</if>  
				<if test="proposedLmtStr != null and proposedLmtStr !='' ">
					${proposedLmtStr}
				</if>
				<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
						AND (ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
						OR sdBlaze.PBOC_RST_FIN_DESP is not null)
				</if> 
				<if test="creditResultList != null and creditResultList.size()>0 ">
					AND ( ydj.CREDIT_DECISION_RESULT in 
						<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
		 				or bzk.CREDIT_DECISION_RESULT in 
						<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
	 				)
				</if>
				<if test="creditLayerList != null and creditLayerList.size()>0 ">
					AND ( ydj.CREDIT_DECISION_LAYER in 
						<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
		 				or  bzk.CREDIT_DECISION_LAYER in 
						<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
		 				)
				</if>
				<if test=" pubStr != null and pubStr !=''  ">
					${pubStr}
				</if>
				<if test=" stopStr != null and stopStr !=''  ">
					${stopStr}
				</if>
				<if test="serialNumList != null and serialNumList.size()>0 ">
					AND substr(allot.APP_ID,11,1) in 
					<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="appRegionList != null and appRegionList.size()>0 ">
					AND substr(allot.APP_ID,9,2) in 
						<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="appChannelList != null and appChannelList.size()>0 ">
					AND substr(allot.APP_ID,8,1) in 
						<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="inputStr != null and inputStr !='' ">
					${inputStr}
				</if>
				<!-- <if test="appTime != null and appTime !='' ">
					AND substr(allot.APP_ID,1,6) = #{appTime}
				</if> -->
				<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
				    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
			    </if>
				<if test="currStatus != null and currStatus !='' ">
					AND allot.CURR_STATUS  = #{currStatus}
				</if>
				<if test="currStatusList != null and currStatusList.size()>0 ">
					AND allot.CURR_STATUS in 
						<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="submitStr != null and submitStr !='' ">
					 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
				</if>
				<if test="submitStr == null or submitStr =='' ">
					 and allot.SUBMIT_TYPE is not null
				</if>
				<if test='batchLabel != null and batchLabel !="" '>
					${batchStr}
				</if>
				<if test="currQueue != null and currQueue !='' ">
					AND allot.CURR_OPT_QUEUE = #{currQueue}
				</if>
				<if test="currUser != null and currUser !='' ">
					AND allot.CURR_OPT_USER = #{currUser}
				</if>
				<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
				</if>
				<if test="currNode != null and currNode !='' ">
					AND allot.CURR_NODE = #{currNode}
				</if>
				<if test="ydjStr != null and ydjStr !='' ">
					${ydjStr}
				</if>
				<if test="ydjFlag != null and ydjFlag !='' ">
					AND allot.YDJ_FLAG = #{ydjFlag}
				</if>
				<if test="appId != null and appId !='' ">
					AND allot.APP_ID  like '${appId}%'
				</if> )
				<if test="appProdList != null and appProdList.size()>0 ">
					AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="quickStr != null and quickStr !=''  ">
					${quickStr}
				</if>
				<if test='c1CoName != null and c1CoName !="" '>
					AND ac.C1_CONAME LIKE '${c1CoName}%'
				</if>
				<!-- <if test="crtTime != null and crtTime !='' ">
					AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
				</if> -->
				<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
					AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
			    </if>
				<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
					AND ac.C4_APBATCH in 
						<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
					AND ac.C5_ABCODE in 
						<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
				</if>
				<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
					AND ac.C4_ABUSER in 
					<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
				</if>
				<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
					AND ac.C4_CYCADD1 = #{c4CyCadd1}
				</if>
				<if test='cardStr != null and cardStr !="" '>
					${cardStr}
				</if>			
			) ac
			inner join OPAS_ALLOT_APPLY_ALLOT allot on substr(allot.APP_ID,1,15)=substr(ac.APP_ID,1,15)
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
	 	    where allot.SYN_FLAG='0' 
	 	    <if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
		   	<if test='safeStr != null and safeStr !="" '>
					${safeStr}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test="currGroup != null and currGroup !='' ">
					AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
		    <if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<select id="selectFraudAppNoByConditions" parameterType="java.util.Map" resultMap="AllotApplyResultMap">
			select  
 			 allot.APP_ID,substr(allot.APP_ID,1,15) as appNo,
			allot.YDJ_FLAG
			 from  OPAS_ALLOT_APPLY_ALLOT allot
			inner join OPAS_BIZ_INP_APPL_C1 ac  on  ac.APP_ID=allot.APP_ID
			<if test="safeStr !=null and safeStr !='' ">
			left join (select rn,PROMOTER_NO,CURR_STATUS from (select row_number() over(partition by PROMOTER_NO order by create_time desc) as rn,PROMOTER_NO,CURR_STATUS from OPAS_PROMOTER_RISKLIST) 
             where  rn = 1) promoter on  ac.C4_ABUSER=promoter.PROMOTER_NO
             </if>
            left join POLICE_SIMPLIFY_INFO compare on allot.APP_ID=compare.APP_ID AND compare.card_flag = '0'
            left join SFRZ_BASE_DATA sfrz on allot.app_id=sfrz.app_id AND sfrz.card_flag = '0'<!-- 可信身份认证-wenyh -->
            left join OPAS_PBOC_CREDIT_CUE  cue on allot.APP_ID=cue.APP_ID
            left join OPAS_FICO_SD_BLAZE sdBlaze on allot.APP_ID=sdBlaze.APP_ID
            left join OPAS_FICO_YDJ_BLAZE ydjBlaze on allot.APP_ID=ydjBlaze.APP_ID
            left join OPAS_BZK_SYSRESULT_INFO bzk on allot.APP_ID=bzk.APP_ID
            left join OPAS_YDJ_SYSRESULT_INFO ydj on allot.APP_ID=ydj.APP_ID
            left join (select rn,APP_ID,STOP_FLAG from (select row_number() over (partition by app_id order by crt_date desc) as rn,APP_ID,STOP_FLAG from OPAS_CHECKINGR_RESULTINFO ) 
	 	    where rn=1) info on allot.APP_ID=info.APP_ID
	 	    left join OPAS_TIANYU_ANTIFRAUD_DATA t on  allot.APP_ID=t.APP_ID
	 	    left join TRD_HAR_LD00001 l on allot.APP_ID=l.APP_ID
	 	    <if test="fqzValue !=null and fqzValue !='' ">
	 	    left join (select rn,FQZ_VALUE,app_id from (select row_number() over (partition by app_id order by crt_time desc) as rn,FQZ_VALUE,app_id from OPAS_FQZ_BIG_RESPONSE  where fqz_type='AF_ALL')
	 	   	where rn=1 ) big on allot.APP_ID=big.APP_ID
	 	   	</if>
	 	    left join opas_telcheck_result r  on allot.APP_ID=r.APP_ID
	 	    left join police_xp_info a1 on allot.APP_ID=a1.APP_ID 
	 	    left join ccard_app_ditch_info cad on  allot.APP_ID=cad.app_id and substr(cad.app_id,7,1)='B'
	 	    left join opas_biz_jd_appln jd on allot.APP_ID=jd.APP_ID
	 	    left join OPAS_WS_PLATFORM_RISK_INVEST wsri on allot.APP_ID=wsri.APP_ID<!-- 网申平台风险调查-wenyh -->
			where 
			      allot.SYN_FLAG='0' 
			<if test="misszdResult != null and misszdResult !='' ">
				AND wsri.MISSZD_RESULT = '1'
			</if>
			<if test="delStatusStr == null or delStatusStr =='' ">
				AND allot.DEL_STATUS in ('0','2','3')
			</if>
			<if test="delStatusStr != null and delStatusStr !='' ">
		 		AND allot.DEL_STATUS = #{delStatusStr}
			</if>
			<if test="triggerType == '1'.toString() ">
				AND (to_char(sdBlaze.TRIGGER_TYPE) is null  or ydjBlaze.CDT_SCORE is null)
		    </if>
		    <if test="triggerType == '2'.toString() ">
			   AND ( (sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} and sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2})
			   or  (ydjBlaze.CDT_SCORE &gt;=  #{triggerType1} and ydjBlaze.CDT_SCORE &lt;= #{triggerType2}))
		    </if> 
		     <if test="triggerType == '3'.toString() ">
			     AND ( sdBlaze.TRIGGER_TYPE &lt;= #{triggerType2} or ydjBlaze.CDT_SCORE &lt;= #{triggerType2})
		    </if> 
		     <if test="triggerType == '4'.toString() ">
			      AND ( sdBlaze.TRIGGER_TYPE &gt;=  #{triggerType1} or ydjBlaze.CDT_SCORE &gt;=  #{triggerType1})
		    </if> 
		    <if test="waiBao != null and waiBao !='' ">
				 AND r.CURR_OPT_GROUP = #{waiBao}
			</if>
			<if test="tianyu != null and tianyu !='' ">
				AND exists (
				    select 1 from opas_tianyu_antifraud_riskinfo r
				    where r.APP_ID=allot.APP_ID 
			    	<if test="riskcodeList != null and riskcodeList.size()>0 ">
						AND r.riskcode in 
						<foreach item="item" index="index" collection="riskcodeList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
					<if test="riskValueList != null and riskValueList.size()>0 ">
						AND r.RISKCODEVALUE in 
						<foreach item="item" index="index" collection="riskValueList" open="(" separator="," close=")">  
		  					#{item}  
		 				</foreach>
					</if>
				)
			</if>  
			<if test="fqzValueList != null and fqzValueList.size()>0 ">
				AND big.FQZ_VALUE in 
					<foreach item="item" index="index" collection="fqzValueList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test=" nowStr != null and nowStr !=''  ">
				${nowStr}
			</if> 
			<if test="fraudStr != null and fraudStr !=''  ">
		    	${fraudStr}
			</if>
			<if test="phoneList != null and phoneList.size()>0  ">
				AND (l.MAPPING in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(cad.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				OR  substr(jd.info_flag,3,1) in 
				<foreach item="item" index="index" collection="phoneList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach> 
 				)
			</if>
			<if test="riskScore == '1'.toString() ">
				AND (to_char(t.RISKSCORE) is null or to_char(t.RISKSCORE)='-1' )
		    </if>
		    <if test="riskScore == '2'.toString() ">
			   AND ( (t.RISKSCORE &gt;=  #{minRiskScore}) and (t.RISKSCORE &lt;= #{maxRiskScore}) )
		    </if> 
		     <if test="riskScore == '3'.toString() ">
			     AND ( t.RISKSCORE &lt;= #{maxRiskScore})
		    </if> 
		     <if test="riskScore == '4'.toString() ">
			      AND ( t.RISKSCORE &gt;=  #{minRiskScore} )
		    </if> 
			<if test="minNumberRead != null and minNumberRead !='' and minNumberRead !='-2' ">
				AND isnumber2(trimorre(cue.NUMBER_READ)) &gt;=#{minNumberRead}
			</if>
			<if test="maxNumberRead != null and maxNumberRead !='' and maxNumberRead !='-2' ">
				AND  isnumber2(trimorre(cue.NUMBER_READ)) &lt;=#{maxNumberRead}
			</if> 
			<if test=" minNumberRead =='-2' and maxNumberRead =='-2' ">
				AND (cue.NUMBER_READ is null  or cue.NUMBER_READ='')
			</if>  
			<if test="proposedLmtStr != null and proposedLmtStr !='' ">
				${proposedLmtStr}
			</if>
			<if test="pbocRstFinDesp != null and pbocRstFinDesp !='' ">
					AND (ydjBlaze.CDT_SCORE  IN ('2.01','2.041','2.061','2.071','2.08','2.161','2.80','2.81')
					OR sdBlaze.PBOC_RST_FIN_DESP is not null)
			</if> 
			<if test="policeRxbd =='1'.toString() ">
				AND a1.RESULT_GMSFHM='一致' AND a1.RESULT_XM='一致' AND a1.RESULT_FX='系统判断为同一人'
			</if>
			<if test="policeRxbd =='2'.toString() ">
				AND (a1.RESULT_GMSFHM!='一致' OR a1.RESULT_XM!='一致' OR a1.RESULT_FX!='系统判断为同一人')
			</if>
			<if test="policeRxbd =='3'.toString() ">
				AND (a1.APP_ID is null OR a1.ERROR_MESSAGE is not null)
			</if>
			<if test="creditResultList != null and creditResultList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or bzk.CREDIT_DECISION_RESULT in 
					<foreach item="item" index="index" collection="creditResultList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
 				)
			</if>
			<if test="creditLayerList != null and creditLayerList.size()>0 ">
				AND ( ydj.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				or  bzk.CREDIT_DECISION_LAYER in 
					<foreach item="item" index="index" collection="creditLayerList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
	 				)
			</if>
			<if test="serialNumList != null and serialNumList.size()>0 ">
				AND substr(allot.APP_ID,11,1) in 
				<foreach item="item" index="index" collection="serialNumList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="appRegionList != null and appRegionList.size()>0 ">
				AND substr(allot.APP_ID,9,2) in 
					<foreach item="item" index="index" collection="appRegionList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="appChannelList != null and appChannelList.size()>0 ">
				AND substr(allot.APP_ID,8,1) in 
					<foreach item="item" index="index" collection="appChannelList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="inputStr != null and inputStr !='' ">
				${inputStr}
			</if>
			<!-- <if test="appTime != null and appTime !='' ">
				AND substr(allot.APP_ID,1,6) = #{appTime}
			</if> -->
			<if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			    AND (substr(allot.APP_ID,1,6) &gt;= #{appTimeStart} and substr(allot.APP_ID,1,6) &lt;= #{appTimeEnd})
		    </if>
			<if test="appProdList != null and appProdList.size()>0 ">
				AND ac.APP_PROD in 
					<foreach item="item" index="index" collection="appProdList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="quickStr != null and quickStr !=''  ">
				${quickStr}
			</if>
			<if test='c1CoName != null and c1CoName !="" '>
				AND ac.C1_CONAME LIKE '${c1CoName}%'
			</if>
			<!-- <if test="crtTime != null and crtTime !='' ">
				AND to_char(ac.CRT_TIME,'yyyy-mm-dd')= #{crtTime}
			</if> -->
			<if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
				AND (to_char(ac.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		    </if>
			<if test="c4ApBatchList != null and c4ApBatchList.size()>0 ">
				AND ac.C4_APBATCH in 
					<foreach item="item" index="index" collection="c4ApBatchList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c5AbCodeList != null and c5AbCodeList.size()>0 ">
				AND ac.C5_ABCODE in 
					<foreach item="item" index="index" collection="c5AbCodeList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="c4AbUserList != null and c4AbUserList.size()>0 ">
				AND ac.C4_ABUSER in 
				<foreach item="item" index="index" collection="c4AbUserList" open="(" separator="," close=")">  
  					#{item}  
 				</foreach>
			</if>
			<if test="c4CyCadd1 != null and c4CyCadd1 !='' ">
				AND ac.C4_CYCADD1 = #{c4CyCadd1}
			</if>
			<if test='cardStr != null and cardStr !="" '>
				${cardStr}
			</if>
			<if test='safeStr != null and safeStr !="" '>
				${safeStr}
			</if>
			<if test=" pubStr != null and pubStr !=''  ">
				${pubStr}
			</if>
			<if test=" stopStr != null and stopStr !=''  ">
				${stopStr}
			</if>
			<if test="submitStr != null and submitStr !='' ">
				 and (allot.SUBMIT_TYPE is null and (allot.SUBMIT_STATUS='0' or allot.SUBMIT_STATUS is null))
			</if>
			<if test="submitStr == null or submitStr =='' ">
				 and allot.SUBMIT_TYPE is not null
			</if>
			<if test='batchLabel != null and batchLabel !="" '>
				${batchStr}
			</if>
			<if test="currQueue != null and currQueue !='' ">
				AND allot.CURR_OPT_QUEUE = #{currQueue}
			</if>
			<if test="currUser != null and currUser !='' ">
				AND allot.CURR_OPT_USER = #{currUser}
			</if>
			<if test="currGroup != null and currGroup !='' ">
				AND allot.CURR_OPT_GROUP = #{currGroup}
			</if>
			<if test="currStatus != null and currStatus !='' ">
				AND allot.CURR_STATUS  = #{currStatus}
			</if>
			<if test="currStatusList != null and currStatusList.size()>0 ">
				AND allot.CURR_STATUS in 
					<foreach item="item" index="index" collection="currStatusList" open="(" separator="," close=")">  
	  					#{item}  
	 				</foreach>
			</if>
			<if test="currNode != null and currNode !='' ">
				AND allot.CURR_NODE = #{currNode}
			</if>
			<if test="ydjStr != null and ydjStr !='' ">
				${ydjStr}
			</if>
			<if test="ydjFlag != null and ydjFlag !='' ">
				AND allot.YDJ_FLAG = #{ydjFlag}
			</if>
			<if test="appId != null and appId !='' ">
				AND allot.APP_ID  like '${appId}%'
			</if>
			<if test="checkStr != null and checkStr !='' ">
				order by ${checkStr}
			</if>
			<if test="checkStr == null or checkStr =='' ">
			    order by ac.CRT_TIME asc,allot.APP_ID asc
		    </if>
	</select>
	<update id="updateLstOptTime" parameterType="java.util.Map">
		update OPAS_ALLOT_APPLY_ALLOT
		set LST_TEAM_DATE = sysdate
		where APP_ID like '${appId}%'
	</update>
	<!-- 查询待进入人工列表总记录数-wenyh -->
	<select id="queryWaitingEnterCount" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM OPAS_BIZ_INP_APPL_C1 c1
		 WHERE c1.ydj_flag = #{ydjFlag}
		   AND NOT EXISTS (SELECT * FROM OPAS_ALLOT_APPLY_ALLOT allot WHERE allot.app_id = c1.app_id)
		   AND NOT EXISTS (SELECT * FROM OPAS_FILE_APPLICATION_DETAIL fad WHERE fad.app_id = c1.app_id)
		 <if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
			AND (to_char(c1.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		 </if>
		 <if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			AND (substr(c1.APP_ID,1,6) &gt;= #{appTimeStart} and substr(c1.APP_ID,1,6) &lt;= #{appTimeEnd})
		 </if>
	</select>
	<!-- 查询待进入人工列表数据-wenyh -->
	<select id="queryWaitingEnterList" parameterType="java.util.Map" resultMap="waitingEnterMap">
		SELECT APP_ID, C1_CNAME, C1_IDNBR, C1_CONAME, CRT_TIME, OPERATE_DESC 
		FROM (SELECT c1.APP_ID,
		       c1.C1_CNAME,
		       c1.C1_IDNBR,
		       c1.C1_CONAME,
		       c1.CRT_TIME,
		       c.OPERATE_DESC,
               ROW_NUMBER() over(partition by c1.app_id order by c.CRT_DATE desc) as row_sort
		  FROM OPAS_BIZ_INP_APPL_C1 c1
		  LEFT JOIN OPAS_APPLY_LIFE_CICLE c ON c1.app_id = c.app_id
		 WHERE c1.ydj_flag = #{ydjFlag}
		   AND NOT EXISTS (SELECT *
		          FROM OPAS_ALLOT_APPLY_ALLOT allot
		         WHERE allot.app_id = c1.app_id)
		   AND NOT EXISTS (SELECT *
		          FROM OPAS_FILE_APPLICATION_DETAIL fad
		         WHERE fad.app_id = c1.app_id)
		 <if test="crtTimeStart != null and crtTimeStart !='' and crtTimeEnd != null and crtTimeEnd !='' ">
			AND (to_char(c1.CRT_TIME,'yyyy-mm-dd') BETWEEN #{crtTimeStart} AND #{crtTimeEnd})
		 </if>
		 <if test="appTimeStart != null and appTimeStart !='' and appTimeEnd != null and appTimeEnd !='' ">
			AND (substr(c1.APP_ID,1,6) &gt;= #{appTimeStart} and substr(c1.APP_ID,1,6) &lt;= #{appTimeEnd})
		 </if>
		 ORDER BY substr(c1.APP_ID,1,6) DESC,substr(c1.app_id,7,1) DESC,c1.app_id,c1.CRT_DATE DESC) WHERE row_sort = 1
	</select>
	<resultMap id="waitingEnterMap" type="com.huaxia.opas.domain.allot.WaitingEnter">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="C1_CNAME" property="c1Cname" jdbcType="VARCHAR" />
		<result column="C1_IDNBR" property="c1Idnbr" jdbcType="VARCHAR" />
		<result column="C1_CONAME" property="c1CoName" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="TIMESTAMP" />
		<result column="OPERATE_DESC" property="operateDesc" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 欺诈回收时，批量修改欺诈提报表信息-wenyh-20201019 -->
	<update id="updateBatchSubmitFraud" parameterType="java.util.ArrayList">
		<foreach collection="list" item="item" index="index" open="begin" separator=";" close=";end;">
			update OPAS_SUBMITFRAUD_INFO si
			<set>
               si.VDEL_STATUS = '0'
	        </set>
			where si.APP_ID = #{item.appId} 
		</foreach>
	</update>
	
</mapper>
