<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BANK">
  <resultMap id="resultSummaryInfo" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoScBzk" type="java.util.Map">
		<result column="CELL_PHONE" property="cellphone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr" jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon" jdbcType="VARCHAR" />
		<result column="PAY_COMP1" property="payCompZ" jdbcType="VARCHAR" />
		<result column="PAY_STATUS1" property="payStatusZ" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME1" property="infoUpdTimeZ" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDepositZ" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRateZ" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="PERSONCOMPRATE" property="personCompRate" jdbcType="VARCHAR" />
		<result column="PAY_COMP2" property="payCompY" jdbcType="VARCHAR" />
		<result column="PAY_STATUS2" property="payStatusY" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME2" property="infoUpdTimeY" jdbcType="VARCHAR" />
		<result column="CUR_MPAY_AMT" property="curMpayAmtY" jdbcType="VARCHAR" />
		<result column="PERSON_PAY_BASE" property="personPayBaseY" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoZxSpBzk" type="java.util.Map">
		<result column="PHONE_NUM" property="phone_num1" jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_TYPE" property="queryed_cert_type" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="comp_addr1" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company1" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="info_upd_time1" jdbcType="VARCHAR" />	
		<result column="UNIT_PHONE" property="unit_phone1" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communication_addr" jdbcType="VARCHAR" />
		<result column="FIRST_YW_GRANT_MONTH" property="first_yw_grant_month" jdbcType="VARCHAR" />
		<result column="SINGLE_BANK_MAX_CREDIT" property="single_bank_max_credit" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="pay_comp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="pay_status" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthly_deposit" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="person_deposit_rate" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME_ACC" property="info_upd_time" jdbcType="VARCHAR" />
		
	</resultMap>

	<resultMap id="resultSummaryInfoZxSpBzk2" type="java.util.Map">
		<result column="PHONE_NUM" property="phone_num2" jdbcType="VARCHAR" />
	    <result column="COMP_ADDR" property="comp_addr2" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company2" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="update_req_time2" jdbcType="VARCHAR" />
		<result column="UNIT_PHONE" property="unit_phone2" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultPersonaldk" type="java.util.Map">
		<result column="KL_DATE" property="kl_date" jdbcType="VARCHAR" />
	    <result column="BORROW_MONEY" property="borrow_money" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="serv_type" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="five_classify" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="serv_manage_organ_type" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap id="resultSummaryInfoYdj" type="java.util.Map">
		<result column="PHONE_NUM" property="phone_num1" jdbcType="VARCHAR" />
		<result column="UNIT_PHONE" property="unit_phone1" jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_TYPE" property="queryed_cert_type" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company1" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr1" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime1" jdbcType="VARCHAR" />
		<result column="FIRST_YW_GRANT_MONTH" property="frsCredCrdIssueMon" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME_ACC" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="PERSONCOMPRATE" property="personCompRate" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_ACCT_NUM" property="loanOverDueAcctNum" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_MONTH_NUM" property="loanOverDueMonthNum" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_OVER_DUE_AMT" property="loanOverDueOverDueAmt" jdbcType="VARCHAR" />
		<result column="LOAN_OVERDUE_LONGEST_OVER_DUE" property="loanOverDueLongestOverDue" jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_ACCT_NUM" property="debitCardOverDueAcctNum" jdbcType="VARCHAR" />
		<result column="DEBIT_CARD_OVER_DUE_MONTH_NUM" property="debitCardOverDueMonthNum" jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_OVER_DUE_AMT" property="debitCoDueOverDueAmt" jdbcType="VARCHAR" />
		<result column="DEBIT_CO_DUE_LONGEST_OVER_DUE" property="debitCoDueLongestOverDue" jdbcType="VARCHAR" />
	</resultMap>

	<!-- 查询人行的家庭住址和单位地址用于录入审查比对页面匹配账单地址wangtao -->
	<select id="queryThirtyAddress" resultType="java.util.Map">
		select 	APP_ID,LST_UPD_TIME,RESIDENT_ADDR,COMP_ADDR from (
			select t1.APP_ID,t1.LST_UPD_TIME,t2.RESIDENT_ADDR,t3.COMP_ADDR
			from OPAS_PBOC_PERSONAL_INFO t1
			left join OPAS_PBOC_RESIDENCE_INFO t2 on t1.APP_ID = t2.APP_ID
			left join OPAS_PBOC_PROFESSION_INFO t3 on t3.APP_ID = t3.APP_ID
			where t1.APP_ID = #{appId,jdbcType=VARCHAR} 
			order by t1.LST_UPD_TIME desc
		)
		where rownum = 1
	</select>
	
<!-- 人行摘要信息-标准卡审查 -->
	<select id="querySummaryInfoScBzk" parameterType="java.lang.String"
		resultMap="resultSummaryInfoScBzk">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t1.resi_tel,
               t1.communication_addr,
               TO_CHAR(TO_DATE(t1.query_req_time,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') AS query_req_time,
               t2.company,
               t2.comp_addr,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'),'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp AS pay_comp1,
               (case when pay_status='1' then '缴交'  when pay_status='2' then '封存'  when pay_status='3' then '销户' else '' end)   AS pay_status1,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time1,
               t4.monthly_deposit,
               (case when t4.person_deposit_rate is null then 0 else to_number(t4.person_deposit_rate) end  )+(case when t4.comp_deposit_rate is null then 0 else to_number(t4.comp_deposit_rate) end  ) PERSON_DEPOSIT_RATE,
               t5.pay_comp AS pay_comp2,
               t5.pay_status AS pay_status2,
               TO_CHAR(TO_DATE(t5.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t5.cur_mpay_amt,
               t5.person_pay_base
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join (select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate from 
          (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,pay_comp,pay_status ,info_upd_time,cur_mpay_amt,
          person_pay_base from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc)rn,
          t.APP_ID, t.pay_comp ,t.pay_status,t.info_upd_time,t.cur_mpay_amt,t.person_pay_base from opas_pboc_public_eninsurdep t)
          where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id =  #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc)
          where rownum = 1
	</select>
		<select id="selectListPbocScBzkByAppId" parameterType="java.lang.String"
		resultMap="resultSummaryInfoScBzk">
		select *
  from (SELECT t1.cell_phone,
               t1.c_comp_phone,
               t1.resi_tel,
               t1.communication_addr,
               TO_CHAR(TO_DATE(t1.query_req_time,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM-DD HH24:MI:SS') AS query_req_time,
               t2.company,
               t2.comp_addr,
               t2.INFO_UPD_TIME,
               TO_CHAR(TO_DATE(t3.frs_cred_crd_issue_mon, 'YYYY.MM'),'YYYY-MM') AS frs_cred_crd_issue_mon,
               t4.pay_comp AS pay_comp1,
               t4.pay_status AS pay_status1,
               TO_CHAR(TO_DATE(t4.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time1,
               t4.monthly_deposit,
               t4.person_deposit_rate,
               t4.COMP_DEPOSIT_RATE,
               case when t4.PERSONCOMPRATE is not null then t4.PERSONCOMPRATE else '' end as PERSONCOMPRATE,
               t5.pay_comp AS pay_comp2,
               t5.pay_status AS pay_status2,
               TO_CHAR(TO_DATE(t5.info_upd_time, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS info_upd_time2,
               t5.cur_mpay_amt,
               t5.person_pay_base
          FROM opas_pboc_personal_info t1
          left join opas_pboc_profession_info t2 on t1.app_id = t2.app_id
          left join (select rn,APP_ID,frs_cred_crd_issue_mon from (select row_number() over(partition by APP_ID 
          order by LST_UPD_TIME  desc)rn,t.APP_ID,t.frs_cred_crd_issue_mon from opas_pboc_credit_cue t) 
          where  rn = 1) t3 on t1.app_id = t3.app_id
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate,COMP_DEPOSIT_RATE,
          to_char((to_number(substr(person_deposit_rate,1,length(person_deposit_rate)-1))+to_number(substr(COMP_DEPOSIT_RATE,1,length(COMP_DEPOSIT_RATE)-1)))) as PERSONCOMPRATE
          from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate,t.COMP_DEPOSIT_RATE from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
          left join (select rn,APP_ID,pay_comp,pay_status ,info_upd_time,cur_mpay_amt,
          person_pay_base from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc)rn,
          t.APP_ID, t.pay_comp ,t.pay_status,t.info_upd_time,t.cur_mpay_amt,t.person_pay_base from opas_pboc_public_eninsurdep t)
          where  rn = 1) t5 on t1.app_id = t5.app_id
          where t1.app_id =  #{appId,jdbcType=VARCHAR}
          order by t1.LST_UPD_TIME  desc,t2.INFO_UPD_TIME desc)
          where rownum &lt;=2
	</select>
	
<!-- 人行摘要信息-标准卡征信审批 -->
	<select id="querySummaryInfoZxSpBzk" parameterType="java.lang.String"
		resultMap="resultSummaryInfoZxSpBzk">
		select *
  from (SELECT t2.phone_num,
               t1.queryed_cert_type,              
               t3.comp_addr,              
               t3.company ,           
               t3.info_upd_time,            
               t3.unit_phone,             
               t1.communication_addr,              
               t4.FIRST_YW_GRANT_MONTH,               
               t5.SINGLE_BANK_MAX_CREDIT,               
               t6.PAY_COMP,
               (case when t6.pay_status='1' then '缴交'  when t6.pay_status='2' then '封存'  when t6.pay_status='3' then '销户' else '' end)   AS PAY_STATUS, 
               t6.MONTHLY_DEPOSIT, 
               (case when t6.person_deposit_rate is null then 0 else to_number(t6.person_deposit_rate) end  )+(case when t6.comp_deposit_rate is null then 0 else to_number(t6.comp_deposit_rate) end  ) PERSON_DEPOSIT_RATE,    
               t6.INFO_UPD_TIME INFO_UPD_TIME_ACC                                      
          FROM opas_pboc_personal_info t1
           left join (select rn,APP_ID,phone_num from (select row_number() over(partition by APP_ID 
          order by updated_date  desc)rn,t.APP_ID,t.phone_num from PBOC_PHONE_NUMBER_DETAIL t) 
          where  rn = 1) t2 on t1.app_id=t2.app_id          
          left join (select rn,APP_ID,comp_addr,company,info_upd_time,UNIT_PHONE from (select row_number() over(partition by APP_ID 
          order by  INFO_UPD_TIME  desc)rn,t.APP_ID,t.comp_addr,t.company,t.info_upd_time,t.UNIT_PHONE from opas_pboc_profession_info t) 
          where  rn = 1) t3 on t1.app_id=t3.app_id
           left join (select rn,APP_ID,FIRST_YW_GRANT_MONTH from (select row_number() over(partition by APP_ID 
          order by FIRST_YW_GRANT_MONTH  desc)rn,t.APP_ID,t.FIRST_YW_GRANT_MONTH from PBOC_CREDIT_TRANSACTION_DEL t  where t.service_type='21' ) 
          where  rn = 1) t4 on t1.app_id = t4.app_id 
          left join PBOC_CREDIT_CARD_ACCOSUM t5 on t1.app_id=t5.app_id
            left join (select rn,APP_ID,PAY_COMP,PAY_STATUS,MONTHLY_DEPOSIT,PERSON_DEPOSIT_RATE,comp_deposit_rate,INFO_UPD_TIME from (select row_number() over(partition by APP_ID 
          order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn,t.APP_ID,PAY_COMP,PAY_STATUS,MONTHLY_DEPOSIT,PERSON_DEPOSIT_RATE,comp_deposit_rate,INFO_UPD_TIME from OPAS_PBOC_PUBLIC_ACCFUND t) where  rn = 1) t6
          on t1.app_id=t6.app_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and t1.queryed_cert_type = '10'
          order by t1.LST_UPD_TIME  desc,t3.INFO_UPD_TIME desc)
          where rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批-工作单位、单位地址、更新时间第二条数据 -->
	<select id="querySummaryInfoZxSpBzk2" parameterType="java.lang.String"
		resultMap="resultSummaryInfoZxSpBzk2">
		select *
  from (SELECT t2.phone_num, 
               t3.comp_addr, 
               t3.company,  
               t3.info_upd_time, 
               t3.unit_phone
          FROM opas_pboc_personal_info t1
           left join (select rn,APP_ID,phone_num from (select row_number() over(partition by APP_ID 
          order by updated_date  desc)rn,t.APP_ID,t.phone_num from PBOC_PHONE_NUMBER_DETAIL t) 
          where  app_id = #{appId,jdbcType=VARCHAR} and rn = 2) t2 on t1.app_id=t2.app_id 
          left join (select rn,APP_ID,comp_addr,company,info_upd_time,UNIT_PHONE from (select row_number() over(partition by APP_ID 
          order by  INFO_UPD_TIME  desc)rn,t.APP_ID,t.comp_addr,t.company,t.info_upd_time,t.UNIT_PHONE from opas_pboc_profession_info t) 
          where  app_id = #{appId,jdbcType=VARCHAR} and rn=  2) t3 on t1.app_id=t3.app_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and t1.queryed_cert_type = '10'
         order by t1.LST_UPD_TIME  desc,t3.INFO_UPD_TIME desc
                  )
 where rownum &lt;= 2
	</select>

<!-- 人行摘要信息-标准卡征信审批-工作单位、单位地址、更新时间第二条数据 -->
	<select id="queryPersonaldk" parameterType="java.lang.String"
		resultMap="resultPersonaldk">
		 select a.kl_date,a.borrow_money,a.serv_type,b.five_classify,a.SERV_MANAGE_ORGAN_TYPE,b.account_status
  from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b
   on A.RELATE_ID=B.RELATE_ID where  a.serv_type in ('11','12','13','21','41')
         and a.app_id = #{appId,jdbcType=VARCHAR}
	</select>
	
<!-- 人行摘要信息-标准卡征信审批/易达金-欠税记录信息 -->
	<select id="querySummaryInfoErr1" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_TAXARREAR
 where  app_id = #{appId,jdbcType=VARCHAR} and 
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-民事判决记录信息 -->
	<select id="querySummaryInfoErr2" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_CIVJUDGE
 where  app_id = #{appId,jdbcType=VARCHAR} and 
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-强制执行记录信息 -->
	<select id="querySummaryInfoErr3" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_FORCEEXE
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-养老保险金缴存记录信息 -->
	<select id="querySummaryInfoErr4" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ENINSURDEP
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-养老保险金发放记录信息 -->
	<select id="querySummaryInfoErr5" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ENINSURDEL
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-行政处罚记录信息 -->
	<select id="querySummaryInfoErr6" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from OPAS_PBOC_PUBLIC_ADMINPUNISH
 where app_id = #{appId,jdbcType=VARCHAR} and
       rownum = 1
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-贷款当前逾期总额 -->
	<select id="querySummaryInfoAmt1" parameterType="java.lang.String"
		resultType="java.lang.String">
		select to_char(sum(b.CUR_OVERDUE_TOTAL)) OVERDUE_TOTAL
  from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEAREST_M b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE in ( 'R1','R4','D1') and a.app_id = #{appId,jdbcType=VARCHAR} 
	</select>

<!-- 人行摘要信息-标准卡征信审批/易达金-信用卡当前逾期总额 -->
	<select id="querySummaryInfoAmt2" parameterType="java.lang.String"
		resultType="java.lang.String">
		select to_char(sum(b.CUR_OVERDUE_TOTAL)) OVERDUE_TOTAL
  from PBOC_DEBIT_CREDIT_BASIC_INFO A left join PBOC_DEBIT_CREDIT_NEAREST_M b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE ='R2'  AND a.app_id = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultLostTrustMap" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="CASE_STATUS" property="caseStatus" jdbcType="VARCHAR" />
	</resultMap>
<!-- 人行摘要信息-标准卡征信审批/易达金-是否列入失信被执行人名单 -->
	<select id="querySummaryInfoCase" parameterType="java.lang.String" resultMap="resultLostTrustMap">
		select APP_ID ,CASE_STATUS from OPAS_PBOC_PUBLIC_FORCEEXE where APP_ID = #{appId,jdbcType=VARCHAR} 
	</select>
	
<!-- 人行摘要信息-标准卡征信审批/易达金-信用卡状态异常 -->
	<select id="querySummaryInfoCredit" parameterType="java.lang.String"
		resultType="java.lang.String">
        select distinct  case when  B.ACCOUNT_STATUS='2' then '冻结' when  B.ACCOUNT_STATUS='3' then '止付' 
        when  B.ACCOUNT_STATUS='31' then '银行止付'  when  B.ACCOUNT_STATUS='5' then '呆账' when  B.ACCOUNT_STATUS='8' then '司法追偿' else null end 
  from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEAREST_M b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE='R2'
   and B.ACCOUNT_STATUS in ('2','3','5','8','31')
    and a.app_id = #{appId,jdbcType=VARCHAR} 
    union all
    select distinct  case when  B.ACCOUNT_STATUS='2' then '冻结' when  B.ACCOUNT_STATUS='3' then '止付' 
        when  B.ACCOUNT_STATUS='31' then '银行止付'  when  B.ACCOUNT_STATUS='5' then '呆账' when  B.ACCOUNT_STATUS='8' then '司法追偿' else null end 
  from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE='R2'
   and B.ACCOUNT_STATUS in ('2','3','5','8','31')
    and a.app_id = #{appId,jdbcType=VARCHAR} 
	</select>

<!-- 人行摘要信息-易达金 -->
	<select id="querySummaryInfoYdj" parameterType="java.lang.String"
		resultMap="resultSummaryInfoYdj">
		select *
  from (SELECT t7.phone_num, 
               t2.unit_phone, 
               t2.company,
               t2.comp_addr,
               t2.info_upd_time,
               t3.FIRST_YW_GRANT_MONTH,
               t4.pay_comp,
               (case when t4.pay_status='1' then '缴交'  when t4.pay_status='2' then '封存'  when t4.pay_status='3' then '销户' else '' end) pay_status,
               t4.info_upd_time AS INFO_UPD_TIME_ACC,
               t4.monthly_deposit,
               (case when t4.person_deposit_rate is null then 0 else to_number(t4.person_deposit_rate) end  )+(case when t4.comp_deposit_rate is null then 0 else to_number(t4.comp_deposit_rate) end  ) PERSON_DEPOSIT_RATE,
               t1.queryed_cert_type,
               t5.loan_overdue_acct_num,
               t5.loan_overdue_month_num,
               t5.loan_overdue_over_due_amt,
               t5.loan_overdue_longest_over_due,
               t6.debit_card_over_due_acct_num,
               t6.debit_card_over_due_month_num,
               t6.debit_co_due_over_due_amt,
               t6.debit_co_due_longest_over_due
          FROM opas_pboc_personal_info t1
          left join (select rn,APP_ID,phone_num from (select row_number() over(partition by APP_ID                                                                       
          order by updated_date  desc)rn,t.APP_ID,t.phone_num from PBOC_PHONE_NUMBER_DETAIL t)                                                                            
          where  rn = 1) t7 on t1.app_id=t7.app_id 
         	left join (select rn,APP_ID,comp_addr,company,info_upd_time,UNIT_PHONE from (select row_number() over(partition by APP_ID 
		order by  INFO_UPD_TIME  desc)rn,t.APP_ID,t.comp_addr,t.company,t.info_upd_time,t.UNIT_PHONE from opas_pboc_profession_info t) 
		where  rn = 1) t2 on t1.app_id = t2.app_id
           left join (select rn,APP_ID,FIRST_YW_GRANT_MONTH from (select row_number() over(partition by APP_ID 
          order by FIRST_YW_GRANT_MONTH  desc)rn,t.APP_ID,t.FIRST_YW_GRANT_MONTH from PBOC_CREDIT_TRANSACTION_DEL t  where t.service_type='21' ) 
          where  rn = 1) t3 on t1.app_id = t3.app_id 
          left join (select rn,APP_ID,pay_status,pay_comp ,info_upd_time,monthly_deposit,person_deposit_rate,COMP_DEPOSIT_RATE,
          to_char((to_number(substr(person_deposit_rate,1,length(person_deposit_rate)-1))+to_number(substr(COMP_DEPOSIT_RATE,1,length(COMP_DEPOSIT_RATE)-1)))) as PERSONCOMPRATE
          from (select row_number() over(partition by APP_ID order by INFO_UPD_TIME  desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc)rn, t.APP_ID,t.pay_status,pay_comp ,t.info_upd_time,
          t.monthly_deposit,t.person_deposit_rate,t.COMP_DEPOSIT_RATE from opas_pboc_public_accfund t)
          where  rn = 1) t4 on t1.app_id = t4.app_id
           left join (select app_id,sum(account_count) loan_overdue_acct_num,max(month_count) loan_overdue_month_num,
         max(singlem_max_overdue_sum) loan_overdue_over_due_amt,max(max_overdue_month_count) loan_overdue_longest_over_due from 
         PBOC_OVERDUE_DRAFT_SUM_DEL where ACCOUNT_TYPE IN ('1','2','3') group by app_id ) t5 on t1.app_id=t5.app_id
         left join (select app_id,account_count  debit_card_over_due_acct_num,month_count debit_card_over_due_month_num,
         singlem_max_overdue_sum debit_co_due_over_due_amt,max_overdue_month_count debit_co_due_longest_over_due from 
         PBOC_OVERDUE_DRAFT_SUM_DEL where ACCOUNT_TYPE IN ('4') ) t6 on t1.app_id=t6.app_id
          where t1.app_id = #{appId,jdbcType=VARCHAR} and t1.queryed_cert_type = '10'
          order by t1.LST_UPD_TIME  desc,
                  t2.INFO_UPD_TIME desc)
 where rownum = 1
	</select>
<!-- 人行摘要信息-易达金-贷款异常情况 -->
	<select id="querySummaryInfoRecSeq" parameterType="java.lang.String"
		resultType="java.lang.String">
          select distinct  case when  B.ACCOUNT_STATUS='2' then '逾期' when  B.ACCOUNT_STATUS='4' then '呆账' 
        when  B.ACCOUNT_STATUS='6' then '担保物不足'  when  (B.ACCOUNT_STATUS='5' and A.ACCOUNT_TYPE='R1') then '银行止付' 
        when  B.ACCOUNT_STATUS='8' then '司法追偿' else null end 
        from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEAREST_M b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE in ('D1','R1','R4')
   and B.ACCOUNT_STATUS in ('2','4','5','6','8')
    and a.app_id = #{appId,jdbcType=VARCHAR} 
    union all
     select distinct  case when  B.ACCOUNT_STATUS='2' then '逾期' when  B.ACCOUNT_STATUS='4' then '呆账' 
        when  B.ACCOUNT_STATUS='6' then '担保物不足'  when  (B.ACCOUNT_STATUS='5' and A.ACCOUNT_TYPE='R1') then '银行止付' 
        when  B.ACCOUNT_STATUS='8' then '司法追偿' else null end 
        from PBOC_DEBIT_CREDIT_BASIC_INFO a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b
   on A.RELATE_ID=B.RELATE_ID where A.ACCOUNT_TYPE in ('D1','R1','R4')
   and B.ACCOUNT_STATUS in ('2','4','5','6','8')
    and a.app_id = #{appId,jdbcType=VARCHAR} 
	</select>
	
<!-- 人行摘要信息-易达金-担保信息异常情况 -->
	<select id="querySummaryInfoLoanSort5" parameterType="java.lang.String"
		resultType="java.lang.String">
		select APP_ID
  from PBOC_RELATE_REPAY_DUTY_INFO
 where APP_ID = #{appId,jdbcType=VARCHAR} and (five_classify in ('2','3','4','5')) and  rownum=1
   <!-- (GUAR_LOAN_SORT5 LIKE '%关注%' or
       GUAR_LOAN_SORT5 LIKE '%次级%' or
       GUAR_LOAN_SORT5 LIKE '%可疑%' or
       GUAR_LOAN_SORT5 LIKE '%损失%') -->
	</select>
	
<!-- 人行摘要信息-易达金-到期未结清贷款笔数 -->
	<select id="querySummaryInfoExpireLoansNum" parameterType="java.lang.String"
		resultType="java.lang.String">
		select count(*)
  from (SELECT t1.DUE_DATE,
               t2.REPORT_TIME
          FROM PBOC_DEBIT_CREDIT_BASIC_INFO  t1
          left join OPAS_PBOC_PERSONAL_INFO t2 on t1.app_id = t2.app_id
           left join PBOC_DEBIT_CREDIT_NEWST_SHOW t3 on t1.relate_id=t3.relate_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and
          to_char(isdate2(t1.DUE_DATE),'yyyy-mm-dd') &lt;=  to_char(isdate2(t2.REPORT_TIME),'yyyy-mm-dd') and 
              t1.account_type in ('D1','R1','R4')  and
              t3.BALANCE  > 0)
	</select>
	
<!-- 人行摘要信息-易达金-即将到期贷款笔数 -->
	<select id="querySummaryInfoAboutExpireLoansNum" parameterType="java.lang.String"
		resultType="java.lang.String">
		select count(*)
  from (SELECT t1.DUE_DATE,
               t2.REPORT_TIME
          FROM PBOC_DEBIT_CREDIT_BASIC_INFO  t1
          left join OPAS_PBOC_PERSONAL_INFO t2 on t1.app_id = t2.app_id
          left join PBOC_DEBIT_CREDIT_NEWST_SHOW t3 on t1.relate_id=t3.relate_id
         where t1.app_id = #{appId,jdbcType=VARCHAR} and
          to_char(isdate2(t1.DUE_DATE),'yyyy-mm-dd') >  to_char(isdate2(t2.REPORT_TIME),'yyyy-mm-dd') and
              (isdate2(t2.REPORT_TIME))  &gt;=   (isdate2(t1.DUE_DATE)-15) and
              t1.account_type = 'R2'  and
               t3.BALANCE   > 0)

	</select>
	
	<!-- 人行摘要信息 -->
	<select id="queryPbocInfo" parameterType="java.lang.String"
		resultMap="resultSummaryInfo">
		<!-- select a.cell_phone,a.c_comp_phone,a.resi_tel,b.company,b.comp_addr,c.resident_addr
		  from OPAS_PBOC_PERSONAL_INFO   a,
		       OPAS_PBOC_PROFESSION_INFO b,
		       OPAS_PBOC_RESIDENCE_INFO  c
		 where a.app_id = b.app_id
		   and a.app_id = c.app_id -->
		 select a.cell_phone,a.c_comp_phone,a.resi_tel,d.company,d.comp_addr,e.resident_addr
		 from OPAS_PBOC_PERSONAL_INFO  a,
         (select max(b.APP_ID) as APP_ID, max(b.company) as COMPANY,max(b.comp_addr)as COMP_ADDR , 
		  max(b.lst_upd_time)from OPAS_PBOC_PROFESSION_INFO  b group by b.app_id) d 
         ,( select max(c.APP_ID) as APP_ID, max(c.resident_addr) as RESIDENT_ADDR ,	
         max(c.lst_upd_time) from OPAS_PBOC_RESIDENCE_INFO c group by c.app_id ) e  
         where a.app_id = d.app_id
		 AND a.app_id = e.app_id
		 AND a.app_id = #{appId,jdbcType=VARCHAR}
	</select>	
	
	<!-- 二代人行摘要信息 -->
	<select id="queryBankInfo" parameterType="java.lang.String"
		resultMap="resultSummaryInfo">
		SELECT t2.phone_num AS phone_num1, <!-- 手机号1 -->
		t1.queryed_cert_type AS queryed_cert_type,
		t6.phone_num AS phone_num2, <!-- 手机号2 -->
		t5.home_phone, <!-- 住宅地址 -->
		t3.comp_addr AS comp_addr1 , <!-- 单位地址1 -->
		t4.comp_addr AS comp_addr2 , <!-- 单位地址2 -->
		t3.company AS company1,   <!-- 单位名称1 -->
		t4.company AS company2,   <!-- 单位名称2 -->
		t3.unit_phone AS unit_phone1, <!-- 单位电话1 -->
		t4.unit_phone AS unit_phone2 <!-- 单位电话2 -->  
		FROM opas_pboc_personal_info t1
		left join (select rn,APP_ID,phone_num from (select row_number() over(partition by APP_ID 
		order by updated_date  desc)rn,t.APP_ID,t.phone_num from PBOC_PHONE_NUMBER_DETAIL t) 
		where  rn = 1) t2 on t1.app_id=t2.app_id <!-- 手机号1 -->
		left join (select rn,APP_ID,phone_num from (select row_number() over(partition by APP_ID 
		order by updated_date  desc)rn,t.APP_ID,t.phone_num from PBOC_PHONE_NUMBER_DETAIL t) 
		where  rn = 2) t6 on t1.app_id=t6.app_id <!-- 手机号2 -->
		left join (select rn,APP_ID,home_phone from (select row_number() over(partition by APP_ID 
		order by lst_upd_time  desc)rn,t.APP_ID,t.home_phone from OPAS_PBOC_RESIDENCE_INFO t) 
		where  rn = 1) t5 on t1.app_id=t5.app_id <!-- 住宅电话 -->
		left join (select rn,APP_ID,comp_addr,company,info_upd_time,UNIT_PHONE from (select row_number() over(partition by APP_ID 
		order by  INFO_UPD_TIME  desc)rn,t.APP_ID,t.comp_addr,t.company,t.info_upd_time,t.UNIT_PHONE from opas_pboc_profession_info t) 
		where  rn = 1) t3 on t1.app_id=t3.app_id <!-- 单位地址1 -->
		left join (select rn,APP_ID,comp_addr,company,info_upd_time,UNIT_PHONE from (select row_number() over(partition by APP_ID 
		order by  INFO_UPD_TIME  desc)rn,t.APP_ID,t.comp_addr,t.company,t.info_upd_time,t.UNIT_PHONE from opas_pboc_profession_info t) 
		where  rn = 2) t4 on t1.app_id=t4.app_id <!-- 单位地址2 -->
		where t1.app_id= #{appId,jdbcType=VARCHAR}
	</select>
    
	<resultMap id="resultBsaeInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="VARCHAR" />
		<result column="REPORT_NO" property="reportNo" jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="REPORT_TIME" property="reportTime" jdbcType="VARCHAR" />
		<result column="PRODUCT_TYPE" property="productType" jdbcType="VARCHAR" />
		<result column="PRODUCT_FORMAT" property="productFormat"
			jdbcType="VARCHAR" />
		<result column="PRODUCT_VERSION" property="productVersion"
			jdbcType="VARCHAR" />
		<result column="QUERYED_NAME" property="queryedName" jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_TYPE" property="queryedCertType"
			jdbcType="VARCHAR" />
		<result column="QUERYED_CERT_NO" property="queryedCertNo"
			jdbcType="VARCHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="QUERY_ORG" property="queryOrg" jdbcType="VARCHAR" />
		<result column="QRY_OPERATOR" property="qryOperator" jdbcType="VARCHAR" />
		<result column="QUERY_RESULT_PROMPT" property="queryResultPrompt"
			jdbcType="VARCHAR" />
		<result column="GENDER" property="gender" jdbcType="VARCHAR" />
		<result column="BIRTH_DAY" property="birthDay" jdbcType="VARCHAR" />
		<result column="MARITAL_STATUS" property="maritalStatus"
			jdbcType="VARCHAR" />
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="RESIDENCY_STATUS" property="residencyStatus"
			jdbcType="VARCHAR" />
		<result column="DEGREE" property="degree" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="DOMICILE_ADDR" property="domicileAddr"
			jdbcType="VARCHAR" />
		<result column="MATE_NAME" property="mateName" jdbcType="VARCHAR" />
		<result column="MATE_CERT_TYPE" property="mateCertType"
			jdbcType="VARCHAR" />
		<result column="MATE_CERT_NO" property="mateCertNo" jdbcType="VARCHAR" />
		<result column="MATE_COMPANY" property="mateCompany" jdbcType="VARCHAR" />
		<result column="MATE_CONTACT_TEL" property="mateContactTel"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="VARCHAR" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="VARCHAR" />
		<result column="REC_STATUS" property="recStatus" jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="WORK_STATUS" property="workStatus" jdbcType="VARCHAR" />
		<result column="NATIONALITY" property="nationality" jdbcType="VARCHAR" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 个人基本信息查询 -->
	<select id="queryBsaeInfo" parameterType="java.lang.String"
		resultMap="resultBsaeInfo">

		 SELECT
		 REPORT_NO, 
		 QUERY_REQ_TIME, 
		 REPORT_TIME,
		 PRODUCT_TYPE,
		 PRODUCT_FORMAT,
		 PRODUCT_VERSION,
		 QUERYED_NAME,
		 QUERYED_CERT_TYPE,
		 QUERYED_CERT_NO,
		 QRY_REASON, 
		 QUERY_ORG,
		 QRY_OPERATOR, 
		 QUERY_RESULT_PROMPT, 
		 GENDER,
		 BIRTH_DAY,
		 MARITAL_STATUS,
		decode(lengthb(CELL_PHONE),12,substr(CELL_PHONE,2,11),CELL_PHONE)	as 	CELL_PHONE,
		C_COMP_PHONE, RESI_TEL,
		 RESIDENCY_STATUS, 
		 DEGREE,
		COMMUNICATION_ADDR,
		DOMICILE_ADDR,
		MATE_NAME, 
		MATE_CERT_TYPE,
		MATE_CERT_NO, MATE_COMPANY, MATE_CONTACT_TEL,APP_ID,
		WORK_STATUS,
		NATIONALITY,
		EMAIL
		FROM
		OPAS_PBOC_PERSONAL_INFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}

	</select>
	<resultMap id="resultOtherBaseInfo" type="java.util.Map">
		<result column="IDENTITY_TYPE" property="identityType" jdbcType="VARCHAR" />
		<result column="IDENTITY_NUM" property="identityNum"
			jdbcType="VARCHAR" />
	</resultMap>
	<!-- 其他身份信息查询 -->
	<select id="queryOtherBaseInfo" parameterType="java.lang.String"
		resultMap="resultOtherBaseInfo">
        SELECT  decode(IDENTITY_TYPE,'01','户口簿','02','护照','05','港澳居民来往内地通行证','06','台湾同胞来往内地通行证','08','外国人居留证','09','警官证','A','香港身份证','B','澳门身份证','C','台湾身份证','X','其他证件','10','身份证','20','军人身份证件') IDENTITY_TYPE,
        IDENTITY_NUM   FROM PBOC_IDENTITY_DATA
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}

	</select>
	<resultMap id="resultAntiFraudInfo" type="java.util.Map">
		<result column="MARK" property="mark" jdbcType="VARCHAR" />
		<result column="PHONE" property="phone" jdbcType="VARCHAR" />
		<result column="EFFECTIVE_DATE" property="effectiveDate" jdbcType="VARCHAR" />
		<result column="DEADLINE" property="deadLine" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 防欺诈警示  -->
	<select id="queryAntiFraudInfo" parameterType="java.lang.String"
		resultMap="resultAntiFraudInfo">
        SELECT MARK,PHONE,EFFECTIVE_DATE,DEADLINE   FROM PBOC_CHEAT_PROOF_CAUTION 
        WHERE (EFFECTIVE_DATE is not null or DEADLINE is not null)
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultDissentHintInfo" type="java.util.Map">
		<result column="DISSENT_COUNT" property="dissentCount" jdbcType="VARCHAR" />
	</resultMap>
	<!-- 异议信息提示 -->
	<select id="queryDissentHintInfo" parameterType="java.lang.String"
		resultMap="resultDissentHintInfo">
        SELECT DISSENT_COUNT   FROM PBOC_DISSENT_HINT 
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultPhoneNum" type="java.util.Map">
		<result column="PHONE_NUM" property="phoneNum" jdbcType="VARCHAR" />
		<result column="UPDATED_DATE" property="updateDate"
			jdbcType="VARCHAR" />
	</resultMap>
	<!-- 个人手机号码查询 -->
	<select id="queryPhoneNum" parameterType="java.lang.String"
		resultMap="resultPhoneNum">
		SELECT
		PHONE_NUM,
		UPDATED_DATE
		FROM
		PBOC_PHONE_NUMBER_DETAIL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR} ORDER BY UPDATED_DATE DESC

	</select>

	<resultMap id="queryResideInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr"
			jdbcType="VARCHAR" />
		<result column="RESIDE_STATE" property="resideState" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="VARCHAR" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="VARCHAR" />
		<result column="REC_STATUS" property="recStatus" jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="HOME_PHONE" property="homephone" jdbcType="VARCHAR" />
	</resultMap>

	<select id="selectResideInfo" parameterType="java.lang.String"
		resultMap="queryResideInfo">
		SELECT RESIDENT_ADDR, RESIDE_STATE,INFO_UPD_TIME,HOME_PHONE 
		FROM OPAS_PBOC_RESIDENCE_INFO
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
		ORDER BY INFO_UPD_TIME desc
	</select>


	<resultMap id="resultProessionInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="JOB" property="job" jdbcType="VARCHAR" />
		<result column="INDUSTRY_TYPE" property="industryType"
			jdbcType="VARCHAR" />
		<result column="OCCUPATION_CODE" property="occupationCode"
			jdbcType="VARCHAR" />
		<result column="TECHNICAL_TITLE" property="technicalTitle"
			jdbcType="VARCHAR" />
		<result column="CUR_COMP_WORK_STAT_Y" property="curCompWorkStatY"
			jdbcType="CHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
		<result column="UNIT_CHARACTER" property="unitcharacter" jdbcType="VARCHAR" />
		<result column="UNIT_PHONE" property="unitphone" jdbcType="VARCHAR" />
		
	</resultMap>
<!-- 职业信息 -->
	<select id="queryProessionInfo" parameterType="java.lang.String"
		resultMap="resultProessionInfo">
		SELECT COMPANY,COMP_ADDR,JOB,INDUSTRY_TYPE,OCCUPATION_CODE,TECHNICAL_TITLE,CUR_COMP_WORK_STAT_Y,INFO_UPD_TIME,UNIT_CHARACTER,UNIT_PHONE
		FROM OPAS_PBOC_PROFESSION_INFO
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
		ORDER BY  INFO_UPD_TIME DESC
	</select>
	


	<resultMap id="resultMessageInfo" type="java.util.Map">
		<result column="SERVICE_TYPE" property="serviceType" jdbcType="VARCHAR" />
		<result column="SERVICE_DL" property="serviceDl" jdbcType="VARCHAR" />
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="FIRST_YW_GRANT_MONTH" property="firstYwGrantMonth" jdbcType="VARCHAR" />
		<result column="COUNT" property="count" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryMessageInfo" parameterType="java.lang.String"
		resultMap="resultMessageInfo">
		SELECT DECODE(A.SERVICE_TYPE,'11','个人住房贷款','12','个人商用房（包括商住两用房）贷款','19','其他类贷款','21','贷记卡','22','准贷记卡','99','其他',null,'--') SERVICE_TYPE,
    	DECODE(A.SERVICE_DL,'1','贷款','2','信用卡','9','其他')SERVICE_DL,A.ACCOUNT_COUNT,A.FIRST_YW_GRANT_MONTH,(select count(SERVICE_DL) from PBOC_CREDIT_TRANSACTION_DEL t where t.app_id=A.APP_ID and t.service_dl=A.Service_Dl ) COUNT  FROM PBOC_CREDIT_TRANSACTION_DEL A WHERE A.APP_ID=#{appId,jdbcType=VARCHAR}
   		UNION ALL  SELECT '--' SERVICE_TYPE,'合计' SERVICE_DL,TO_CHAR(SUM(ACCOUNT_COUNT)) ACCOUNT_COUNT,'--' FIRST_YW_GRANT_MONTH,0 FROM PBOC_CREDIT_TRANSACTION_DEL WHERE APP_ID=#{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultRecoveryInfo" type="java.util.Map">
		<result column="SERVICE_TYPE" property="serviceType" jdbcType="VARCHAR" />
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryRecoveryInfo" parameterType="java.lang.String"
		resultMap="resultRecoveryInfo">
		SELECT DECODE(SERVICE_TYPE,'1','资产处置业务','2','垫款业务')SERVICE_TYPE,ACCOUNT_COUNT,BALANCE FROM PBOC_BE_RECOVERIED_SUM_DEL WHERE APP_ID = #{appId,jdbcType=VARCHAR}
   		UNION ALL SELECT '合计' SERVICE_TYPE,TO_CHAR(SUM(ACCOUNT_COUNT)) ACCOUNT_COUNT,TO_CHAR(SUM(BALANCE)) BALANCE FROM PBOC_BE_RECOVERIED_SUM_DEL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultOverDraftInfo" type="java.util.Map">
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="MONTH_COUNT" property="monthCount" jdbcType="VARCHAR" />
		<result column="SINGLEM_MAX_OVERDUE_SUM" property="singlemMaxOverdueSum" jdbcType="VARCHAR" />
		<result column="MAX_OVERDUE_MONTH_COUNT" property="maxOverdueMonthCount" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryOverDraftInfo" parameterType="java.lang.String"
		resultMap="resultOverDraftInfo">
		 SELECT DECODE(ACCOUNT_TYPE,'1','非循环贷账户','2','循环额度下分账户','3','循环贷账户','4','贷记卡账户','5','准贷记卡账户') ACCOUNT_TYPE,
	     ACCOUNT_COUNT,MONTH_COUNT,SINGLEM_MAX_OVERDUE_SUM,MAX_OVERDUE_MONTH_COUNT FROM PBOC_OVERDUE_DRAFT_SUM_DEL
	     WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultRevolveInfo" type="java.util.Map">
		<result column="MANAGE_ORGAN_COUNT" property="manageOrganCount" jdbcType="VARCHAR" />
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="CREDIT_TOTAL_AMOUNT" property="creditTotalAmount" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="RECENT_6MS_AVG_YHK" property="recent6MSAVGYHK" jdbcType="VARCHAR" />
	</resultMap>
<!-- 非循环贷账户信息汇总 -->
	<select id="queryNoRevolveInfo" parameterType="java.lang.String"
		resultMap="resultRevolveInfo">
		SELECT MANAGE_ORGAN_COUNT,ACCOUNT_COUNT,CREDIT_TOTAL_AMOUNT,BALANCE,RECENT_6MS_AVG_YHK FROM PBOC_NOREVOLVE_LOAN_ACCOSUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<!-- 循环额度下分账户信息汇总 -->
	<select id="queryRevolveLimInfo" parameterType="java.lang.String"
		resultMap="resultRevolveInfo">
		SELECT MANAGE_ORGAN_COUNT,ACCOUNT_COUNT,CREDIT_TOTAL_AMOUNT,BALANCE,RECENT_6MS_AVG_YHK FROM PBOC_REVOLVELIM_SUBACCOSUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<!-- 循环贷账户信息汇总 -->
	<select id="queryRevolveInfo" parameterType="java.lang.String"
		resultMap="resultRevolveInfo">
		SELECT MANAGE_ORGAN_COUNT,ACCOUNT_COUNT,CREDIT_TOTAL_AMOUNT,BALANCE,RECENT_6MS_AVG_YHK FROM PBOC_REVOLVE_LOAN_ACCOSUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultCreditInfo" type="java.util.Map">
		<result column="FK_ORGAN_COUNT" property="fkOrganCount" jdbcType="VARCHAR" />
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="CREDIT_TOTAL_AMOUNT" property="creditTotalAmount" jdbcType="VARCHAR" />
		<result column="SINGLE_BANK_MAX_CREDIT" property="singleBankMaxCredit" jdbcType="VARCHAR" />
		<result column="SINGLE_BANK_MIN_CREDIT" property="singleBankMinCredit" jdbcType="VARCHAR" />
		<result column="USED_LIMIT" property="usedLimit" jdbcType="VARCHAR" />
		<result column="RECENT_6MS_AVG_SYED" property="recent6MSAVGSYED" jdbcType="VARCHAR" />
		<result column="RECENT_6MS_AVG_TZYE" property="recent6MSAVGTZYE" jdbcType="VARCHAR" />
		<result column="OVERDUE_BALANCE" property="overDueBalance" jdbcType="VARCHAR" />
		
	</resultMap>        
    <!-- 贷记卡账户信息汇总 -->
	<select id="queryCreditInfo" parameterType="java.lang.String"
		resultMap="resultCreditInfo">
		SELECT FK_ORGAN_COUNT,ACCOUNT_COUNT,CREDIT_TOTAL_AMOUNT,SINGLE_BANK_MAX_CREDIT,SINGLE_BANK_MIN_CREDIT,USED_LIMIT,RECENT_6MS_AVG_SYED FROM PBOC_CREDIT_CARD_ACCOSUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<!-- 准贷记卡账户信息汇总 -->
	<select id="querySemiCreditInfo" parameterType="java.lang.String"
		resultMap="resultCreditInfo">
		SELECT FK_ORGAN_COUNT,ACCOUNT_COUNT,CREDIT_TOTAL_AMOUNT,SINGLE_BANK_MAX_CREDIT,SINGLE_BANK_MIN_CREDIT,OVERDUE_BALANCE,RECENT_6MS_AVG_TZYE FROM PBOC_SEMICREDIT_CARD_ACCOSUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultRepayInfo11" type="java.util.Map">
		<result column="ACCOUNT_COUNT_11" property="accountCount11" jdbcType="VARCHAR" />
		<result column="BALANCE11" property="balance11" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY11" property="repayDutyMoney11" jdbcType="VARCHAR" />
	</resultMap>
<!-- 相关还款责任信息汇总 -->
	<select id="queryRepayInfo11" parameterType="java.lang.String"
		resultMap="resultRepayInfo11">
		SELECT ACCOUNT_COUNT ACCOUNT_COUNT_11,BALANCE BALANCE11,REPAY_DUTY_MONEY REPAY_DUTY_MONEY11 FROM PBOC_RELATED_REPAY_ZRXI_DEL WHERE BOEEOWER_IDENTITY_TYPE='1' AND REPAY_DUTY_TYPE='1'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultRepayInfo19" type="java.util.Map">
		<result column="ACCOUNT_COUNT_19" property="accountCount19" jdbcType="VARCHAR" />
		<result column="BALANCE19" property="balance19" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY19" property="repayDutyMoney19" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryRepayInfo19" parameterType="java.lang.String"
		resultMap="resultRepayInfo19">
		SELECT ACCOUNT_COUNT ACCOUNT_COUNT_19,BALANCE BALANCE19,REPAY_DUTY_MONEY REPAY_DUTY_MONEY19 FROM PBOC_RELATED_REPAY_ZRXI_DEL WHERE BOEEOWER_IDENTITY_TYPE='1' AND REPAY_DUTY_TYPE='9'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultRepayInfo21" type="java.util.Map">
		<result column="ACCOUNT_COUNT_21" property="accountCount21" jdbcType="VARCHAR" />
		<result column="BALANCE21" property="balance21" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY21" property="repayDutyMoney21" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryRepayInfo21" parameterType="java.lang.String"
		resultMap="resultRepayInfo21">
		SELECT ACCOUNT_COUNT ACCOUNT_COUNT_21,BALANCE BALANCE21,REPAY_DUTY_MONEY REPAY_DUTY_MONEY21 FROM PBOC_RELATED_REPAY_ZRXI_DEL WHERE BOEEOWER_IDENTITY_TYPE='2' AND REPAY_DUTY_TYPE='1'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultRepayInfo29" type="java.util.Map">
		<result column="ACCOUNT_COUNT_29" property="accountCount29" jdbcType="VARCHAR" />
		<result column="BALANCE29" property="balance29" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY29" property="repayDutyMoney29" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryRepayInfo29" parameterType="java.lang.String"
		resultMap="resultRepayInfo29">
		SELECT ACCOUNT_COUNT ACCOUNT_COUNT_29,BALANCE BALANCE29,REPAY_DUTY_MONEY REPAY_DUTY_MONEY29 FROM PBOC_RELATED_REPAY_ZRXI_DEL WHERE BOEEOWER_IDENTITY_TYPE='2' AND REPAY_DUTY_TYPE='9'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultArrgepayInfo" type="java.util.Map">
		<result column="HFF_SERV_TYPE" property="hffServType" jdbcType="VARCHAR" />
		<result column="ARREARAGE_COUNT" property="arrearageCount" jdbcType="VARCHAR" />
		<result column="ARREARAGE_MONEY" property="arrearageMoney" jdbcType="VARCHAR" />
	</resultMap>
<!-- 后付费业务欠费信息汇总 -->
	<select id="queryArrgepayInfo" parameterType="java.lang.String"
		resultMap="resultArrgepayInfo">
		SELECT HFF_SERV_TYPE,ARREARAGE_COUNT,ARREARAGE_MONEY FROM PBOC_POST_PAY_ARRGE_SUM_DEL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultPublicInfo" type="java.util.Map">
		<result column="GGXN_TYPE" property="ggxnType" jdbcType="VARCHAR" />
		<result column="RECORD_COUNT" property="recordCount" jdbcType="VARCHAR" />
		<result column="INVOLVE_MONEY" property="involveMoney" jdbcType="VARCHAR" />
	</resultMap>
<!-- 公共信息汇总 -->
	<select id="queryPublicInfo" parameterType="java.lang.String"
		resultMap="resultPublicInfo">
		SELECT DECODE(GGXN_TYPE,'1','欠税信息','2','民事判决信息','3','强制执行信息','4','行政处罚信息') GGXN_TYPE,RECORD_COUNT,INVOLVE_MONEY FROM PBOC_PUBLIC_INFO_DEL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultLastQueryRecInfo" type="java.util.Map">
		<result column="LAST_QUERY_DATE" property="lastQueryDate" jdbcType="VARCHAR" />
		<result column="LAST_QUERY_ORGAN_CODE" property="lastQueryOrganCode" jdbcType="VARCHAR" />
		<result column="LAST_QUERY_ORGAN_TYPE" property="lastQueryOrganType" jdbcType="VARCHAR" />
		<result column="LAST_QUERY_REASON" property="lastQueryReason" jdbcType="VARCHAR" />
	</resultMap>
<!-- 上一次查询记录 有问题-->
	<select id="queryLastQueryRecInfo" parameterType="java.lang.String"
		resultMap="resultLastQueryRecInfo">
		SELECT LAST_QUERY_DATE,LAST_QUERY_ORGAN_TYPE,LAST_QUERY_ORGAN_CODE,LAST_QUERY_REASON FROM PBOC_LAST_QUERY_RECORD
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultQueryInfoNew" type="java.util.Map">
		<result column="QUERY_ORG_1M_SUM2" property="queryOrg1MSum2" jdbcType="VARCHAR" />
		<result column="QUERY_ORG_1M_SUM3" property="queryOrg1MSum3" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM2" property="queryRec1MSum2" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM3" property="queryRec1MSum3" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM4" property="queryRec1MSum4" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM1" property="queryRec2YSum1" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM5" property="queryRec2YSum5" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM6" property="queryRec2YSum6" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 最近一个月内查询机构数-->
	<select id="queryLastQueryInfoNew" parameterType="java.lang.String" resultMap="resultQueryInfoNew">
		 SELECT QUERY_ORG_1M_SUM2,QUERY_ORG_1M_SUM3,QUERY_REC_1M_SUM2,QUERY_REC_1M_SUM3,QUERY_REC_1M_SUM4,QUERY_REC_2Y_SUM1,QUERY_REC_2Y_SUM5,QUERY_REC_2Y_SUM6  FROM PBOC_QUERYINFO_NEW	
		 WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	<resultMap id="resultC1Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 被追偿信息账户-->
	<select id="queryC1Info" parameterType="java.lang.String" 
		resultMap="resultC1Info">
		SELECT A.SERV_MANAGE_ORGAN_TYPE,A.RELATE_ID,A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,A.ASSIGN_DEBT_REPAY_STATUS,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS
	    <!-- ,
	    C.TYPE,C.OCCUR_DATE,C.CHANGING_MONTHS,C.OCCUR_AMT,C.DETAIL_REC   -->
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	   <!--  LEFT JOIN OPAS_PBOC_LOAN_CARD_SPETRAD C ON A.RELATE_ID=C.FA_REC_SEQ -->
	    WHERE A.ACCOUNT_TYPE='C1'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	    order by instr('1,2',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC
	</select>
	
	<resultMap id="resultSpetradInfo" type="java.util.Map">
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 特殊交易类型-->
	<select id="querySpetradInfo" parameterType="java.lang.String"
		resultMap="resultSpetradInfo">
		SELECT TYPE,OCCUR_DATE,CHANGING_MONTHS,OCCUR_AMT,DETAIL_REC 
	    FROM  OPAS_PBOC_LOAN_CARD_SPETRAD WHERE FA_REC_SEQ = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultD1Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" /> 
		<result column="DUE_DATE" property="dueDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MARK" property="accountMark" jdbcType="VARCHAR" />
		<result column="GUARANTY_TYPE" property="guarantyType" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="REPAYMENT_FREQUENCY" property="repaymentFrequemcy" jdbcType="VARCHAR" />
		<result column="MODE_OF_REPAYMENT" property="modeOfRepayment" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SHARE_CREDIT_LIMIT" property="shareCreditLimit" jdbcType="VARCHAR" />
		<result column="LOAN_DISTRIBUTE_FORM" property="loanDistributeForm" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 非循环贷账户-->
	<select id="queryD1Info" parameterType="java.lang.String"
		resultMap="resultD1Info">
		SELECT A.LOAN_DISTRIBUTE_FORM,A.SHARE_CREDIT_LIMIT,A.ACCO_CREDIT_LIMIT,A.SERV_MANAGE_ORGAN_TYPE,A.COMMON_DEBIT_CREDIT_MARK,A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.REPAYMENT_PERIODS,A.RELATE_ID,A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,
      	A.ASSIGN_DEBT_REPAY_STATUS,A.ACCOUNT_MARK,A.DUE_DATE,A.CURRENCY,A.GUARANTY_TYPE,
      	A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.COMMON_DEBIT_CREDIT_MARK,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,B.CLOSE_DATE,B.ZC_MONTH,
      	B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS,C.CREDIT_PROTOCOL_MARK,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID
	    LEFT JOIN PBOC_PCA_BASIC_INFO C ON A.CREDIT_XY_SERIAL = C.CREDIT_PROTOCOL_SERIAL AND A.APP_ID=C.APP_ID  
	    WHERE A.ACCOUNT_TYPE='D1'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	     order by instr('7,4,8,2,6,1,5,3',rtrim(cast(D.ACCOUNT_STATUS as nchar))), instr('7,4,8,2,6,1,5,3',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC,
      DECODE(A.SERV_MANAGE_ORGAN_CODE,'B10811000H0001','1', A.SERV_MANAGE_ORGAN_CODE)	
	</select>
	<resultMap id="resultR4Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MARK" property="accountMark" jdbcType="VARCHAR" />
		<result column="DUE_DATE" property="dueDate" jdbcType="VARCHAR" />
		<result column="GUARANTY_TYPE" property="guarantyType" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="REPAYMENT_FREQUENCY" property="repaymentFrequemcy" jdbcType="VARCHAR" />
		<result column="MODE_OF_REPAYMENT" property="modeOfRepayment" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SHARE_CREDIT_LIMIT" property="shareCreditLimit" jdbcType="VARCHAR" />
		<result column="LOAN_DISTRIBUTE_FORM" property="loanDistributeForm" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 循环额度下分账户	 -->
	<select id="queryR4Info" parameterType="java.lang.String"
		resultMap="resultR4Info">
		SELECT A.LOAN_DISTRIBUTE_FORM,A.SHARE_CREDIT_LIMIT,A.ACCO_CREDIT_LIMIT,A.SERV_MANAGE_ORGAN_TYPE,A.CURRENCY,A.COMMON_DEBIT_CREDIT_MARK,A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.REPAYMENT_PERIODS,A.DUE_DATE,A.ACCOUNT_MARK,A.RELATE_ID, A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,A.ASSIGN_DEBT_REPAY_STATUS,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,A.GUARANTY_TYPE,
	    C.CREDIT_PROTOCOL_MARK,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	     LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID
	     LEFT JOIN PBOC_PCA_BASIC_INFO C ON A.CREDIT_XY_SERIAL = C.CREDIT_PROTOCOL_SERIAL AND A.APP_ID=C.APP_ID  
	    WHERE A.ACCOUNT_TYPE='R4'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	     order by instr('8,6,4,2,1,3',rtrim(cast(D.ACCOUNT_STATUS as nchar))), instr('8,6,4,2,1,3',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC,
      DECODE(A.SERV_MANAGE_ORGAN_CODE,'B10811000H0001','1', A.SERV_MANAGE_ORGAN_CODE)
	</select>
	
	<resultMap id="resultR1Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MARK" property="accountMark" jdbcType="VARCHAR" />
		<result column="DUE_DATE" property="dueDate" jdbcType="VARCHAR" />
		<result column="GUARANTY_TYPE" property="guarantyType" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="REPAYMENT_FREQUENCY" property="repaymentFrequemcy" jdbcType="VARCHAR" />
		<result column="MODE_OF_REPAYMENT" property="modeOfRepayment" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SHARE_CREDIT_LIMIT" property="shareCreditLimit" jdbcType="VARCHAR" />
		<result column="LOAN_DISTRIBUTE_FORM" property="loanDistributeForm" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 循环贷账户-->
	<select id="queryR1Info" parameterType="java.lang.String"
		resultMap="resultR1Info">
		SELECT A.LOAN_DISTRIBUTE_FORM,A.SHARE_CREDIT_LIMIT,A.ACCO_CREDIT_LIMIT,A.SERV_MANAGE_ORGAN_TYPE,A.ACCO_CREDIT_LIMIT,A.CURRENCY,A.COMMON_DEBIT_CREDIT_MARK,A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.REPAYMENT_PERIODS,A.GUARANTY_TYPE,A.DUE_DATE,A.ACCOUNT_MARK,A.RELATE_ID,A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,A.ASSIGN_DEBT_REPAY_STATUS,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,
	    C.CREDIT_PROTOCOL_MARK,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	     LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID
	     LEFT JOIN PBOC_PCA_BASIC_INFO C ON A.CREDIT_XY_SERIAL = C.CREDIT_PROTOCOL_SERIAL AND A.APP_ID=C.APP_ID  
	    WHERE A.ACCOUNT_TYPE='R1'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	     order by  instr('6,4,8,2,1,5,3',rtrim(cast(D.ACCOUNT_STATUS as nchar))), instr('6,4,8,2,1,5,3',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC,
      DECODE(A.SERV_MANAGE_ORGAN_CODE,'B10811000H0001','1', A.SERV_MANAGE_ORGAN_CODE)
	</select>
	
	<resultMap id="resultR2Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MARK" property="accountMark" jdbcType="VARCHAR" />
		<result column="DUE_DATE" property="dueDate" jdbcType="VARCHAR" />
		<result column="GUARANTY_TYPE" property="guarantyType" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="REPAYMENT_FREQUENCY" property="repaymentFrequemcy" jdbcType="VARCHAR" />
		<result column="MODE_OF_REPAYMENT" property="modeOfRepayment" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SHARE_CREDIT_LIMIT" property="shareCreditLimit" jdbcType="VARCHAR" />
		<result column="LOAN_DISTRIBUTE_FORM" property="loanDistributeForm" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 贷记卡账户-->
	<select id="queryR2Info" parameterType="java.lang.String"
		resultMap="resultR2Info">                                                                         
		SELECT A.LOAN_DISTRIBUTE_FORM,A.SHARE_CREDIT_LIMIT,A.ACCO_CREDIT_LIMIT,A.SERV_MANAGE_ORGAN_TYPE,A.CURRENCY,A.COMMON_DEBIT_CREDIT_MARK,A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.REPAYMENT_PERIODS,A.GUARANTY_TYPE,A.DUE_DATE,A.ACCOUNT_MARK,A.RELATE_ID,A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,A.ASSIGN_DEBT_REPAY_STATUS,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,
	    C.CREDIT_PROTOCOL_MARK,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	     LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID
	     LEFT JOIN PBOC_PCA_BASIC_INFO C ON A.CREDIT_XY_SERIAL = C.CREDIT_PROTOCOL_SERIAL AND A.APP_ID=C.APP_ID  
	    WHERE A.ACCOUNT_TYPE='R2'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	    order by  instr('2,6,8,3,31,5,1,4',rtrim(cast(D.ACCOUNT_STATUS as nchar))), instr('2,6,8,3,31,5,1,4',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC,
      DECODE(A.SERV_MANAGE_ORGAN_CODE,'B10811000H0001','1', A.SERV_MANAGE_ORGAN_CODE)
	</select>
	
	<resultMap id="resultR3Info" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ASSIGN_DEBT_REPAY_STATUS" property="assignDevtRepayStatus" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="neaarestRepayDate" jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_DATE" property="occurDate" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="OCCUR_AMT" property="occurAmt" jdbcType="VARCHAR" />
		<result column="DETAIL_REC" property="detailRec" jdbcType="VARCHAR" />
		<result column="ACCOUNT_MARK" property="accountMark" jdbcType="VARCHAR" />
		<result column="DUE_DATE" property="dueDate" jdbcType="VARCHAR" />
		<result column="GUARANTY_TYPE" property="guarantyType" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="REPAYMENT_FREQUENCY" property="repaymentFrequemcy" jdbcType="VARCHAR" />
		<result column="MODE_OF_REPAYMENT" property="modeOfRepayment" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="CLOSE_DATE" property="closeDate" jdbcType="VARCHAR" />
		<result column="ZC_MONTH" property="zcMonth" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_MONEY" property="nearestRepayMoney" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SHARE_CREDIT_LIMIT" property="shareCreditLimit" jdbcType="VARCHAR" />
		<result column="LOAN_DISTRIBUTE_FORM" property="loanDistributeForm" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 准贷记卡账户-->
	<select id="queryR3Info" parameterType="java.lang.String"
		resultMap="resultR3Info">
		SELECT A.LOAN_DISTRIBUTE_FORM,A.SHARE_CREDIT_LIMIT,A.ACCO_CREDIT_LIMIT,A.SERV_MANAGE_ORGAN_TYPE,A.CURRENCY,A.COMMON_DEBIT_CREDIT_MARK,A.REPAYMENT_FREQUENCY,A.MODE_OF_REPAYMENT,A.REPAYMENT_PERIODS,A.GUARANTY_TYPE,A.DUE_DATE,A.ACCOUNT_MARK,A.RELATE_ID,A.ACCOUNT_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,A.ASSIGN_DEBT_REPAY_STATUS,
	    B.ACCOUNT_STATUS,B.INFO_REPORT_DATE,B.BALANCE,B.NEAREST_REPAY_DATE,
	    C.CREDIT_PROTOCOL_MARK,
	    B.CLOSE_DATE,B.ZC_MONTH,B.NEAREST_REPAY_MONEY,B.FIVE_CLASSIFY,B.REPAY_STATUS
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	     LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID
	     LEFT JOIN PBOC_PCA_BASIC_INFO C ON A.CREDIT_XY_SERIAL = C.CREDIT_PROTOCOL_SERIAL AND A.APP_ID=C.APP_ID  
	    WHERE A.ACCOUNT_TYPE='R3'  AND A.APP_ID = #{appId,jdbcType=VARCHAR}
	    order by instr('2,6,8,3,31,5,1,4',rtrim(cast(D.ACCOUNT_STATUS as nchar))), instr('2,6,8,3,31,5,1,4',rtrim(cast(B.ACCOUNT_STATUS as nchar))), A.KL_DATE ASC,
      DECODE(A.SERV_MANAGE_ORGAN_CODE,'B10811000H0001','1', A.SERV_MANAGE_ORGAN_CODE)
	</select>
	
	<resultMap id="resultNearestInfo" type="java.util.Map">
		<result column="MONTH" property="month" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS" property="accountStatus" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="USED_LIMIT" property="usedLimit" jdbcType="VARCHAR" />
		<result column="UNISSU_DEZX_FQYE" property="unissuDezxFqye" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REMANENT_REPAY_PERIODS" property="remanentRepayPeriods" jdbcType="VARCHAR" />
		<result column="SETTLE_DUE_DATE" property="settleDueDate" jdbcType="VARCHAR" />
		<result column="THIS_MONTH_DUE" property="thisMonthDue" jdbcType="VARCHAR" />
		<result column="THIS_MONTH_ACTUAL_PAY" property="thisMonthActualPay" jdbcType="VARCHAR" />
		<result column="CUR_OVERDUE_PERIODS" property="curOverDuePeriods" jdbcType="VARCHAR" />
		<result column="NEAREST_REPAY_DATE" property="nearestRepayDate" jdbcType="VARCHAR" />
		<result column="CUR_OVERDUE_TOTAL" property="curOverDueTotal" jdbcType="VARCHAR" />
		<result column="OVERDUE3160_NREPAY_CAPITAL" property="overDue3160NRepayCapital" jdbcType="VARCHAR" />
		<result column="OVERDUE6190_NREPAY_CAPITAL" property="overDue6190NRepayCapital" jdbcType="VARCHAR" />
		<result column="OVERDUE91180_NREPAY_CAPITAL" property="overDue91180NRepayCapital" jdbcType="VARCHAR" />
		<result column="OVERDUE180ADD_NREPAY_CAPITAL" property="overDue180AddNRepayCapital" jdbcType="VARCHAR" />
		<result column="OVERDRAFT180ADD_NPAY_BALAN" property="overDraft180AddNpayBalan" jdbcType="VARCHAR" />
		<result column="RECENT6M_AVG_USE_LIMIT" property="Recent6mAvgUseLimit" jdbcType="VARCHAR" />
		<result column="RECENT6M_AVG_OVERBALANCE" property="Recent6mAvgOverBalance" jdbcType="VARCHAR" />
		<result column="MAX_USE_LIMIT" property="maxUseLimit" jdbcType="VARCHAR" />
		<result column="MAX_OVERDRAFT_BALANCE" property="maxOverDraftBalance" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="REPAYMENT_PERIODS" property="repaymentPeroids" jdbcType="VARCHAR" />
		<result column="COMMON_DEBIT_CREDIT_MARK" property="commonDebitCreditMark" jdbcType="VARCHAR" />
		
		
	</resultMap>
	
	<!-- 最近一次月度表现信息段-->
	<select id="queryNearestMInfo" parameterType="java.lang.String"
		resultMap="resultNearestInfo">
		SELECT D.MONTH,D.ACCOUNT_STATUS,D.BALANCE,D.USED_LIMIT,D.UNISSU_DEZX_FQYE,D.FIVE_CLASSIFY,
      	D.REMANENT_REPAY_PERIODS,D.SETTLE_DUE_DATE,D.THIS_MONTH_DUE,D.THIS_MONTH_ACTUAL_PAY,D.NEAREST_REPAY_DATE,
      	D.CUR_OVERDUE_PERIODS,D.CUR_OVERDUE_TOTAL,D.OVERDUE3160_NREPAY_CAPITAL,D.OVERDUE6190_NREPAY_CAPITAL,
      	D.OVERDUE91180_NREPAY_CAPITAL,D.OVERDUE180ADD_NREPAY_CAPITAL,D.OVERDRAFT180ADD_NPAY_BALAN,D.RECENT6M_AVG_USE_LIMIT,
      	D.RECENT6M_AVG_OVERBALANCE,D.MAX_USE_LIMIT,D.MAX_OVERDRAFT_BALANCE,D.INFO_REPORT_DATE 
	    FROM PBOC_DEBIT_CREDIT_NEAREST_M D
	    WHERE  D.RELATE_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultLatest24MonthInfo" type="java.util.Map">
		<result column="YEAR" property="year" jdbcType="VARCHAR" />
		<result column="START_YEAR_MONTH" property="startYearMonth" jdbcType="VARCHAR" />
		<result column="END_YEAR_MONTH" property="endYearMonth" jdbcType="VARCHAR" />
		<result column="M1" property="m1" jdbcType="VARCHAR" />
		<result column="M2" property="m2" jdbcType="VARCHAR" />
		<result column="M3" property="m3" jdbcType="VARCHAR" />
		<result column="M4" property="m4" jdbcType="VARCHAR" />
		<result column="M5" property="m5" jdbcType="VARCHAR" />
		<result column="M6" property="m6" jdbcType="VARCHAR" />
		<result column="M7" property="m7" jdbcType="VARCHAR" />
		<result column="M8" property="m8" jdbcType="VARCHAR" />
		<result column="M9" property="m9" jdbcType="VARCHAR" />
		<result column="M10" property="m10" jdbcType="VARCHAR" />
		<result column="M11" property="m11" jdbcType="VARCHAR" />
		<result column="M12" property="m12" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--最近24个月还款状态信息段-->
	<select id="queryLatest24MonthInfo" parameterType="java.lang.String"
		resultMap="resultLatest24MonthInfo">
	 SELECT SUBSTR(A.MONTH,0,4) YEAR,B.START_YEAR_MONTH,B.END_YEAR_MONTH,
  	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-01',A.REPAY_STATUS,NULL) ) M1,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-02',A.REPAY_STATUS,NULL) ) M2,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-03',A.REPAY_STATUS,NULL) ) M3,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-04',A.REPAY_STATUS,NULL) ) M4,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-05',A.REPAY_STATUS,NULL) ) M5,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-06',A.REPAY_STATUS,NULL) ) M6,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-07',A.REPAY_STATUS,NULL) ) M7,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-08',A.REPAY_STATUS,NULL) ) M8,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-09',A.REPAY_STATUS,NULL) ) M9,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-10',A.REPAY_STATUS,NULL) ) M10,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-11',A.REPAY_STATUS,NULL) ) M11,
 	 MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-12',A.REPAY_STATUS,NULL) ) M12
     FROM PBOC_REPAY_STATUS_INFO A LEFT JOIN PBOC_NEAREST24M_REPAY_RECORD B ON A.RELATE_ID=B.RELATE_ID WHERE A.RELATE_ID= #{appId,jdbcType=VARCHAR} GROUP BY SUBSTR(A.MONTH,0,4),B.START_YEAR_MONTH,B.END_YEAR_MONTH ORDER BY SUBSTR(A.MONTH,0,4)
	</select>
	
	<resultMap id="resultLatest5YInfo" type="java.util.Map">
		<result column="YEAR" property="year" jdbcType="VARCHAR" />
		<result column="START_YEAR_MONTH" property="startYearMonth" jdbcType="VARCHAR" />
		<result column="END_YEAR_MONTH" property="endYearMonth" jdbcType="VARCHAR" />
		<result column="M1" property="m1" jdbcType="VARCHAR" />
		<result column="M2" property="m2" jdbcType="VARCHAR" />
		<result column="M3" property="m3" jdbcType="VARCHAR" />
		<result column="M4" property="m4" jdbcType="VARCHAR" />
		<result column="M5" property="m5" jdbcType="VARCHAR" />
		<result column="M6" property="m6" jdbcType="VARCHAR" />
		<result column="M7" property="m7" jdbcType="VARCHAR" />
		<result column="M8" property="m8" jdbcType="VARCHAR" />
		<result column="M9" property="m9" jdbcType="VARCHAR" />
		<result column="M10" property="m10" jdbcType="VARCHAR" />
		<result column="M11" property="m11" jdbcType="VARCHAR" />
		<result column="M12" property="m12" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--最近5年内的历史表现信息段-->
	<select id="queryLatest5YInfo" parameterType="java.lang.String"
		resultMap="resultLatest5YInfo">
	  SELECT SUBSTR(A.MONTH,0,4) YEAR,B.START_YEAR_MONTH,B.END_YEAR_MONTH,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-01',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M1,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-02',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M2,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-03',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M3,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-04',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M4,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-05',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M5,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-06',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M6,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-07',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M7,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-08',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M8,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-09',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M9,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-10',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M10,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-11',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M11,
	  MAX(DECODE(A.MONTH,SUBSTR(A.MONTH,0,4)||'-12',A.REPAY_STATUS||'-'||A.OVERDUE_TOTAL,NULL) ) M12
	  FROM PBOC_HISTORY_EXPRESS_INFO A LEFT JOIN PBOC_NEAREST5Y_HIS_EXPRESS B ON A.RELATE_ID=B.RELATE_ID WHERE A.RELATE_ID= #{appId,jdbcType=VARCHAR} GROUP BY SUBSTR(A.MONTH,0,4),B.START_YEAR_MONTH,B.END_YEAR_MONTH ORDER BY SUBSTR(A.MONTH,0,4)
	</select>
	
	<resultMap id="resultSpecialEventInfo" type="java.util.Map">
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="OCCUR_MONTH" property="occurMonth" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--特殊事件说明信息-->
	<select id="querySpecialEventInfo" parameterType="java.lang.String"
		resultMap="resultSpecialEventInfo">
	  SELECT OCCUR_MONTH,TYPE FROM PBOC_SPECIAL_EVENTEXPS_INFO
	  WHERE RELATE_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultStateInfo" type="java.util.Map">
		<result column="TYPE" property="type" jdbcType="VARCHAR" />
		<result column="CONTENT" property="content" jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="addDate" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--标注及声明信息-->
	<select id="queryStateInfo" parameterType="java.util.Map"
		resultMap="resultStateInfo">
	  SELECT TYPE,CONTENT,ADD_DATE FROM ${table}
	  WHERE RELATE_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultDezxInfo" type="java.util.Map">
		<result column="FQED" property="fqed" jdbcType="VARCHAR" />
		<result column="FQED_EFFECT_DATE" property="fqedEffectDate" jdbcType="VARCHAR" />
		<result column="FQED_EXPIRE_DATE" property="fqedExpireDate" jdbcType="VARCHAR" />
		<result column="USED_FQ_MONEY" property="usedFqMoney" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--大额专项分期信息-->
	<select id="queryDezxInfo" parameterType="java.lang.String"
		resultMap="resultDezxInfo">
	  SELECT FQED,FQED_EFFECT_DATE,FQED_EXPIRE_DATE,USED_FQ_MONEY FROM PBOC_DEZX_FQ_INFO
	  WHERE RELATE_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultDezx4PersonInfo" type="java.util.Map">
		<result column="SERV_MANAGE_ORGAN" property="servManageOrgan" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="OPEN_DATE" property="openDate" jdbcType="VARCHAR" />
		<result column="EXPIRE_DATE" property="expireDate" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MAN_TYPE" property="repayDutyManType" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY" property="pepayDutyMoney" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="GUARANTEE_PACT_SERIAL" property="guaranteePactSerial" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--相关还款责任信息-有相关还款责任的个人借款-->
	<select id="queryDezx4PersonInfo" parameterType="java.lang.String"
		resultMap="resultDezx4PersonInfo">
	  SELECT RELATE_ID,SERV_MANAGE_ORGAN_TYPE,SERV_MANAGE_ORGAN,SERV_TYPE,OPEN_DATE,EXPIRE_DATE,REPAY_DUTY_MAN_TYPE,REPAY_DUTY_MONEY,
	  CURRENCY,GUARANTEE_PACT_SERIAL,INFO_REPORT_DATE,BALANCE,FIVE_CLASSIFY,OVERDUE_MONTH_NUM,REPAY_STATUS                                                                                     
 	  FROM PBOC_RELATE_REPAY_DUTY_INFO WHERE TO_NUMBER(MAIN_BORROWER_IDENTITY_TYPE)=1
	  AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultDezx4GroupInfo" type="java.util.Map">
		<result column="SERV_MANAGE_ORGAN" property="servManageOrgan" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="OPEN_DATE" property="openDate" jdbcType="VARCHAR" />
		<result column="EXPIRE_DATE" property="expireDate" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MAN_TYPE" property="repayDutyManType" jdbcType="VARCHAR" />
		<result column="REPAY_DUTY_MONEY" property="pepayDutyMoney" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="GUARANTEE_PACT_SERIAL" property="guaranteePactSerial" jdbcType="VARCHAR" />
		<result column="INFO_REPORT_DATE" property="infoReportDate" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="FIVE_CLASSIFY" property="fiveClassify" jdbcType="VARCHAR" />
		<result column="OVERDUE_MONTH_NUM" property="overDueMonthNum" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--相关还款责任信息-有相关还款责任的企业借款-->
	<select id="queryDezx4GroupInfo" parameterType="java.lang.String"
		resultMap="resultDezx4GroupInfo">
	  SELECT RELATE_ID,SERV_MANAGE_ORGAN_TYPE,SERV_MANAGE_ORGAN,SERV_TYPE,OPEN_DATE,EXPIRE_DATE,REPAY_DUTY_MAN_TYPE,REPAY_DUTY_MONEY,
	  CURRENCY,GUARANTEE_PACT_SERIAL,INFO_REPORT_DATE,BALANCE,FIVE_CLASSIFY,OVERDUE_MONTH_NUM,REPAY_STATUS                                                                                    
 	  FROM PBOC_RELATE_REPAY_DUTY_INFO
	  WHERE TO_NUMBER(MAIN_BORROWER_IDENTITY_TYPE)=2
	  AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultPcaInfo" type="java.util.Map">
		<result column="SERV_MANAGE_ORGAN" property="servManageOrgan" jdbcType="VARCHAR" />
		<result column="EFFECT_DATE" property="effectDate" jdbcType="VARCHAR" />
		<result column="CREDIT_PROTOCOL_MARK" property="creditProtoclMark" jdbcType="VARCHAR" />
		<result column="EXPIRE_DATE" property="expireDate" jdbcType="VARCHAR" />
		<result column="CREDIT_LIMIT_PURPOSE" property="creditLimitPurpose" jdbcType="VARCHAR" />
		<result column="CREDIT_LIMIT" property="creditLimit" jdbcType="VARCHAR" />
		<result column="CREDIT_QUOTA" property="creditQuota" jdbcType="VARCHAR" />
		<result column="CREDIT_QUOTA_SERIAL" property="creditQuotaSerial" jdbcType="VARCHAR" />
		<result column="USED_LIMIT" property="usedLimit" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--授信协议信息-->
	<select id="queryPcaInfo" parameterType="java.lang.String"
		resultMap="resultPcaInfo">
	  SELECT RELATE_ID,SERV_MANAGE_ORGAN_TYPE,SERV_MANAGE_ORGAN,CREDIT_PROTOCOL_MARK,EFFECT_DATE,EXPIRE_DATE,CREDIT_LIMIT_PURPOSE,
	  CREDIT_LIMIT,CREDIT_QUOTA,CREDIT_QUOTA_SERIAL,USED_LIMIT,CURRENCY	 
	  from PBOC_PCA_BASIC_INFO 
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultTelpaymentInfo" type="java.util.Map">
		<result column="TELECOM_FACILITATOR" property="telecomFacilitator" jdbcType="VARCHAR" />
		<result column="BUSI_TYPE" property="busiType" jdbcType="VARCHAR" />
		<result column="TALLY_YM" property="tallyYm" jdbcType="VARCHAR" />
		<result column="BUSI_OPN_DATE" property="busiOpnDate" jdbcType="VARCHAR" />
		<result column="CUR_PAY_STAT" property="curPayStat" jdbcType="VARCHAR" />
		<result column="CUR_DEBT_AMT" property="curDebtAmt" jdbcType="VARCHAR" />
		<result column="PREST24MPAY_STAT" property="Prest24Mpay" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--后付费记录-->
	<select id="queryTelPaymentInfo" parameterType="java.lang.String"
		resultMap="resultTelpaymentInfo">
	  SELECT RELATE_ID,TELECOM_FACILITATOR,BUSI_TYPE,BUSI_OPN_DATE,CUR_PAY_STAT,CUR_DEBT_AMT,TALLY_YM,PREST24MPAY_STAT
	  FROM OPAS_PBOC_PUBLIC_TELPAYMENT  
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultTaxArrearInfo" type="java.util.Map">
		<result column="TAX_ORG_NAME" property="taxOrgName" jdbcType="VARCHAR" />
		<result column="OUTSTD_TAXES_AMT_SUM" property="outsidTaxesAmtSum" jdbcType="VARCHAR" />
		<result column="OUTSTD_TAX_STAT_DT" property="outsidTaxStatDt" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--欠税记录-->
	<select id="queryTaxArrearInfo" parameterType="java.lang.String"
		resultMap="resultTaxArrearInfo">
	  SELECT RELATE_ID,TAX_ORG_NAME,OUTSTD_TAXES_AMT_SUM,OUTSTD_TAX_STAT_DT
	  FROM OPAS_PBOC_PUBLIC_TAXARREAR   
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultCivJudgeInfo" type="java.util.Map">
		<result column="REG_COURT" property="regCourt" jdbcType="VARCHAR" />
		<result column="CASE_REASON" property="caseReason" jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_WAY" property="closeCaseWay" jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_RST" property="judgMediateRst" jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_EFFCT_DT" property="judgMediateEffctDt" jdbcType="VARCHAR" />
		<result column="LAW_OBJECT" property="lawObject" jdbcType="VARCHAR" />
		<result column="LAW_OBJECT_AMT" property="lawObjectAmt" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--民事判决记录-->
	<select id="queryCivJudgeInfo" parameterType="java.lang.String"
		resultMap="resultCivJudgeInfo">
	  SELECT RELATE_ID,REG_COURT,CASE_REASON,REG_DATE,CLOSE_CASE_WAY,JUDG_MEDIATE_RST,JUDG_MEDIATE_EFFCT_DT,LAW_OBJECT,LAW_OBJECT_AMT
	  FROM OPAS_PBOC_PUBLIC_CIVJUDGE    
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultForceexeInfo" type="java.util.Map">
		<result column="ACCOUNT_COUNT" property="account" jdbcType="VARCHAR" />
		<result column="BALANCE" property="crtUser" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--强制执行记录-->
	<select id="queryForceexeInfo" parameterType="java.lang.String"
		resultMap="resultForceexeInfo">
	  SELECT RELATE_ID,EXECUTE_COURT,EXECUTE_CASE_RSN,REG_DATE,CLOSE_CASE_WAY,CASE_STATUS,CLOSE_CASE_DATE,
	  APPLY_EXE_OBJ,APPLY_EXE_OBJ_AMT,ALREADY_EXE_OBJ,ALREADY_EXE_OBJ_AMT
	  FROM OPAS_PBOC_PUBLIC_FORCEEXE   
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultAdminPunishInfo" type="java.util.Map">
		<result column="ACCOUNT_COUNT" property="account" jdbcType="VARCHAR" />
		<result column="BALANCE" property="crtUser" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--行政处罚记录-->
	<select id="queryAdminPunishInfo" parameterType="java.lang.String"
		resultMap="resultAdminPunishInfo">
	  SELECT RELATE_ID,PUNISH_ORGANIZ,PUNISH_CONTENT,PUNISH_AMT,EFFECT_DATE,END_DATE,AD_REVIEW_RESULT
	  FROM OPAS_PBOC_PUBLIC_ADMINPUNISH     
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultAccfundInfo" type="java.util.Map">
		<result column="JOIN_SOCL_INSU_PL" property="joinSoclInsuPl" jdbcType="VARCHAR" />
		<result column="JOIN_SOCL_INSU_DT" property="joinSoclInsuDt" jdbcType="VARCHAR" />
		<result column="FIRST_DEPOSIT_YM" property="firstDepositYm" jdbcType="VARCHAR" />
		<result column="PAY_YM" property="payYm" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit" jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate" jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--住房公积金参缴记录-->
	<select id="queryAccfundInfo" parameterType="java.lang.String"
		resultMap="resultAccfundInfo">
	 SELECT RELATE_ID,JOIN_SOCL_INSU_PL,JOIN_SOCL_INSU_DT,FIRST_DEPOSIT_YM,PAY_YM,PAY_STATUS,
	 MONTHLY_DEPOSIT,PERSON_DEPOSIT_RATE,COMP_DEPOSIT_RATE
	 FROM OPAS_PBOC_PUBLIC_ACCFUND       
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultSalvationInfo" type="java.util.Map">
		<result column="PERSONNEL_TYPE" property="personnelType" jdbcType="VARCHAR" />
		<result column="PLACE" property="place" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="HOME_MINCOME" property="homeMincome" jdbcType="VARCHAR" />
		<result column="APP_DATE" property="appDate" jdbcType="VARCHAR" />
		<result column="PASS_DATE" property="passDate" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--低保救助记录-->
	<select id="querySalvationInfo" parameterType="java.lang.String"
		resultMap="resultSalvationInfo">
	  SELECT RELATE_ID,PERSONNEL_TYPE,PLACE,COMPANY,HOME_MINCOME,APP_DATE,PASS_DATE,INFO_UPD_TIME
	  FROM OPAS_PBOC_PUBLIC_SALVATION       
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultCompetenceInfo" type="java.util.Map">
		<result column="COMPETENCY_NAME" property="competencyName" jdbcType="VARCHAR" />
		<result column="RANK" property="rank" jdbcType="VARCHAR" />
		<result column="AWARD_DATE" property="awardDate" jdbcType="VARCHAR" />
		<result column="EXP_DATE" property="expDate" jdbcType="VARCHAR" />
		<result column="REVOKE_DATE" property="revokeDate" jdbcType="VARCHAR" />
		<result column="AWARD_ORG" property="awardOrg" jdbcType="VARCHAR" />
		<result column="ORG_PLACE" property="orgPlace" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--职业资格记录-->
	<select id="queryCompetenceInfo" parameterType="java.lang.String"
		resultMap="resultCompetenceInfo">
	  SELECT RELATE_ID,COMPETENCY_NAME,RANK,AWARD_DATE,EXP_DATE,REVOKE_DATE,AWARD_ORG,ORG_PLACE
	  FROM OPAS_PBOC_PUBLIC_COMPETENCE     
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultAdminAwardInfo" type="java.util.Map">
		<result column="COMPETENCY_NAME" property="competencyName" jdbcType="VARCHAR" />
		<result column="RANK" property="rank" jdbcType="VARCHAR" />
		<result column="AWARD_DATE" property="awardDate" jdbcType="VARCHAR" />
		<result column="EXP_DATE" property="expDate" jdbcType="VARCHAR" />
		<result column="REVOKE_DATE" property="revokeDate" jdbcType="VARCHAR" />
		<result column="AWARD_ORG" property="awardOrg" jdbcType="VARCHAR" />
		<result column="ORG_PLACE" property="orgPlace" jdbcType="VARCHAR" />
		<result column="RELATE_ID" property="relateid" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--行政奖励记录-->
	<select id="queryAdminAwardInfo" parameterType="java.lang.String"
		resultMap="resultAdminAwardInfo">
	  SELECT RELATE_ID,REWARD_ORG,REWARD_CONTENT,EFFECT_DATE,EFFECT_DATE
	  FROM OPAS_PBOC_PUBLIC_ADMINAWARD 
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultQueryRecordInfo" type="java.util.Map">
		<result column="QRY_DATE" property="qryDate" jdbcType="VARCHAR" />
		<result column="QUERY_ORG" property="queryOrg" jdbcType="VARCHAR" />
		<result column="QUERY_ORG_TYPE" property="queryOrgType" jdbcType="VARCHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
	</resultMap>
	
	<!--查询记录-->
	<select id="queryQueryRecordInfo" parameterType="java.lang.String"
		resultMap="resultQueryRecordInfo">
	  SELECT QRY_DATE,QUERY_ORG_TYPE,QUERY_ORG,QRY_REASON FROM OPAS_PBOC_QUERYREC_RECDETAIL 
	  WHERE APP_ID= #{appId,jdbcType=VARCHAR} ORDER BY QRY_DATE DESC
	</select>
	
	<resultMap id="resultOverdueInfo" type="java.util.Map">
		<result column="ACCOUNT_COUNT" property="accountCount" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryOverdueInfo" parameterType="java.lang.String"
		resultMap="resultOverdueInfo">
		SELECT ACCOUNT_COUNT,BALANCE FROM PBOC_BAD_DEBTS_SUM
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	
	<resultMap id="allRecordSummaryMap" type="java.util.Map">
		
		<result column="QUERY_ORG_1M_SUM2" property="sumH" jdbcType="VARCHAR" />
		<result column="QUERY_ORG_1M_SUM3" property="sumC" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM2" property="sumTimeH" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM3" property="sumTimeC" jdbcType="VARCHAR" />
		<result column="QUERY_REC_1M_SUM4" property="sumTimeS" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM1" property="sumM2Y" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM5" property="sumA2Y" jdbcType="VARCHAR" />
		<result column="QUERY_REC_2Y_SUM6" property="sumR2Y" jdbcType="VARCHAR" />
	</resultMap>
<select id="selectPbocAllRecordSummary" parameterType="java.util.Map"
		resultMap="allRecordSummaryMap">
		SELECT
		QUERY_ORG_1M_SUM2,QUERY_ORG_1M_SUM3,
	    QUERY_REC_1M_SUM2,QUERY_REC_1M_SUM3, QUERY_REC_1M_SUM4,
	    QUERY_REC_2Y_SUM1,QUERY_REC_2Y_SUM5, QUERY_REC_2Y_SUM6
		FROM PBOC_QUERYINFO_NEW
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultAssetInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="ASSETS_MANAGE_COMP" property="assetsManageComp"
			jdbcType="VARCHAR" />
		<result column="DEBT_RECE_DATE" property="debtReceDate"
			jdbcType="VARCHAR" />
		<result column="RECE_DEBT_AMT" property="receDebtAmt" jdbcType="VARCHAR" />
		<result column="LATEST_PAYMENT_DATE" property="latestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAssetInfo" parameterType="java.lang.String"
		resultMap="resultAssetInfo">
		SELECT ASSETS_MANAGE_COMP,DEBT_RECE_DATE,
		RECE_DEBT_AMT,LATEST_PAYMENT_DATE,BALANCE
		FROM OPAS_PBOC_ASSETDISPOSITION
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAssureInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="ERAPAY_ORG" property="erapayOrg" jdbcType="VARCHAR" />
		<result column="LATEST_ERAPAY_DATE" property="latestErapayDate"
			jdbcType="VARCHAR" />
		<result column="CUMUL_ERAPAY_AMT" property="cumulErapayAmt"
			jdbcType="VARCHAR" />
		<result column="LATEST_PAYMENT_DATE" property="latestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAssureInfo" parameterType="java.lang.String"
		resultMap="resultAssureInfo">
		SELECT ERAPAY_ORG, LATEST_ERAPAY_DATE,
		CUMUL_ERAPAY_AMT, LATEST_PAYMENT_DATE, BALANCE
		FROM OPAS_PBOC_ASSURERREPAY
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultArrearageInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="TAX_ORG_NAME" property="taxOrgName" jdbcType="VARCHAR" />
		<result column="OUTSTD_TAXES_AMT_SUM" property="outstdTaxesAmtSum"
			jdbcType="VARCHAR" />
		<result column="OUTSTD_TAX_STAT_DT" property="outstdTaxStatDt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryArrearageInfo" parameterType="java.lang.String"
		resultMap="resultArrearageInfo">
		SELECT TAX_ORG_NAME, OUTSTD_TAXES_AMT_SUM,OUTSTD_TAX_STAT_DT
		FROM OPAS_PBOC_PUBLIC_TAXARREAR
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
	</select>



	<resultMap id="resultJudgmentInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="REG_COURT" property="regCourt" jdbcType="VARCHAR" />
		<result column="CASE_REASON" property="caseReason" jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_WAY" property="closeCaseWay"
			jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_RST" property="judgMediateRst"
			jdbcType="VARCHAR" />
		<result column="JUDG_MEDIATE_EFFCT_DT" property="judgMediateEffctDt"
			jdbcType="VARCHAR" />
		<result column="LAW_OBJECT" property="lawObject" jdbcType="VARCHAR" />
		<result column="LAW_OBJECT_AMT" property="lawObjectAmt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryJudgmentInfo" parameterType="java.lang.String"
		resultMap="resultJudgmentInfo">
		SELECT REG_COURT, CASE_REASON,REG_DATE,
		CLOSE_CASE_WAY, JUDG_MEDIATE_RST,
		JUDG_MEDIATE_EFFCT_DT, LAW_OBJECT,
		LAW_OBJECT_AMT
		FROM OPAS_PBOC_PUBLIC_CIVJUDGE
		WHERE APP_ID=#{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultForceInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="EXECUTE_COURT" property="executeCourt"
			jdbcType="VARCHAR" />
		<result column="EXECUTE_CASE_RSN" property="executeCaseRsn"
			jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_WAY" property="closeCaseWay"
			jdbcType="VARCHAR" />
		<result column="CASE_STATUS" property="caseStatus" jdbcType="VARCHAR" />
		<result column="CLOSE_CASE_DATE" property="closeCaseDate"
			jdbcType="VARCHAR" />
		<result column="APPLY_EXE_OBJ" property="applyExeObj" jdbcType="VARCHAR" />
		<result column="APPLY_EXE_OBJ_AMT" property="applyExeObjAmt"
			jdbcType="VARCHAR" />
		<result column="ALREADY_EXE_OBJ" property="alreadyExeObj"
			jdbcType="VARCHAR" />
		<result column="ALREADY_EXE_OBJ_AMT" property="alreadyExeObjAmt"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryForceInfo" parameterType="java.lang.String"
		resultMap="resultForceInfo">
		SELECT EXECUTE_COURT,EXECUTE_CASE_RSN,
		REG_DATE,CLOSE_CASE_WAY, CASE_STATUS,
		CLOSE_CASE_DATE,APPLY_EXE_OBJ,
		APPLY_EXE_OBJ_AMT,ALREADY_EXE_OBJ,ALREADY_EXE_OBJ_AMT
		FROM OPAS_PBOC_PUBLIC_FORCEEXE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultPenaltyInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="PUNISH_ORGANIZ" property="punishOrganiz"
			jdbcType="VARCHAR" />
		<result column="PUNISH_CONTENT" property="punishContent"
			jdbcType="VARCHAR" />
		<result column="PUNISH_AMT" property="punishAmt" jdbcType="VARCHAR" />
		<result column="EFFECT_DATE" property="effectDate" jdbcType="VARCHAR" />
		<result column="END_DATE" property="endDate" jdbcType="VARCHAR" />
		<result column="AD_REVIEW_RESULT" property="adReviewResult"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryPenaltyInfo" parameterType="java.lang.String"
		resultMap="resultPenaltyInfo">
		SELECT PUNISH_ORGANIZ,PUNISH_CONTENT,
		PUNISH_AMT,EFFECT_DATE,END_DATE,AD_REVIEW_RESULT
		FROM OPAS_PBOC_PUBLIC_ADMINPUNISH
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultHousingInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="JOIN_SOCL_INSU_PL" property="joinSoclInsuPl"
			jdbcType="VARCHAR" />
		<result column="JOIN_SOCL_INSU_DT" property="joinSoclInsuDt"
			jdbcType="VARCHAR" />
		<result column="FIRST_DEPOSIT_YM" property="firstDepositYm"
			jdbcType="VARCHAR" />
		<result column="PAY_YM" property="payYm" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="COMP_DEPOSIT_RATE" property="compDepositRate"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryHousingInfo" parameterType="java.lang.String"
		resultMap="resultHousingInfo">
		SELECT
		JOIN_SOCL_INSU_PL, JOIN_SOCL_INSU_DT,
		FIRST_DEPOSIT_YM, PAY_YM, PAY_STATUS,
		MONTHLY_DEPOSIT,PERSON_DEPOSIT_RATE, COMP_DEPOSIT_RATE,
		PAY_COMP, INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_ACCFUND
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
		ORDER BY  INFO_UPD_TIME desc,JOIN_SOCL_INSU_DT desc,PAY_YM desc
	</select>


	<resultMap id="resultPayAnnuityInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="JOIN_SOCL_INSU_PL" property="joinSoclInsuPl"
			jdbcType="VARCHAR" />
		<result column="JOIN_SOCL_INSU_YM" property="joinSoclInsuYm"
			jdbcType="VARCHAR" />
		<result column="CUMUL_PAY_MONTHS" property="cumulPayMonths"
			jdbcType="VARCHAR" />
		<result column="WORK_MONTHS" property="workMonths" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="PERSON_PAY_BASE" property="personPayBase"
			jdbcType="VARCHAR" />
		<result column="CUR_MPAY_AMT" property="curMpayAmt" jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAUSE_PAY_REASON" property="pausePayReason"
			jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>
	<select id="queryPayAnnuityInfo" parameterType="java.lang.String"
		resultMap="resultPayAnnuityInfo">
		SELECT
		JOIN_SOCL_INSU_PL, JOIN_SOCL_INSU_YM,
		CUMUL_PAY_MONTHS, WORK_MONTHS, PAY_STATUS,
		PERSON_PAY_BASE,
		CUR_MPAY_AMT, PAY_COMP,
		PAUSE_PAY_REASON, INFO_UPD_TIME
		FROM
		OPAS_PBOC_PUBLIC_ENINSURDEP
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultGrantAnnuityInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="DISTRIBUTED_AREA" property="distributedArea"
			jdbcType="VARCHAR" />
		<result column="RETIRED_TYPE" property="retiredType" jdbcType="VARCHAR" />
		<result column="RETIRED_DATE" property="retiredDate" jdbcType="VARCHAR" />
		<result column="WORK_MONTHS" property="workMonths" jdbcType="VARCHAR" />
		<result column="CUR_MREAL_PAY_PENS" property="curMrealPayPens"
			jdbcType="VARCHAR" />
		<result column="PAUSE_PAY_REASON" property="pausePayReason"
			jdbcType="VARCHAR" />
		<result column="ORI_COMP_NAME" property="oriCompName" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryGrantAnnuityInfo" parameterType="java.lang.String"
		resultMap="resultGrantAnnuityInfo">
		SELECT DISTRIBUTED_AREA,RETIRED_TYPE,RETIRED_DATE,WORK_MONTHS,CUR_MREAL_PAY_PENS,
		PAUSE_PAY_REASON,ORI_COMP_NAME,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_ENINSURDEL
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultLowHouseholdInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="PERSONNEL_TYPE" property="personnelType"
			jdbcType="VARCHAR" />
		<result column="PLACE" property="place" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="HOME_MINCOME" property="homeMincome" jdbcType="VARCHAR" />
		<result column="APP_DATE" property="appDate" jdbcType="VARCHAR" />
		<result column="PASS_DATE" property="passDate" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryLowHouseholdInfo" parameterType="java.lang.String"
		resultMap="resultLowHouseholdInfo">
		SELECT PERSONNEL_TYPE,PLACE,
		COMPANY,HOME_MINCOME,APP_DATE,
		PASS_DATE,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_SALVATION
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultOccupationInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="COMPETENCY_NAME" property="competencyName"
			jdbcType="VARCHAR" />
		<result column="RANK" property="rank" jdbcType="VARCHAR" />
		<result column="AWARD_DATE" property="awardDate" jdbcType="VARCHAR" />
		<result column="EXP_DATE" property="expDate" jdbcType="VARCHAR" />
		<result column="REVOKE_DATE" property="revokeDate" jdbcType="VARCHAR" />
		<result column="AWARD_ORG" property="awardOrg" jdbcType="VARCHAR" />
		<result column="ORG_PLACE" property="orgPlace" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryOccupationInfo" parameterType="java.lang.String"
		resultMap="resultOccupationInfo">
		SELECT COMPETENCY_NAME,RANK,AWARD_DATE,EXP_DATE,REVOKE_DATE,AWARD_ORG,ORG_PLACE
		FROM OPAS_PBOC_PUBLIC_COMPETENCE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAwardInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="REWARD_ORG" property="rewardOrg" jdbcType="VARCHAR" />
		<result column="REWARD_CONTENT" property="rewardContent"
			jdbcType="VARCHAR" />
		<result column="EFFECT_DATE" property="effectDate" jdbcType="VARCHAR" />
		<result column="END_DATE" property="endDate" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryAwardInfo" parameterType="java.lang.String"
		resultMap="resultAwardInfo">
		SELECT REWARD_ORG,REWARD_CONTENT,EFFECT_DATE,END_DATE
		FROM OPAS_PBOC_PUBLIC_ADMINAWARD
		WHERE APP_ID =#{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultVehicleInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="SEND_ORG_NO" property="sendOrgNo" jdbcType="VARCHAR" />
		<result column="PLATE_NO" property="plateNo" jdbcType="VARCHAR" />
		<result column="BRAND" property="brand" jdbcType="VARCHAR" />
		<result column="CAR_TYPE" property="carType" jdbcType="VARCHAR" />
		<result column="CAR_USE_PROP" property="carUseProp" jdbcType="VARCHAR" />
		<result column="CAR_STATUS" property="carStatus" jdbcType="VARCHAR" />
		<result column="PLEDGE_FLAG" property="pledgeFlag" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryVehicleInfo" parameterType="java.lang.String"
		resultMap="resultVehicleInfo">
		SELECT SEND_ORG_NO,PLATE_NO,BRAND,CAR_TYPE,
		CAR_USE_PROP,CAR_STATUS,PLEDGE_FLAG,INFO_UPD_TIME
		FROM OPAS_PBOC_PUBLIC_VEHICLE
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultTelecomInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="TELECOM_FACILITATOR" property="telecomFacilitator"
			jdbcType="VARCHAR" />
		<result column="BUSI_TYPE" property="busiType" jdbcType="VARCHAR" />
		<result column="BUSI_OPN_DATE" property="busiOpnDate" jdbcType="VARCHAR" />
		<result column="CUR_PAY_STAT" property="curPayStat" jdbcType="VARCHAR" />
		<result column="CUR_DEBT_AMT" property="curDebtAmt" jdbcType="VARCHAR" />
		<result column="CUR_DEBT_MONTHS" property="curDebtMonths"
			jdbcType="VARCHAR" />
		<result column="PREST24MPAY_STAT" property="prest24mpayStat"
			jdbcType="VARCHAR" />
		<result column="TALLY_YM" property="tallyYm" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryTelecomInfo" parameterType="java.lang.String"
		resultMap="resultTelecomInfo">
		SELECT TELECOM_FACILITATOR,BUSI_TYPE,
		BUSI_OPN_DATE,CUR_PAY_STAT,CUR_DEBT_AMT,
		CUR_DEBT_MONTHS,PREST24MPAY_STAT,TALLY_YM
		FROM OPAS_PBOC_PUBLIC_TELPAYMENT
		WHERE APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultAnnounceInfo" type="java.util.Map">
		<result column="CONTENT" property="declareContent"
			jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="addDate" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryAnnounceInfo" parameterType="java.lang.String"
		resultMap="resultAnnounceInfo">
		SELECT CONTENT,ADD_DATE FROM PBOC_POS_LABEL_STATE_INFO WHERE TYPE='3'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>


	<resultMap id="resultDissentInfo" type="java.util.Map">
		<result column="CONTENT" property="declareContent"
			jdbcType="VARCHAR" />
		<result column="ADD_DATE" property="addDate" jdbcType="VARCHAR" />
	</resultMap>

	<select id="queryDissentInfo" parameterType="java.lang.String"
		resultMap="resultDissentInfo">
		SELECT CONTENT,ADD_DATE FROM PBOC_PAH_LABEL_STATE_INFO WHERE TYPE='01'
		AND APP_ID = #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultReCreditInfo" type="java.util.Map">
		<result column="FA_REC_SEQ" property="faRecSeq" jdbcType="CHAR" />
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="QRY_DATE" property="qryDate" jdbcType="VARCHAR" />
		<result column="QRY_OPERATOR" property="qryOperator" jdbcType="VARCHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="QUERY_ORG" property="queryOrg" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryReCreditInfo" parameterType="java.lang.String"
		resultMap="resultReCreditInfo">
		select
		FA_REC_SEQ, INSIDE_APP_NO, QRY_DATE,
		QRY_OPERATOR,
		QRY_REASON, CRT_TIME,
		CRT_USER, LST_UPD_TIME, LST_UPD_USER,
		BATCH_DATE,
		REC_STATUS
		from OPAS_PBOC_QUERYREC_RECDETAIL
		where APP_ID =
		#{appId,jdbcType=VARCHAR}
		order by QRY_DATE desc

	</select>


	<resultMap id="resultCreditGradeInfo" type="java.util.Map">
		<result column="INSIDE_APP_NO" jdbcType="CHAR" property="insideAppNo" />
		<result column="DESC_CONTENT" jdbcType="VARCHAR" property="descContent" />
		<result column="CRT_TIME" jdbcType="VARCHAR" property="crtTime" />
		<result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
		<result column="LST_UPD_TIME" jdbcType="TIMESTAMP" property="lstUpdTime" />
		<result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
		<result column="BATCH_DATE" jdbcType="TIMESTAMP" property="batchDate" />
		<result column="REC_STATUS" jdbcType="CHAR" property="recStatus" />
		<result column="APP_ID" jdbcType="CHAR" property="appId" />
		<result column="NUMBER_READ" jdbcType="VARCHAR" property="numberRead" />
		<result column="OPPOSITE_POSITION" jdbcType="VARCHAR" property="oppositePosition" />
		<result column="COUNT" jdbcType="VARCHAR" property="count" />
		<result column="FL" jdbcType="VARCHAR" property="fl" />
	</resultMap>
<!-- 个信报告数字解读 -->
	<select id="queryCreditGradeInfo" parameterType="java.lang.String"
		resultMap="resultCreditGradeInfo">
		 select s.DESC_CONTENT,c.NUMBER_READ,c.OPPOSITE_POSITION,c.NUMBER_READ||c.OPPOSITE_POSITION FL,
		(select count(a.NUMBER_READ) 
		from OPAS_PBOC_CREDIT_CUE a full join OPAS_PBOC_CREDITSCORE_SCOREELE b on a.APP_ID=b.APP_ID
		where  c.APP_ID = a.APP_ID and c.NUMBER_READ=a.NUMBER_READ and c.OPPOSITE_POSITION=a.OPPOSITE_POSITION  ) COUNT
		from OPAS_PBOC_CREDIT_CUE c full join OPAS_PBOC_CREDITSCORE_SCOREELE s on s.APP_ID=c.APP_ID
		where  c.APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<resultMap id="resultDegreeMap" type="java.util.Map">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="QRY_REASON" property="qryReason" jdbcType="VARCHAR" />
		<result column="SUM" property="sum" jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>

	<select id="queryPaymentInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_ORGSUM
		WHERE
		QRY_REASON='02|贷款审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryCartInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_ORGSUM
		WHERE
		QRY_REASON='03|信用卡审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryPaymentTimeInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='02|贷款审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryCartTimeInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='03|信用卡审批' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="querySelfInfo" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_LM_RECSUM
		WHERE
		QRY_REASON='04|本人查询' AND APP_ID= #{appId,jdbcType=VARCHAR}
	</select>


	<select id="queryManage2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='01|贷后管理' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>

	<select id="queryAssure2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='08|担保资格审查' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>

	<select id="queryRealName2Y" parameterType="java.lang.String"
		resultType="java.lang.String">
		SELECT
		SUM
		FROM OPAS_PBOC_QUERYREC_TY_RECSUM
		WHERE
		QRY_REASON='19|特约商户实名审查' AND APP_ID= #{appId,jdbcType=VARCHAR}

	</select>
	<resultMap id="loanCardInfo" type="com.huaxia.opas.domain.thirdparty.LoanCardInfo">
		<result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
		<result column="BASIC_INFO_PROMPT" property="basicInfoPrompt"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ORG" property="loanOrCreditOrg"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ORG_TYPE" property="loanOrCreditOrgType"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_BUSI_NO" property="loanOrCreditBusiNo"
			jdbcType="VARCHAR" />
		<result column="LOAN_LOAN_TYPE_SEG" property="loanLoanTypeSeg"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CCY" property="loanOrCreditCcy"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate"
			jdbcType="VARCHAR" />
		<result column="LOAN_EXP_DATE" property="loanExpDate" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_GUARANTEE_MODE" property="loanOrCreditGuaranteeMode"
			jdbcType="VARCHAR" />
		<result column="LOAN_PAYMENT_FREQ" property="loanPaymentFreq"
			jdbcType="VARCHAR" />
		<result column="LOAN_PAYMENT_CYC_NUM" property="loanPaymentCycNum"
			jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loanOrCreditAcctStatus"
			jdbcType="VARCHAR" />
		<result column="ACC_STATE_END_DATE" property="accStateEndDate"
			jdbcType="VARCHAR" />
		<result column="ACC_CLASS5STATE" property="accClass5state"
			jdbcType="VARCHAR" />
		<result column="ACC_CORPUS_BAL" property="accCorpusBal"
			jdbcType="VARCHAR" />
		<result column="ACC_REM_PAYMENT_CYC_NUM" property="accRemPaymentCycNum"
			jdbcType="VARCHAR" />
		<result column="ACC_CUR_MDUE_PAY_BAL" property="accCurMduePayBal"
			jdbcType="VARCHAR" />
		<result column="ACC_DUE_PAYMENT_DATE" property="accDuePaymentDate"
			jdbcType="VARCHAR" />
		<result column="ACC_CUR_MREAL_PAY_AMT" property="accCurMrealPayAmt"
			jdbcType="VARCHAR" />
		<result column="ACC_LATEST_PAYMENT_DATE" property="accLatestPaymentDate"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_CUR_OVER_DUE_NUM" property="overDueCurOverDueNum"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_CUR_OVER_DUE_AMT" property="overDueCurOverDueAmt"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR31TO60D" property="overDueUnPayCor31to60d"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR61TO90D" property="overDueUnPayCor61to90d"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR91TO180" property="overDueUnPayCor91to180"
			jdbcType="VARCHAR" />
		<result column="OVER_DUE_UN_PAY_COR180DPLUS" property="overDueUnPayCor180dplus"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_STR_MONTH" property="m24PaymentStrMonth"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_END_MONTH" property="m24PaymentEndMonth"
			jdbcType="VARCHAR" />
		<result column="M24_PAYMENT_STATUS" property="m24PaymentStatus"
			jdbcType="VARCHAR" />
		<result column="M60_OVER_DUE_STR_MONTH" property="m60OverDueStrMonth"
			jdbcType="VARCHAR" />
		<result column="M60_OVER_DUE_END_MONTH" property="m60OverDueEndMonth"
			jdbcType="VARCHAR" />
		<result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
		<result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
		<result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
		<result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
		<result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
		<result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
		<result column="REC_SEQ" property="recSeq" jdbcType="CHAR" />
		<result column="MESS_TYPE" property="messType" jdbcType="CHAR" />
		<result column="DEB_CARD_PAY_OVERDRAFT_AMT" property="debCardPayOverdraftAmt"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_SHARE_LIMIT" property="debCardPayShareLimit"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_6MAVG_USED_AMT" property="debCardPay6mavgUsedAmt"
			jdbcType="VARCHAR" />
		<result column="DEB_CARD_PAY_MAX_USED_BAL" property="debCardPayMaxUsedBal"
			jdbcType="VARCHAR" />
		<result column="APP_ID" property="appId" jdbcType="CHAR" />
	</resultMap>
	<!-- 贷记卡 -->
	<select id="queryloanCardInfoByAppId" parameterType="java.util.Map"
		resultMap="loanCardInfo">
		select * from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
			ORDER BY LOAN_OR_CREDIT_ISSU_DATE desc
		</where>
	</select>
	<select id="selectLoanCardDataByMap" parameterType="java.util.Map"
		resultMap="loanCardInfo">
	  select  BASIC_INFO_PROMPT, LOAN_OR_CREDIT_ORG, 
      LOAN_OR_CREDIT_ORG_TYPE, LOAN_OR_CREDIT_BUSI_NO, 
      LOAN_LOAN_TYPE_SEG, LOAN_OR_CREDIT_CCY, LOAN_OR_CREDIT_ISSU_DATE, 
      LOAN_EXP_DATE, LOAN_OR_CREDIT_CONT_AMT, LOAN_OR_CREDIT_GUARANTEE_MODE, 
      LOAN_PAYMENT_FREQ, LOAN_PAYMENT_CYC_NUM, LOAN_OR_CREDIT_ACCT_STATUS, 
      ACC_STATE_END_DATE, ACC_CLASS5STATE, ACC_CORPUS_BAL, 
      ACC_REM_PAYMENT_CYC_NUM, ACC_CUR_MDUE_PAY_BAL, 
      ACC_DUE_PAYMENT_DATE, ACC_CUR_MREAL_PAY_AMT, ACC_LATEST_PAYMENT_DATE, 
      OVER_DUE_CUR_OVER_DUE_NUM, OVER_DUE_CUR_OVER_DUE_AMT, 
      OVER_DUE_UN_PAY_COR31TO60D, OVER_DUE_UN_PAY_COR61TO90D, 
      OVER_DUE_UN_PAY_COR91TO180, OVER_DUE_UN_PAY_COR180DPLUS, 
      M24_PAYMENT_STR_MONTH, M24_PAYMENT_END_MONTH,
      M24_PAYMENT_STATUS, M60_OVER_DUE_STR_MONTH, M60_OVER_DUE_END_MONTH,
      REC_SEQ, MESS_TYPE, DEB_CARD_PAY_OVERDRAFT_AMT, 
      DEB_CARD_PAY_SHARE_LIMIT, DEB_CARD_PAY_6MAVG_USED_AMT, 
      DEB_CARD_PAY_MAX_USED_BAL, APP_ID from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
			<if test="loanOrCreditAcctStatus != null and loanOrCreditAcctStatus !='' ">
				AND substr(LOAN_OR_CREDIT_ACCT_STATUS,1,1) = #{loanOrCreditAcctStatus}
			</if>
			<if test="loanOrCreditGuaranteeMode != null and loanOrCreditGuaranteeMode =='4'.toString() ">
				AND substr(LOAN_OR_CREDIT_GUARANTEE_MODE,1,1) ='4'
			</if>
			<if test="loanOrCreditGuaranteeMode != null and loanOrCreditGuaranteeMode =='0'.toString() ">
				AND substr(LOAN_OR_CREDIT_GUARANTEE_MODE,1,1) !='4'
			</if>
			<if test="bank != null and bank =='0'.toString() and loanOrCreditOrg != null and loanOrCreditOrg !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${loanOrCreditOrg}%'
			</if>
			<if test="bank != null and bank =='1'.toString() and loanOrCreditOrg != null and loanOrCreditOrg !='' ">
				AND (LOAN_OR_CREDIT_ORG NOT LIKE '%${loanOrCreditOrg}%' OR LOAN_OR_CREDIT_ORG is null)
			</if>
			ORDER BY LOAN_OR_CREDIT_ISSU_DATE asc
		</where>
	</select>
	<select id="queryloanCardInfoById" parameterType="java.lang.String"
		resultMap="loanCardInfo">
		select * from OPAS_PBOC_LOAN_CARD_INFO
		where REC_SEQ =
		#{recSeq,jdbcType=CHAR}
	</select>
	<resultMap id="last5yearOverdue" type="com.huaxia.opas.domain.thirdparty.last5yearOverdue" >
	    <result column="FA_REC_SEQ" property="faRecSeq" jdbcType="CHAR" />
	    <result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
	    <result column="MSG_TYPE" property="msgType" jdbcType="CHAR" />
	    <result column="MONTH" property="month" jdbcType="VARCHAR" />
	    <result column="LAST_MONTHS_STR" property="lastMonthsStr" jdbcType="VARCHAR" />
	    <result column="AMT" property="amt" jdbcType="VARCHAR" />
	    <result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
	    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
	    <result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
	    <result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
	    <result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
	    <result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
	    <result column="APP_ID" property="appId" jdbcType="CHAR" />
  	</resultMap>
  	<select id="querylast5yearOverdue" parameterType="java.util.Map"
		resultMap="last5yearOverdue">
		SELECT MONTH,LAST_MONTHS_STR,AMT
		FROM OPAS_PBOC_LAST5YEAR_OVERDUE
		<where>
		    <if test="appId != null and appId !='' ">
				AND APP_ID = #{appId}
			</if>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq} ORDER BY MONTH desc
			</if>
		</where>
	</select>
	<select id="querylast5yearOverdueCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		select count(1) from OPAS_PBOC_LAST5YEAR_OVERDUE
		<where>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq}
			</if>
		</where>
	</select>
	<resultMap id="scBzkMyBankLoanMap" type="java.util.Map" >
	    <result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate" jdbcType="VARCHAR" />
	    <result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt" jdbcType="VARCHAR" />
	    <result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loanOrCreditAcctStatus" jdbcType="VARCHAR" />
  	</resultMap>
	<select id="selectScBzkMyBankLoanCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		select count(*) from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="myBank != null and myBank !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${myBank}%'
			</if>
			<if test="appId != null and appId !='' ">
				AND APP_ID =#{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
		</where>
	</select>
	<select id="selectScBzkMyBankLoanList" parameterType="java.util.Map"
		resultMap="scBzkMyBankLoanMap">
		select LOAN_OR_CREDIT_ISSU_DATE,LOAN_OR_CREDIT_CONT_AMT,LOAN_OR_CREDIT_ACCT_STATUS from OPAS_PBOC_LOAN_CARD_INFO
		<where>
			<if test="myBank != null and myBank !='' ">
				AND LOAN_OR_CREDIT_ORG LIKE '%${myBank}%'
			</if>
			<if test="appId != null and appId !='' ">
				AND APP_ID =#{appId}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
		</where>
		ORDER BY LOAN_OR_CREDIT_ISSU_DATE desc
	</select>
	<resultMap id="Grurantee" type="com.huaxia.opas.domain.thirdparty.Grurantee" >
    <result column="INSIDE_APP_NO" property="insideAppNo" jdbcType="CHAR" />
    <result column="GUARANTEE_TYPE" property="guaranteeType" jdbcType="VARCHAR" />
    <result column="SEC_LOAN_OR_CREDIT_ISS_ORG" property="secLoanOrCreditIssOrg" jdbcType="VARCHAR" />
    <result column="LOAN_CON_AMT" property="loanConAmt" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_GRANT_DATE" property="guarLoanGrantDate" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_GRANT_EXP_DT" property="guarLoanGrantExpDt" jdbcType="VARCHAR" />
    <result column="GUARANTEE_AMT" property="guaranteeAmt" jdbcType="VARCHAR" />
    <result column="LOAN_AMT" property="loanAmt" jdbcType="VARCHAR" />
    <result column="GUAR_LOAN_SORT5" property="guarLoanSort5" jdbcType="VARCHAR" />
    <result column="DUE_PAYMENT_DATE" property="duePaymentDate" jdbcType="VARCHAR" />
    <result column="CRT_TIME" property="crtTime" jdbcType="VARCHAR" />
    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
    <result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
    <result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
    <result column="BATCH_DATE" property="batchDate" jdbcType="TIMESTAMP" />
    <result column="REC_STATUS" property="recStatus" jdbcType="CHAR" />
    <result column="APP_ID" property="appId" jdbcType="CHAR" />
  </resultMap>
  <select id="queryGruranteeByAppId" parameterType="java.util.Map"
		resultMap="Grurantee">
	  SELECT  GUARANTEE_TYPE,SEC_LOAN_OR_CREDIT_ISS_ORG, 
      LOAN_CON_AMT, GUAR_LOAN_GRANT_DATE, GUAR_LOAN_GRANT_EXP_DT, 
      GUARANTEE_AMT, LOAN_AMT, GUAR_LOAN_SORT5,
      DUE_PAYMENT_DATE FROM OPAS_PBOC_GRURANTEE
	 <where>
		<if test="appId != null and appId !='' ">
			AND APP_ID = #{appId}
		</if>
		<if test="guaranteeType != null and guaranteeType !='' ">
			AND substr(GUARANTEE_TYPE,1,1) = #{guaranteeType}
		</if>
	 </where>
	</select> 
	<resultMap id="resultBankMessageMap" type="java.util.Map">
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="cCompPhone" jdbcType="VARCHAR" />
		<result column="RESI_TEL" property="resiTel" jdbcType="VARCHAR" />
		<result column="COMMUNICATION_ADDR" property="communicationAddr"
			jdbcType="VARCHAR" />
		<result column="QUERY_REQ_TIME" property="queryReqTime"
			jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="FRS_CRED_CRD_ISSUE_MON" property="frsCredCrdIssueMon"
			jdbcType="VARCHAR" />
		<result column="PAY_COMP" property="payComp" jdbcType="VARCHAR" />
		<result column="PAY_STATUS" property="payStatus" jdbcType="VARCHAR" />
		<result column="INFO_UPD_TIME" property="infoUpdTime" jdbcType="VARCHAR" />
		<result column="MONTHLY_DEPOSIT" property="monthlyDeposit"
			jdbcType="VARCHAR" />
		<result column="PERSON_DEPOSIT_RATE" property="personDepositRate"
			jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	<select id="selectListPbocInfoPersonBankMessage" parameterType="java.lang.String"
		resultMap="resultBankMessageMap">
		SELECT a.cell_phone,a.c_comp_phone,a.resi_tel,b.company,b.comp_addr,c.resident_addr, b.INFO_UPD_TIME 
		FROM OPAS_PBOC_PERSONAL_INFO a left join  OPAS_PBOC_PROFESSION_INFO b on  a.app_id = b.app_id left join  
		(select d.resident_addr,d.app_id from ( select e.resident_addr,e.app_id from OPAS_PBOC_RESIDENCE_INFO e where e.app_id = #{appId,jdbcType=VARCHAR} order by e.INFO_UPD_TIME desc)d 
        where rownum=1)c on  a.app_id =c.app_id WHERE  a.app_id = #{appId,jdbcType=VARCHAR} 
		ORDER BY a.LST_UPD_TIME  desc,b.INFO_UPD_TIME desc
	</select>
	
	<resultMap id="resultMonthAvePay" type="java.util.Map">
		<result column="OUTSTAND_LOANS_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="outstandLoans6monthAvePay" />
		<result column="NO_PD_CARD_BANK_MAX_CREDIT_LIM" jdbcType="VARCHAR"
			property="noPdCardBankMaxCreditLim" />
		<result column="NO_PD_CARD_6MONTH_AVE_PAY" jdbcType="VARCHAR"
			property="noPdCard6monthAvePay" />
	</resultMap>
	<select id="queryMonthAvePayById" parameterType="java.lang.String"
		resultMap="resultMonthAvePay">
		select NO_PD_CARD_BANK_MAX_CREDIT_LIM
		from OPAS_PBOC_SHAREANDDEBT_INFO 
		where APP_ID = #{appId,jdbcType=VARCHAR} AND ROWNUM &lt; 2 order by NO_PD_CARD_BANK_MAX_CREDIT_LIM desc
	</select>
	
	<select id="queryOriCompName" parameterType="java.lang.String"
		resultMap="resultGrantAnnuityInfo">
		select
		ORI_COMP_NAME
		from OPAS_PBOC_PUBLIC_ENINSURDEL
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="resultLoanNoInfo" type="java.util.Map">
	    <result column="FRS_CRED_CRD_ISSUE_MON" jdbcType="VARCHAR" property="frsCredCrdIssueMon" />
	</resultMap>
	
	<select id="queryloanTypeById" parameterType="java.lang.String"
		resultMap="resultLoanNoInfo">
		select
		FRS_CRED_CRD_ISSUE_MON
		from OPAS_PBOC_CREDIT_CUE
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<select id="quertLoanSituation" parameterType="java.lang.String"
		resultType="java.util.Map">
		select (to_number(CREDIT_CARD_ACCT_NUM) + to_number(PERSON_HOU_LOAN_NO)
                +to_number(PERSON_COM_HOU_LOAN_NO) + to_number(OTHER_LOAN_NUM) )as count
        from OPAS_PBOC_CREDIT_CUE
		where APP_ID = #{appId,jdbcType=VARCHAR}
	</select>
	
	<resultMap id="loanTypeInfo" type="java.util.Map">
		<result column="LOAN_LOAN_TYPE_SEG" property="loanLoanTypeSeg" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ISSU_DATE" property="loanOrCreditIssuDate" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_CONT_AMT" property="loanOrCreditContAmt" jdbcType="VARCHAR" />
		<result column="ACC_CUR_MDUE_PAY_BAL" property="accCurMduePayBal" jdbcType="VARCHAR" />
		<result column="LOAN_OR_CREDIT_ACCT_STATUS" property="loadOrCreditAcctStatus" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="quertPbocLoadCardInfo" parameterType="java.lang.String"
		resultMap="loanTypeInfo">
		select * from  
  		(select distinct b.LOAN_OR_CREDIT_CONT_AMT,b.app_id,b.LOAN_LOAN_TYPE_SEG,b.LOAN_OR_CREDIT_ISSU_DATE,
  	 	b.MESS_TYPE, b.ACC_CUR_MDUE_PAY_BAL, b.LOAN_OR_CREDIT_ACCT_STATUS,
		SUBSTR(b.LOAN_OR_CREDIT_ACCT_STATUS,0,1) AS ACC_STATUS,
		SUBSTR(b.LOAN_LOAN_TYPE_SEG,0,2) AS TYPE_SEG
		from OPAS_PBOC_LOAN_CARD_INFO b )e
		where e.APP_ID = #{appId,jdbcType=VARCHAR} AND e.MESS_TYPE= '01' AND e.ACC_STATUS != '5' AND ROWNUM &lt; 4
		order by e.ACC_STATUS asc,e.TYPE_SEG asc,e.LOAN_OR_CREDIT_ISSU_DATE desc
	</select>
	<resultMap id="loanSpecialDeal" type="java.util.Map">
	<result column="FA_REC_SEQ" jdbcType="CHAR" property="faRecSeq" />
    <result column="MESS_TYPE" jdbcType="CHAR" property="messType" />
    <result column="INSIDE_APP_NO" jdbcType="CHAR" property="insideAppNo" />
    <result column="TYPE" jdbcType="VARCHAR" property="type" />
    <result column="OCCUR_DATE" jdbcType="VARCHAR" property="occurDate" />
    <result column="CHANGING_MONTHS" jdbcType="VARCHAR" property="changingMonths" />
    <result column="OCCUR_AMT" jdbcType="VARCHAR" property="occurAmt" />
    <result column="DETAIL_REC" jdbcType="VARCHAR" property="detailRec" />
    <result column="CRT_TIME" jdbcType="VARCHAR" property="crtTime" />
    <result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
    <result column="LST_UPD_TIME" jdbcType="VARCHAR" property="lstUpdTime" />
    <result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
    <result column="BATCH_DATE" jdbcType="VARCHAR" property="batchDate" />
    <result column="REC_STATUS" jdbcType="CHAR" property="recStatus" />
    <result column="APP_ID" jdbcType="CHAR" property="appId" />
	</resultMap>
	<select id="selectLoanSpecialDealByMap" parameterType="java.util.Map"
		resultMap="loanSpecialDeal">
	  SELECT TYPE,OCCUR_DATE, CHANGING_MONTHS, 
      OCCUR_AMT, DETAIL_REC FROM  OPAS_PBOC_LOAN_CARD_SPETRAD
      WHERE APP_ID = #{appId} AND FA_REC_SEQ = #{faRecSeq} AND MESS_TYPE = #{messType}
	  ORDER BY LST_UPD_TIME asc
	</select>
	<select id="selectLoanSpecialDealCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		 SELECT count(*) FROM  OPAS_PBOC_LOAN_CARD_SPETRAD
      <where>
			<if test="faRecSeq != null and faRecSeq !='' ">
				AND FA_REC_SEQ = #{faRecSeq}
			</if>
			<if test="messType != null and messType !='' ">
				AND MESS_TYPE = #{messType}
			</if>
	  </where>
	</select>
	
	<resultMap id="queryPbocCompanyAndAddressByAppIdResult" type="java.util.Map">
		<result column="APP_ID" property="appId" jdbcType="VARCHAR" />
		<result column="COMPANY" property="company" jdbcType="VARCHAR" />
		<result column="COMP_ADDR" property="compAddr" jdbcType="VARCHAR" />
		<result column="C_COMP_PHONE" property="ccompPhone" jdbcType="VARCHAR" />
		<result column="CELL_PHONE" property="cellPhone" jdbcType="VARCHAR" />
		<result column="RESIDENT_ADDR" property="residentAddr" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="queryPbocCompanyAndAddressByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
					select APP_ID,COMPANY, COMP_ADDR
		  from OPAS_PBOC_PROFESSION_INFO
		 where app_id = #{appId,jdbcType=VARCHAR}
		 order by info_upd_time desc
	</select>
	
	<select id="queryCompPhoneByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
				 select APP_ID, C_COMP_PHONE,CELL_PHONE
  			 from OPAS_PBOC_PERSONAL_INFO
 			 where app_id = #{appId,jdbcType=VARCHAR}
	</select>
	<select id="queryResidentAddrByAppId" parameterType="java.lang.String"
		resultMap="queryPbocCompanyAndAddressByAppIdResult">
			 select APP_ID,RESIDENT_ADDR
         from OPAS_PBOC_RESIDENCE_INFO
        where app_id = #{appId,jdbcType=VARCHAR}
        order by INFO_UPD_TIME desc
	</select>
	<select id="queryMonthApplyCount" parameterType="java.lang.String"
		resultType="java.lang.Integer">
		select QUERY_ORG_1M_SUM3 from (select nvl(max(s.QUERY_ORG_1M_SUM3),0) as QUERY_ORG_1M_SUM3
		from PBOC_QUERYINFO_NEW s where s.app_id = #{appId,jdbcType=VARCHAR}
		order by crt_time desc )
		where rownum=1
	</select>
	<select id="queryNowOrOverdueCount" parameterType="java.lang.String"
		resultType="java.lang.Integer">
			select greatest((select OVER_DUE_CUR_OVER_DUE_AMT
                  from (select nvl(max(to_number(OVER_DUE_CUR_OVER_DUE_AMT)),0) as OVER_DUE_CUR_OVER_DUE_AMT
                          from OPAS_PBOC_LOAN_CARD_INFO
                         where app_id = #{appId,jdbcType=VARCHAR}
                           and OVER_DUE_CUR_OVER_DUE_AMT is not null
                         order by OVER_DUE_CUR_OVER_DUE_AMT desc)
                 where rownum = 1),
                (select AMT
                   from (select nvl(max(to_number(amt)),0) as amt
                           from OPAS_PBOC_LAST5YEAR_OVERDUE
                          where AMT is not null
                            and app_id = #{appId,jdbcType=VARCHAR}
                          order by amt desc)
                  where rownum = 1)) as max
 			 from dual

	</select>
	<select id="selectCountPbocPersonInfoByAppId" parameterType="java.lang.String" resultType="java.lang.Integer">
		select count(*) from  opas_pboc_personal_info
		WHERE APP_ID= #{appId,jdbcType=VARCHAR}
	</select>

	<select id="queryLoanAccountsNum" parameterType="java.lang.String" resultType="java.lang.String">
	   select count(a.account_type) from PBOC_DEBIT_CREDIT_BASIC_INFO 
	   a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b on a.RELATE_ID=b.RELATE_ID
	   left join PBOC_DEBIT_CREDIT_NEAREST_M c on a.RELATE_ID=c.RELATE_ID
	    where  a.account_type='R2' and (b.account_status not in ('4') or c.account_status not in ('4'))
	   and a.app_id = #{appId,jdbcType=VARCHAR} 
	</select>
	<select id="queryLoanAccountsNum1" parameterType="java.lang.String" resultType="java.lang.String">
	 select  s1+s2 from ( select count(a.account_type) s1,#{appId,jdbcType=VARCHAR} appid  from PBOC_DEBIT_CREDIT_BASIC_INFO 
	   a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b on a.RELATE_ID=b.RELATE_ID
	   left join PBOC_DEBIT_CREDIT_NEAREST_M c on a.RELATE_ID=c.RELATE_ID
	    where  a.account_type='D1' and (b.account_status not in ('5','3') or c.account_status not in ('5','3'))
	   and a.app_id = #{appId,jdbcType=VARCHAR}  ) t1 left join
     ( select count(a.account_type) s2 ,#{appId,jdbcType=VARCHAR} appid  from PBOC_DEBIT_CREDIT_BASIC_INFO 
	   a left join PBOC_DEBIT_CREDIT_NEWST_SHOW b on a.RELATE_ID=b.RELATE_ID
	   left join PBOC_DEBIT_CREDIT_NEAREST_M c on a.RELATE_ID=c.RELATE_ID
	    where  a.account_type in ('R1','R4') and (b.account_status not in ('3') or c.account_status not in ('3'))
	   and a.app_id = #{appId,jdbcType=VARCHAR}  ) t2 on t1.appid =t2.appid
	</select>
<resultMap id="resultQueryDezx4Person" type="java.util.Map">
	    <result column="RELATE_ID" property="relateId" jdbcType="VARCHAR" />
		<result column="ACCOUNT_TYPE" property="accountType" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_CODE" property="servManageOrganCode" jdbcType="VARCHAR" />
		<result column="SERV_TYPE" property="servType" jdbcType="VARCHAR" />
		<result column="KL_DATE" property="klDate" jdbcType="VARCHAR" />
		<result column="BORROW_MONEY" property="borrowMoney" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS_B" property="accountStatusb" jdbcType="VARCHAR" />
		<result column="ACCOUNT_STATUS_D" property="accountStatusd" jdbcType="VARCHAR" />
		<result column="BALANCE" property="balance" jdbcType="VARCHAR" />
		<result column="CHANGING_MONTHS" property="changinMonths" jdbcType="VARCHAR" />
		<result column="CURRENCY" property="currency" jdbcType="VARCHAR" />
		<result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" />
		<result column="ACCO_CREDIT_LIMIT" property="accoCreditLimit" jdbcType="VARCHAR" />
		<result column="SERV_MANAGE_ORGAN_TYPE" property="servManageOrganType" jdbcType="VARCHAR" />
		
	</resultMap>
	<select id="queryDezx4Person" parameterType="java.lang.String"
		resultMap="resultQueryDezx4Person">
	 SELECT  'B10811000H0001' SERV_MANAGE_ORGAN_TYPE,A.ACCO_CREDIT_LIMIT, A.ACCOUNT_TYPE, A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,
	    B.ACCOUNT_STATUS ACCOUNT_STATUS_B,D.ACCOUNT_STATUS ACCOUNT_STATUS_D
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID 
	    WHERE A.SERV_MANAGE_ORGAN_CODE='B10811000H0001' AND  A.ACCOUNT_TYPE IN ('R1','R4','D1') AND A.SERV_TYPE NOT IN   ('31','51')  AND A.APP_ID= #{appId,jdbcType=VARCHAR}
	    ORDER BY A.SERV_TYPE ASC
	</select>
	
	<select id="queryDezx4PersonOther" parameterType="java.lang.String"
		resultMap="resultQueryDezx4Person">
	  SELECT  A.SERV_MANAGE_ORGAN_TYPE,A.SERV_MANAGE_ORGAN_CODE,A.ACCO_CREDIT_LIMIT, A.ACCOUNT_TYPE, A.SERV_MANAGE_ORGAN_CODE,A.SERV_TYPE,A.KL_DATE,A.BORROW_MONEY,
	   B.ACCOUNT_STATUS ACCOUNT_STATUS_B,D.ACCOUNT_STATUS ACCOUNT_STATUS_D
	    FROM PBOC_DEBIT_CREDIT_BASIC_INFO A
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEWST_SHOW B ON A.RELATE_ID=B.RELATE_ID
	    LEFT JOIN PBOC_DEBIT_CREDIT_NEAREST_M D ON A.RELATE_ID=D.RELATE_ID 
	    WHERE A.SERV_MANAGE_ORGAN_CODE <![CDATA[<>]]> 'B10811000H0001' AND  A.ACCOUNT_TYPE IN ('R1','R4','D1') AND A.SERV_TYPE NOT IN   ('31','51')  AND A.APP_ID= #{appId,jdbcType=VARCHAR}
	    ORDER BY A.SERV_TYPE ASC
	</select>
</mapper>
