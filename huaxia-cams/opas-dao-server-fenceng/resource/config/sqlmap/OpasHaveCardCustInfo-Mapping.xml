<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="OpasHaveCardCustInfoMapper">
  <resultMap id="custResultMap_3002" type="java.util.Map" >
		 <id column="ID" jdbcType="CHAR" property="id" />
		    <result column="TRXTYPE" jdbcType="DECIMAL" property="trxtype" />
		    <result column="RETCODE" jdbcType="VARCHAR" property="retcode" />
		    <result column="BNKNBR" jdbcType="DECIMAL" property="bnknbr" />
		    <result column="SOURCE" jdbcType="VARCHAR" property="source" />
		    <result column="BRN_NO" jdbcType="DECIMAL" property="brnNo" />
		    <result column="OPE_NO" jdbcType="DECIMAL" property="opeNo" />
		    <result column="SEQNO" jdbcType="DECIMAL" property="seqno" />
		    <result column="CARDNBR" jdbcType="VARCHAR" property="cardnbr" />
		    <result column="OPTION1" jdbcType="VARCHAR" property="option1" />
		    <result column="KEYTYPE" jdbcType="VARCHAR" property="keytype" />
		    <result column="CUSTID" jdbcType="VARCHAR" property="custid" />
		    <result column="CHINAME" jdbcType="VARCHAR" property="chiname" />
		    <result column="ENGNAME" jdbcType="VARCHAR" property="engname" />
		    <result column="GENDER" jdbcType="VARCHAR" property="gender" />
		    <result column="NATION" jdbcType="VARCHAR" property="nation" />
		    <result column="MARRIED" jdbcType="VARCHAR" property="married" />
		    <result column="EDUCATION" jdbcType="VARCHAR" property="education" />
		    <result column="JOBPOSIT" jdbcType="VARCHAR" property="jobposit" />
		    <result column="HOMEPHONE" jdbcType="VARCHAR" property="homephone" />
		    <result column="BUSIPHONE" jdbcType="VARCHAR" property="busiphone" />
		    <result column="BUSIEXT" jdbcType="VARCHAR" property="busiext" />
		    <result column="MOBILEPHONE" jdbcType="VARCHAR" property="mobilephone" />
		    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
		    <result column="FAXNO" jdbcType="VARCHAR" property="faxno" />
		    <result column="RESIDEYES" jdbcType="DECIMAL" property="resideyes" />
		    <result column="RESIDESTS" jdbcType="VARCHAR" property="residests" />
		    <result column="BUSINAME" jdbcType="VARCHAR" property="businame" />
		    <result column="DEPT" jdbcType="VARCHAR" property="dept" />
		    <result column="TECTITLE" jdbcType="VARCHAR" property="tectitle" />
		    <result column="TRADE" jdbcType="VARCHAR" property="trade" />
		    <result column="BUSITYPE" jdbcType="VARCHAR" property="busitype" />
		    <result column="JOBYES" jdbcType="DECIMAL" property="jobyes" />
		    <result column="EARNING" jdbcType="DECIMAL" property="earning" />
		    <result column="SPOUSERN" jdbcType="DECIMAL" property="spousern" />
		    <result column="RESERVE_QUESTION" jdbcType="VARCHAR" property="reserveQuestion" />
		    <result column="RESERVE_ANSWER" jdbcType="VARCHAR" property="reserveAnswer" />
		    <result column="CUSRT_CRED" jdbcType="DECIMAL" property="cusrtCred" />
		    <result column="CUSTR_CREDX" jdbcType="DECIMAL" property="custrCredx" />
		    <result column="MP_CRED" jdbcType="DECIMAL" property="mpCred" />
		    <result column="CRED_AVAL" jdbcType="DECIMAL" property="credAval" />
		    <result column="CASH_AVAL" jdbcType="DECIMAL" property="cashAval" />
		    <result column="LAYCODE1" jdbcType="VARCHAR" property="laycode1" />
		    <result column="LAYCODE2" jdbcType="VARCHAR" property="laycode2" />
		    <result column="FORECOMP" jdbcType="VARCHAR" property="forecomp" />
		    <result column="FJOBTIME" jdbcType="TIMESTAMP" property="fjobtime" />
		    <result column="BIRTHDAY" jdbcType="TIMESTAMP" property="birthday" />
		    <result column="PIN_SET" jdbcType="DECIMAL" property="pinSet" />
		    <result column="CUSTR_REF" jdbcType="VARCHAR" property="custrRef" />
		    <result column="CALMT" jdbcType="DECIMAL" property="calmt" />
		    <result column="HTEL_AREA" jdbcType="DECIMAL" property="htelArea" />
		    <result column="REVS" jdbcType="VARCHAR" property="revs" />
		    <result column="CON_NAME1" jdbcType="VARCHAR" property="conName1" />
		    <result column="CON_TEL1" jdbcType="VARCHAR" property="conTel1" />
		    <result column="CON_NAME2" jdbcType="VARCHAR" property="conName2" />
		    <result column="CON_TEL2" jdbcType="VARCHAR" property="conTel2" />
		    <result column="MAFLAG" jdbcType="VARCHAR" property="maflag" />
		    <result column="IDNO" jdbcType="VARCHAR" property="idno" />
		    <result column="NAME" jdbcType="VARCHAR" property="name" />
		    <result column="SMSYN" jdbcType="VARCHAR" property="smsyn" />
		    <result column="ID_DTE" jdbcType="TIMESTAMP" property="idDte" />
		    <result column="MAIL_CODE" jdbcType="VARCHAR" property="mailCode" />
		    <result column="NATION_CD" jdbcType="VARCHAR" property="nationCd" />
		    <result column="ID_ISSDT" jdbcType="TIMESTAMP" property="idIssdt" />
		    <result column="ISSDEPT_CD" jdbcType="VARCHAR" property="issdeptCd" />
		    <result column="CRED_AVALX" jdbcType="DECIMAL" property="credAvalx" />
		    <result column="CASH_AVALX" jdbcType="DECIMAL" property="cashAvalx" />
		    <result column="BUSINAME2" jdbcType="VARCHAR" property="businame2" />
		    <result column="LAYCODE3" jdbcType="VARCHAR" property="laycode3" />
		    <result column="CLASS_CODE" jdbcType="VARCHAR" property="classCode" />
		    <result column="ISSDEPT_IF" jdbcType="VARCHAR" property="issdeptIf" />
		    <result column="FOREDEPT" jdbcType="VARCHAR" property="foredept" />
		    <result column="QQ_NBR" jdbcType="VARCHAR" property="qqNbr" />
		    <result column="WX_NBR" jdbcType="VARCHAR" property="wxNbr" />
		    <result column="SUM_CRED" jdbcType="DECIMAL" property="sumCred" />
		    <result column="SUM_MPLMT" jdbcType="DECIMAL" property="sumMplmt" />
		    <result column="SUM_MLLMT" jdbcType="DECIMAL" property="sumMllmt" />
		    <result column="POI_CODE" jdbcType="VARCHAR" property="poiCode" />
		    <result column="EMAIL_IN" jdbcType="VARCHAR" property="emailIn" />
		    <result column="SIGN_FLAG" jdbcType="VARCHAR" property="signFlag" />
		    <result column="SCHLNM_CH" jdbcType="VARCHAR" property="schlnmCh" />
		    <result column="SCHLNM_EN" jdbcType="VARCHAR" property="schlnmEn" />
		    <result column="ENROLL_DATE" jdbcType="DECIMAL" property="enrollDate" />
		    <result column="GRADU_DATE" jdbcType="DECIMAL" property="graduDate" />
		    <result column="LAYCODE4" jdbcType="VARCHAR" property="laycode4" />
		    <result column="RL_VAL" jdbcType="VARCHAR" property="rlVal" />
		    <result column="CU_AVAL2" jdbcType="DECIMAL" property="cuAval2" />
		    <result column="CU_CASH_AVAL2" jdbcType="DECIMAL" property="cuCashAval2" />
		    <result column="RESERVED" jdbcType="VARCHAR" property="reserved" />
		    <result column="CRT_TIME" jdbcType="TIMESTAMP" property="crtTime" />
		    <result column="CRT_DATE" jdbcType="TIMESTAMP" property="crtDate" />
		    <result column="CRT_USER" jdbcType="VARCHAR" property="crtUser" />
		    <result column="LST_UPD_TIME" jdbcType="TIMESTAMP" property="lstUpdTime" />
		    <result column="LST_UPD_DATE" jdbcType="TIMESTAMP" property="lstUpdDate" />
		    <result column="LST_UPD_USER" jdbcType="VARCHAR" property="lstUpdUser" />
		    <result column="APP_ID" jdbcType="VARCHAR" property="appId" />
		    
		    <result column="BILL_ADDR" jdbcType="VARCHAR" property="billAddr" />
		    <result column="ADD_TYPE" jdbcType="VARCHAR" property="addType" />
		    <result column="cardStat_ydj" jdbcType="VARCHAR" property="cardStat_ydj" />
		    <result column="cardStat_bzk" jdbcType="VARCHAR" property="cardStat_bzk" />
		    <result column="limit_ydj" jdbcType="VARCHAR" property="limit_ydj" />
		    <result column="limit_bzk" jdbcType="VARCHAR" property="limit_bzk" />
		    <result column="C1C2_FLAG" jdbcType="VARCHAR" property="c1c2_flag" />
  </resultMap>
  <resultMap id="cardResultMap_3118" type="java.util.Map" >
  		<id column="ID" property="id" jdbcType="CHAR" />
	    <result column="TRXTYPE" property="trxtype" jdbcType="DECIMAL" />
	    <result column="RETCODE" property="retcode" jdbcType="VARCHAR" />
	    <result column="BNKNBR" property="bnknbr" jdbcType="DECIMAL" />
	    <result column="SOURCE" property="source" jdbcType="VARCHAR" />
	    <result column="BRN_NO" property="brnNo" jdbcType="DECIMAL" />
	    <result column="OPE_NO" property="opeNo" jdbcType="DECIMAL" />
	    <result column="SEQNO" property="seqno" jdbcType="DECIMAL" />
	    <result column="KEYTYPE" property="keytype" jdbcType="VARCHAR" />
	    <result column="CUSTID" property="custid" jdbcType="VARCHAR" />
	    <result column="INSFLAG" property="insflag" jdbcType="VARCHAR" />
	    <result column="INSCARD" property="inscard" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME" property="custrName" jdbcType="VARCHAR" />
	    <result column="COUNT" property="count" jdbcType="DECIMAL" />
	    <result column="RTN_IND" property="rtnInd" jdbcType="VARCHAR" />
	    <result column="CARDNBR1" property="cardnbr1" jdbcType="VARCHAR" />
	    <result column="PRODUCT1" property="product1" jdbcType="DECIMAL" />
	    <result column="PROD_LEVEL1" property="prodLevel1" jdbcType="DECIMAL" />
	    <result column="CATEGORY1" property="category1" jdbcType="DECIMAL" />
	    <result column="EXPIRE1" property="expire1" jdbcType="VARCHAR" />
	    <result column="MAFLAG1" property="maflag1" jdbcType="VARCHAR" />
	    <result column="OPENDATE1" property="opendate1" jdbcType="TIMESTAMP" />
	    <result column="PBFLAG1" property="pbflag1" jdbcType="VARCHAR" />
	    <result column="BUSI_NAME1" property="busiName1" jdbcType="VARCHAR" />
	    <result column="CARDSTAT1" property="cardstat1" jdbcType="VARCHAR" />
	    <result column="FEETYPE1" property="feetype1" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME1" property="custrName1" jdbcType="VARCHAR" />
	    <result column="ACTIVDAY1" property="activday1" jdbcType="TIMESTAMP" />
	    <result column="APP_SOUCE1" property="appSouce1" jdbcType="VARCHAR" />
	    <result column="MAST_CARD1" property="mastCard1" jdbcType="VARCHAR" />
	    <result column="ACCT_PDLV1" property="acctPdlv1" jdbcType="DECIMAL" />
	    <result column="VCN_STS1" property="vcnSts1" jdbcType="VARCHAR" />
	    <result column="ISS_MOD1" property="issMod1" jdbcType="VARCHAR" />
	    <result column="CLOSE_CODE1" property="closeCode1" jdbcType="VARCHAR" />
	    <result column="CDFRM1" property="cdfrm1" jdbcType="VARCHAR" />
	    <result column="CRED_LMT1" property="credLmt1" jdbcType="DECIMAL" />
	    <result column="REVS1" property="revs1" jdbcType="VARCHAR" />
	    <result column="CARDNBR2" property="cardnbr2" jdbcType="VARCHAR" />
	    <result column="PRODUCT2" property="product2" jdbcType="DECIMAL" />
	    <result column="PROD_LEVEL2" property="prodLevel2" jdbcType="DECIMAL" />
	    <result column="CATEGORY2" property="category2" jdbcType="DECIMAL" />
	    <result column="EXPIRE2" property="expire2" jdbcType="VARCHAR" />
	    <result column="MAFLAG2" property="maflag2" jdbcType="VARCHAR" />
	    <result column="OPENDATE2" property="opendate2" jdbcType="TIMESTAMP" />
	    <result column="PBFLAG2" property="pbflag2" jdbcType="VARCHAR" />
	    <result column="BUSI_NAME2" property="busiName2" jdbcType="VARCHAR" />
	    <result column="CARDSTAT2" property="cardstat2" jdbcType="VARCHAR" />
	    <result column="FEETYPE2" property="feetype2" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME2" property="custrName2" jdbcType="VARCHAR" />
	    <result column="ACTIVDAY2" property="activday2" jdbcType="TIMESTAMP" />
	    <result column="APP_SOUCE2" property="appSouce2" jdbcType="VARCHAR" />
	    <result column="MAST_CARD2" property="mastCard2" jdbcType="VARCHAR" />
	    <result column="ACCT_PDLV2" property="acctPdlv2" jdbcType="DECIMAL" />
	    <result column="VCN_STS2" property="vcnSts2" jdbcType="VARCHAR" />
	    <result column="ISS_MOD2" property="issMod2" jdbcType="VARCHAR" />
	    <result column="CLOSE_CODE2" property="closeCode2" jdbcType="VARCHAR" />
	    <result column="CDFRM2" property="cdfrm2" jdbcType="VARCHAR" />
	    <result column="CRED_LMT2" property="credLmt2" jdbcType="DECIMAL" />
	    <result column="REVS2" property="revs2" jdbcType="VARCHAR" />
	    <result column="CARDNBR3" property="cardnbr3" jdbcType="VARCHAR" />
	    <result column="PRODUCT3" property="product3" jdbcType="DECIMAL" />
	    <result column="PROD_LEVEL3" property="prodLevel3" jdbcType="DECIMAL" />
	    <result column="CATEGORY3" property="category3" jdbcType="DECIMAL" />
	    <result column="EXPIRE3" property="expire3" jdbcType="VARCHAR" />
	    <result column="MAFLAG3" property="maflag3" jdbcType="VARCHAR" />
	    <result column="OPENDATE3" property="opendate3" jdbcType="TIMESTAMP" />
	    <result column="PBFLAG3" property="pbflag3" jdbcType="VARCHAR" />
	    <result column="BUSI_NAME3" property="busiName3" jdbcType="VARCHAR" />
	    <result column="CARDSTAT3" property="cardstat3" jdbcType="VARCHAR" />
	    <result column="FEETYPE3" property="feetype3" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME3" property="custrName3" jdbcType="VARCHAR" />
	    <result column="ACTIVDAY3" property="activday3" jdbcType="TIMESTAMP" />
	    <result column="APP_SOUCE3" property="appSouce3" jdbcType="VARCHAR" />
	    <result column="MAST_CARD3" property="mastCard3" jdbcType="VARCHAR" />
	    <result column="ACCT_PDLV3" property="acctPdlv3" jdbcType="DECIMAL" />
	    <result column="VCN_STS3" property="vcnSts3" jdbcType="VARCHAR" />
	    <result column="ISS_MOD3" property="issMod3" jdbcType="VARCHAR" />
	    <result column="CLOSE_CODE3" property="closeCode3" jdbcType="VARCHAR" />
	    <result column="CDFRM3" property="cdfrm3" jdbcType="VARCHAR" />
	    <result column="CRED_LMT3" property="credLmt3" jdbcType="DECIMAL" />
	    <result column="REVS3" property="revs3" jdbcType="VARCHAR" />
	    <result column="CARDNBR4" property="cardnbr4" jdbcType="VARCHAR" />
	    <result column="PRODUCT4" property="product4" jdbcType="DECIMAL" />
	    <result column="PROD_LEVEL4" property="prodLevel4" jdbcType="DECIMAL" />
	    <result column="CATEGORY4" property="category4" jdbcType="DECIMAL" />
	    <result column="EXPIRE4" property="expire4" jdbcType="VARCHAR" />
	    <result column="MAFLAG4" property="maflag4" jdbcType="VARCHAR" />
	    <result column="OPENDATE4" property="opendate4" jdbcType="TIMESTAMP" />
	    <result column="PBFLAG4" property="pbflag4" jdbcType="VARCHAR" />
	    <result column="BUSI_NAME4" property="busiName4" jdbcType="VARCHAR" />
	    <result column="CARDSTAT4" property="cardstat4" jdbcType="VARCHAR" />
	    <result column="FEETYPE4" property="feetype4" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME4" property="custrName4" jdbcType="VARCHAR" />
	    <result column="ACTIVDAY4" property="activday4" jdbcType="TIMESTAMP" />
	    <result column="APP_SOUCE4" property="appSouce4" jdbcType="VARCHAR" />
	    <result column="MAST_CARD4" property="mastCard4" jdbcType="VARCHAR" />
	    <result column="ACCT_PDLV4" property="acctPdlv4" jdbcType="DECIMAL" />
	    <result column="VCN_STS4" property="vcnSts4" jdbcType="VARCHAR" />
	    <result column="ISS_MOD4" property="issMod4" jdbcType="VARCHAR" />
	    <result column="CLOSE_CODE4" property="closeCode4" jdbcType="VARCHAR" />
	    <result column="CDFRM4" property="cdfrm4" jdbcType="VARCHAR" />
	    <result column="CRED_LMT4" property="credLmt4" jdbcType="DECIMAL" />
	    <result column="REVS4" property="revs4" jdbcType="VARCHAR" />
	    <result column="CARDNBR5" property="cardnbr5" jdbcType="VARCHAR" />
	    <result column="PRODUCT5" property="product5" jdbcType="DECIMAL" />
	    <result column="PROD_LEVEL5" property="prodLevel5" jdbcType="DECIMAL" />
	    <result column="CATEGORY5" property="category5" jdbcType="DECIMAL" />
	    <result column="EXPIRE5" property="expire5" jdbcType="VARCHAR" />
	    <result column="MAFLAG5" property="maflag5" jdbcType="VARCHAR" />
	    <result column="OPENDATE5" property="opendate5" jdbcType="TIMESTAMP" />
	    <result column="PBFLAG5" property="pbflag5" jdbcType="VARCHAR" />
	    <result column="BUSI_NAME5" property="busiName5" jdbcType="VARCHAR" />
	    <result column="CARDSTAT5" property="cardstat5" jdbcType="VARCHAR" />
	    <result column="FEETYPE5" property="feetype5" jdbcType="VARCHAR" />
	    <result column="CUSTR_NAME5" property="custrName5" jdbcType="VARCHAR" />
	    <result column="ACTIVDAY5" property="activday5" jdbcType="TIMESTAMP" />
	    <result column="APP_SOUCE5" property="appSouce5" jdbcType="VARCHAR" />
	    <result column="MAST_CARD5" property="mastCard5" jdbcType="VARCHAR" />
	    <result column="ACCT_PDLV5" property="acctPdlv5" jdbcType="DECIMAL" />
	    <result column="VCN_STS5" property="vcnSts5" jdbcType="VARCHAR" />
	    <result column="ISS_MOD5" property="issMod5" jdbcType="VARCHAR" />
	    <result column="CLOSE_CODE5" property="closeCode5" jdbcType="VARCHAR" />
	    <result column="CDFRM5" property="cdfrm5" jdbcType="VARCHAR" />
	    <result column="CRED_LMT5" property="credLmt5" jdbcType="DECIMAL" />
	    <result column="REVS5" property="revs5" jdbcType="VARCHAR" />
	    <result column="CRT_TIME" property="crtTime" jdbcType="TIMESTAMP" />
	    <result column="CRT_DATE" property="crtDate" jdbcType="TIMESTAMP" />
	    <result column="CRT_USER" property="crtUser" jdbcType="VARCHAR" />
	    <result column="LST_UPD_TIME" property="lstUpdTime" jdbcType="TIMESTAMP" />
	    <result column="LST_UPD_DATE" property="lstUpdDate" jdbcType="TIMESTAMP" />
	    <result column="LST_UPD_USER" property="lstUpdUser" jdbcType="VARCHAR" />
	    <result column="APP_ID" property="appId" jdbcType="VARCHAR" />
	    <result column="CATE" property="cate" jdbcType="VARCHAR" />
	    <result column="CARD_STAT" property="cardStat" jdbcType="VARCHAR" />
	    <result column="AGE_AMT" property="ageAmt" jdbcType="VARCHAR" />
	    <result column="AGE_DAYS" property="ageDays" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectCustInfoByAppId" resultMap="custResultMap_3002" parameterType="java.lang.String" >
    select 
      ID, TRXTYPE, RETCODE, BNKNBR, SOURCE, BRN_NO, OPE_NO, SEQNO, CARDNBR, OPTION1, KEYTYPE, 
    CUSTID, CHINAME, ENGNAME, GENDER, NATION, MARRIED, EDUCATION, JOBPOSIT, HOMEPHONE, 
    BUSIPHONE, BUSIEXT, MOBILEPHONE, EMAIL, FAXNO, RESIDEYES, RESIDESTS, BUSINAME, DEPT, 
    TECTITLE, TRADE, BUSITYPE, JOBYES, EARNING, SPOUSERN, RESERVE_QUESTION, RESERVE_ANSWER, 
    CUSRT_CRED, CUSTR_CREDX, MP_CRED, CRED_AVAL, CASH_AVAL, LAYCODE1, LAYCODE2, FORECOMP, 
    FJOBTIME, BIRTHDAY, PIN_SET, CUSTR_REF, CALMT, HTEL_AREA, REVS, CON_NAME1, CON_TEL1, 
    CON_NAME2, CON_TEL2, MAFLAG, IDNO, NAME, SMSYN, ID_DTE, MAIL_CODE, NATION_CD, ID_ISSDT, 
    ISSDEPT_CD, CRED_AVALX, CASH_AVALX, BUSINAME2, LAYCODE3, CLASS_CODE, ISSDEPT_IF, 
    FOREDEPT, QQ_NBR, WX_NBR, SUM_CRED, SUM_MPLMT, SUM_MLLMT, POI_CODE, EMAIL_IN, SIGN_FLAG, 
    SCHLNM_CH, SCHLNM_EN, ENROLL_DATE, GRADU_DATE, LAYCODE4, RL_VAL, CU_AVAL2, CU_CASH_AVAL2, 
    RESERVED, CRT_TIME, CRT_DATE, CRT_USER, LST_UPD_TIME, LST_UPD_DATE, LST_UPD_USER, 
    APP_ID
    from OPAS_INTERFACE_3002
    where APP_ID = #{appId,jdbcType=VARCHAR}
  </select>
  <select id="selectHaveCardInfoByAppIdByMap" resultMap="custResultMap_3002" parameterType="java.util.Map" >
	   select s.* from (select a.ID,
	       a.APP_ID,
	       a.TRXTYPE,
	       a.RETCODE,
	       a.BNKNBR,
	       a.SOURCE,
	       a.BRN_NO,
	       a.OPE_NO,
	       a.SEQNO,
	       a.CARDNBR,
	       a.OPTION1,
	       a.KEYTYPE,
	       a.CUSTID,
	       a.CHINAME,
	       a.ENGNAME,
	       a.GENDER,
	       a.NATION,
	       a.MARRIED,
	       a.EDUCATION,
	       a.JOBPOSIT,
	       a.HOMEPHONE,
	       a.BUSIPHONE,
	       a.BUSIEXT,
	       a.MOBILEPHONE,
	       a.EMAIL,
	       a.FAXNO,
	       a.RESIDEYES,
	       a.RESIDESTS,
	       a.BUSINAME,
	       a.DEPT,
	       a.TECTITLE,
	       a.TRADE,
	       a.BUSITYPE,
	       a.JOBYES,
	       a.EARNING,
	       a.SPOUSERN,
	       a.RESERVE_QUESTION,
	       a.RESERVE_ANSWER,
	       a.CUSRT_CRED,
	       a.CUSTR_CREDX,
	       a.MP_CRED,
	       a.CRED_AVAL,
	       a.CASH_AVAL,
	       a.LAYCODE1,
	       a.LAYCODE2,
	       a.FORECOMP,
	       a.FJOBTIME,
	       a.BIRTHDAY,
	       a.PIN_SET,
	       a.CUSTR_REF,
	       a.CALMT,
	       a.HTEL_AREA,
	       a.REVS,
	       a.CON_NAME1,
	       a.CON_TEL1,
	       a.CON_NAME2,
	       a.CON_TEL2,
	       a.MAFLAG,
	       a.IDNO,
	       a.NAME,
	       a.SMSYN,
	       a.ID_DTE,
	       a.MAIL_CODE,
	       a.NATION_CD,
	       a.ID_ISSDT,
	       a.ISSDEPT_CD,
	       a.CRED_AVALX,
	       a.CASH_AVALX,
	       a.BUSINAME2,
	       a.LAYCODE3,
	       a.CLASS_CODE,
	       a.ISSDEPT_IF,
	       a.FOREDEPT,
	       a.QQ_NBR,
	       a.WX_NBR,
	       a.SUM_CRED,
	       a.SUM_MPLMT,
	       a.SUM_MLLMT,
	       a.POI_CODE,
	       a.EMAIL_IN,
	       a.SIGN_FLAG,
	       a.SCHLNM_CH,
	       a.SCHLNM_EN,
	       a.ENROLL_DATE,
	       a.GRADU_DATE,
	       a.LAYCODE4,
	       a.RL_VAL,
	       a.CU_AVAL2,
	       a.CU_CASH_AVAL2,
	       a.RESERVED,
	       a.CRT_TIME,
	       a.CRT_DATE,
	       a.CRT_USER,
	       a.LST_UPD_TIME,
	       a.LST_UPD_DATE,
	       a.LST_UPD_USER,
	       cardStat('5',#{appId}) as cardStat_ydj,
           cardStat('10',#{appId}) as cardStat_bzk,
	       <!-- b.CATE,
	       b.CARD_STAT,
	       b.AGE_AMT,
	       b.AGE_DAYS, -->
	       (select sum(b.AGE_AMT) from OPAS_INTERFACE_3001 b where a.app_id = b.app_id) as AGE_AMT,
           (select sum(b.AGE_DAYS) from OPAS_INTERFACE_3001 b where a.app_id = b.app_id) as AGE_DAYS,
           (select b.CREDIT_LIMIT from OPAS_INTERFACE_3001 b where b.cate = '5' and b.app_id = a.app_id and rownum = 1) as limit_ydj,
           (select b.CREDIT_LIMIT from OPAS_INTERFACE_3001 b where b.cate = '10' and b.app_id = a.app_id and rownum = 1) as limit_bzk,
           trim(c.ADD_1)||trim(c.ADD_2)||trim(c.ADD_3)||trim(c.ADD_4)||trim(c.ADD_5) as BILL_ADDR,
           c.ADD_TYPE,
           (select C1C2_FLAG from opas_biz_inp_appl_c1 d where d.app_id =  #{appId}) as c1c2_flag
	  from OPAS_INTERFACE_3002 a
	  <!-- left join OPAS_INTERFACE_3001 b on a.app_id = b.app_id -->
	  left join OPAS_INTERFACE_3014  c on a.app_id = c.app_id
	  where a.app_id =  #{appId}
	  order by a.lst_upd_time desc,c.CRT_TIME desc) s where rownum = '1'
  </select>
    <select id="selectCardInfoByAppId" resultMap="cardResultMap_3118" parameterType="java.lang.String" >
	    select ID,
	       TRXTYPE,
	       RETCODE,
	       BNKNBR,
	       SOURCE,
	       BRN_NO,
	       OPE_NO,
	       SEQNO,
	       KEYTYPE,
	       CUSTID,
	       INSFLAG,
	       INSCARD,
	       CUSTR_NAME,
	       COUNT,
	       RTN_IND,
	       s.CARDNBR1,
	       
	       PROD_LEVEL1,
	       CATEGORY1,
	       EXPIRE1,
	       MAFLAG1,
	       OPENDATE1,
	       PBFLAG1,
	       BUSI_NAME1,
	       CARDSTAT1,
	       FEETYPE1,
	       CUSTR_NAME1,
	       ACTIVDAY1,
	       APP_SOUCE1,
	       MAST_CARD1,
	       ACCT_PDLV1,
	       VCN_STS1,
	       ISS_MOD1,
	       CLOSE_CODE1,
	       CDFRM1,
	       CRED_LMT1,
	       REVS1,
	       CARDNBR2,
	       PROD_LEVEL2,
	       CATEGORY2,
	       EXPIRE2,
	       MAFLAG2,
	       OPENDATE2,
	       PBFLAG2,
	       BUSI_NAME2,
	       CARDSTAT2,
	       FEETYPE2,
	       CUSTR_NAME2,
	       ACTIVDAY2,
	       APP_SOUCE2,
	       MAST_CARD2,
	       ACCT_PDLV2,
	       VCN_STS2,
	       ISS_MOD2,
	       CLOSE_CODE2,
	       CDFRM2,
	       CRED_LMT2,
	       REVS2,
	       CARDNBR3,
	       
	       PROD_LEVEL3,
	       CATEGORY3,
	       EXPIRE3,
	       MAFLAG3,
	       OPENDATE3,
	       PBFLAG3,
	       BUSI_NAME3,
	       CARDSTAT3,
	       FEETYPE3,
	       CUSTR_NAME3,
	       ACTIVDAY3,
	       APP_SOUCE3,
	       MAST_CARD3,
	       ACCT_PDLV3,
	       VCN_STS3,
	       ISS_MOD3,
	       CLOSE_CODE3,
	       CDFRM3,
	       CRED_LMT3,
	       REVS3,
	       CARDNBR4,
	       
	       PROD_LEVEL4,
	       CATEGORY4,
	       EXPIRE4,
	       MAFLAG4,
	       OPENDATE4,
	       PBFLAG4,
	       BUSI_NAME4,
	       CARDSTAT4,
	       FEETYPE4,
	       CUSTR_NAME4,
	       ACTIVDAY4,
	       APP_SOUCE4,
	       MAST_CARD4,
	       ACCT_PDLV4,
	       VCN_STS4,
	       ISS_MOD4,
	       CLOSE_CODE4,
	       CDFRM4,
	       CRED_LMT4,
	       REVS4,
	       CARDNBR5,
	       
	       PROD_LEVEL5,
	       CATEGORY5,
	       EXPIRE5,
	       MAFLAG5,
	       OPENDATE5,
	       PBFLAG5,
	       BUSI_NAME5,
	       CARDSTAT5,
	       FEETYPE5,
	       CUSTR_NAME5,
	       ACTIVDAY5,
	       APP_SOUCE5,
	       MAST_CARD5,
	       ACCT_PDLV5,
	       VCN_STS5,
	       ISS_MOD5,
	       CLOSE_CODE5,
	       CDFRM5,
	       CRED_LMT5,
	       REVS5,
	       CRT_TIME,
	       CRT_DATE,
	       CRT_USER,
	       LST_UPD_TIME,
	       LST_UPD_DATE,
	       LST_UPD_USER,
	       APP_ID,
	      (select a.prod_name
	          from opas_param_card_product a
	         where a.card_code = s.PRODUCT1
	           and rownum = 1) as PRODUCT1,
	       (select a.prod_name
	          from opas_param_card_product a
	         where a.card_code = s.PRODUCT2
	           and rownum = 1) as PRODUCT2,
	       (select a.prod_name
	          from opas_param_card_product a
	         where a.card_code = s.PRODUCT3
	           and rownum = 1) as PRODUCT3,
	       (select a.prod_name
	          from opas_param_card_product a
	         where a.card_code = s.PRODUCT4
	           and rownum = 1) as PRODUCT4,
	       (select a.prod_name
	          from opas_param_card_product a
	         where a.card_code = s.PRODUCT5
	           and rownum = 1) as PRODUCT5
	  from OPAS_INTERFACE_3118 s
   		 where APP_ID = #{appId,jdbcType=VARCHAR}
   </select>
   <select id="selectCustInfoByCustId" resultMap="cardResultMap_3118" parameterType="com.huaxia.opas.domain.rule.Opasbizinpapplc1" >
    select 
     ID, TRXTYPE, RETCODE, BNKNBR, SOURCE, BRN_NO, OPE_NO, SEQNO, KEYTYPE, CUSTID, INSFLAG, 
    INSCARD, CUSTR_NAME, COUNT, RTN_IND, CARDNBR1, PRODUCT1, PROD_LEVEL1, CATEGORY1, 
    EXPIRE1, MAFLAG1, OPENDATE1, PBFLAG1, BUSI_NAME1, CARDSTAT1, FEETYPE1, CUSTR_NAME1, 
    ACTIVDAY1, APP_SOUCE1, MAST_CARD1, ACCT_PDLV1, VCN_STS1, ISS_MOD1, CLOSE_CODE1, CDFRM1, 
    CRED_LMT1, REVS1, CARDNBR2, PRODUCT2, PROD_LEVEL2, CATEGORY2, EXPIRE2, MAFLAG2, OPENDATE2, 
    PBFLAG2, BUSI_NAME2, CARDSTAT2, FEETYPE2, CUSTR_NAME2, ACTIVDAY2, APP_SOUCE2, MAST_CARD2, 
    ACCT_PDLV2, VCN_STS2, ISS_MOD2, CLOSE_CODE2, CDFRM2, CRED_LMT2, REVS2, CARDNBR3, 
    PRODUCT3, PROD_LEVEL3, CATEGORY3, EXPIRE3, MAFLAG3, OPENDATE3, PBFLAG3, BUSI_NAME3, 
    CARDSTAT3, FEETYPE3, CUSTR_NAME3, ACTIVDAY3, APP_SOUCE3, MAST_CARD3, ACCT_PDLV3, 
    VCN_STS3, ISS_MOD3, CLOSE_CODE3, CDFRM3, CRED_LMT3, REVS3, CARDNBR4, PRODUCT4, PROD_LEVEL4, 
    CATEGORY4, EXPIRE4, MAFLAG4, OPENDATE4, PBFLAG4, BUSI_NAME4, CARDSTAT4, FEETYPE4, 
    CUSTR_NAME4, ACTIVDAY4, APP_SOUCE4, MAST_CARD4, ACCT_PDLV4, VCN_STS4, ISS_MOD4, CLOSE_CODE4, 
    CDFRM4, CRED_LMT4, REVS4, CARDNBR5, PRODUCT5, PROD_LEVEL5, CATEGORY5, EXPIRE5, MAFLAG5, 
    OPENDATE5, PBFLAG5, BUSI_NAME5, CARDSTAT5, FEETYPE5, CUSTR_NAME5, ACTIVDAY5, APP_SOUCE5, 
    MAST_CARD5, ACCT_PDLV5, VCN_STS5, ISS_MOD5, CLOSE_CODE5, CDFRM5, CRED_LMT5, REVS5, 
    CRT_TIME, CRT_DATE, CRT_USER, LST_UPD_TIME, LST_UPD_DATE, LST_UPD_USER, APP_ID
    from OPAS_INTERFACE_3118
    where KEYTYPE = #{c1Idtype,jdbcType=VARCHAR} and CUSTID = #{c1Idnbr,jdbcType=VARCHAR}
  </select>
  
  <resultMap id="cardResultMap_3001" type="java.util.Map" >
	    <result column="cate" jdbcType="NUMERIC" property="cate" />
	    <result column="CREDIT_LIMIT" jdbcType="NUMERIC" property="creditLimit" />
  </resultMap>
  <select id="selectCreditLimitByAppId" resultMap="cardResultMap_3001" parameterType="java.lang.String" >
    select 
    app_id, cate, CREDIT_LIMIT  
    from OPAS_INTERFACE_3001
    where app_id = #{app_id,jdbcType=VARCHAR}
  </select>
  <resultMap id="cardResultMap_3118_2" type="com.huaxia.opas.domain.input.Union3118">
  		<result column="CUSTID" property="custid" jdbcType="VARCHAR" />
  		<result column="PRODUCT1" property="product1" jdbcType="VARCHAR" />
	    <result column="CARDSTAT1" property="cardstat1" jdbcType="VARCHAR" />
	    <result column="CRED_LMT1" property="credLmt1" jdbcType="NUMERIC" />
	    <result column="MAFLAG1" property="maflag1" jdbcType="VARCHAR" />
	    <result column="APP_ID"  property="appId" jdbcType="VARCHAR"/>
	    <result column="SORT_FLAG"  property="sortFlag" jdbcType="VARCHAR"/>
	    <result column="num"  property="num" jdbcType="NUMERIC"/>
	    <result column="CARDNBR1" property="cardnbr1" jdbcType="VARCHAR"/> 
  </resultMap>
  <select id="select3118ByAppId" resultMap="cardResultMap_3118_2" parameterType="java.util.Map" >
  	 select CUSTID,MAFLAG1,CARDSTAT1,CRED_LMT1,APP_ID,PRODUCT1,sort_flag
     from (
    	select 
	    s.CUSTID,
	    s.MAFLAG1,
	    s.CARDSTAT1,
	    s.CRED_LMT1,
	    s.APP_ID,
	   (select a.prod_name
       from opas_param_card_product a
      where a.card_code = s.PRODUCT1
        and rownum = 1) as PRODUCT1,
      (case when  (s.PRODUCT1 &gt; '0079'  and s.PRODUCT1 &lt; '0086') then 'a'
      when (s.product1=#{applyCard,jdbcType=VARCHAR} and s.CARDSTAT1 is null)   then 'b'
      when (s.product1=#{applyCard,jdbcType=VARCHAR} and s.CARDSTAT1 is  not null) then 'c'
      when (s.product1!=#{applyCard,jdbcType=VARCHAR}
      and s.CARDSTAT1 is not null and s.CARDSTAT1 not in ('A','U','UI')) then 'd'
      when (s.product1!=#{applyCard,jdbcType=VARCHAR} and s.CARDSTAT1 is null )   then 'e'
      when (s.product1!=#{applyCard,jdbcType=VARCHAR}
      and s.CARDSTAT1 in ('A','U','UI') )   then 'f'
      else 'f' end ) as sort_flag
	  from OPAS_INTERFACE_3118 s
   	  where (s.CARDSTAT1 not in ('T','Q')  or s.CARDSTAT1 is null)
   	  AND s.APP_ID = #{appId,jdbcType=VARCHAR})  order by sort_flag 
   </select>
   <select id="select3118NumByAppId" resultMap="cardResultMap_3118_2" parameterType="java.lang.String" >
	select  sort_flag,count(1) as num from (
       select 
       (case when  (('0079' &lt; s.PRODUCT1 and s.PRODUCT1 &lt; '0086')  AND s.CARDSTAT1 in ('T','Q')) then 'a'
       when (('0079'&lt; s.PRODUCT1 and s.PRODUCT1 &lt; '0086') AND (s.CARDSTAT1 not in ('T','Q') or s.CARDSTAT1 is null) )  then 'b'     
       when ((s.PRODUCT1 &lt; '0080' or s.PRODUCT1 &gt; '0085' ) AND s.CARDSTAT1 in ('T','Q')) then 'c'    
       when ((s.PRODUCT1 &lt; '0080' or s.PRODUCT1 &gt;'0085' ) AND (s.CARDSTAT1 not in ('T','Q') or s.CARDSTAT1 is null)  ) then 'd'
       else 'f' end ) as sort_flag
		from OPAS_INTERFACE_3118 s
		where  s.MAFLAG1='1' and s.APP_ID = #{appId,jdbcType=VARCHAR}  )
      group by sort_flag 
   </select>
   <select id="selectNewHaveFlag" resultType="java.lang.String" parameterType="java.util.Map">
   		select s.new_have_flag from opas_interface_3118 s where s.app_id= #{appId,jdbcType=VARCHAR} and rownum=1
   </select>
   <select id="selectfkByAppId" resultMap="cardResultMap_3118_2" parameterType="java.util.Map">
   	   select 
        (select a.prod_name
       from opas_param_card_product a
      where a.card_code = s.PRODUCT1
        and rownum = 1) as PRODUCT1,
        s.CARDSTAT1,
        (select count(1) from OPAS_INTERFACE_3070  t where t.CARD_NBR=s.CARDNBR1
        ) as num
		from OPAS_INTERFACE_3118 s
		where s.CARDNBR1 in (
			select C1_CARDNBR from opas_biz_inp_appl_c1 
			where APP_ID = #{appId,jdbcType=VARCHAR} 
		)
		and  s.APP_ID = #{appId,jdbcType=VARCHAR} and rownum=1
   </select>
   <select id="select3070NumByAppId" resultMap="cardResultMap_3118_2" parameterType="java.util.Map">
   	   select  sort_flag,count(1) as num from (
       select 
       (case when (s.CANCL_CODE not in ('T','Q') or s.CANCL_CODE is null)  then 'a'
       when   s.CANCL_CODE in ('T','Q')  then 'b'     
       else 'f' end ) as sort_flag
		from OPAS_INTERFACE_3070 s
		where  s.CARD_HOLDER!='1' and s.APP_ID = #{appId,jdbcType=VARCHAR} )
      group by sort_flag 
   </select>
</mapper>