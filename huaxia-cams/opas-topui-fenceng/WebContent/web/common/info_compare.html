
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="../../topui/topui.js"></script>
<script type="text/javascript" src="../../js/author/common.js"></script>
<link rel="stylesheet" href="../../css/common/style.css" type="text/css"></link>
<link rel="stylesheet" href="../../css/normalize-ext.css" type="text/css"></link>
<link rel="stylesheet" href="../../css/normalize.css" type="text/css"></link>
<style type="text/css">
 input[type="checkbox"] {
	width: 14px;
	vertical-align: middle;
}
 table[id="123"]{
 	font-size:14px;
 	text-align:center;
 }
 table[id="123"] p{
 	text-align:left;
 }
.one{
	text-align:left;
}
</style>
</head>
	<body style="width:100%;">
	<form id="compareForm">
		<table class="formtable">
			<tr>
				<td><input id="applyInputfull" type="checkbox" value="1" name="applyInputfull"/><b>抄录文字完整有效</b></td>
				<td></td>
				<td><input id="signFull" type="checkbox" value="1" name="signFull"/><b>签名完整有效</b></td>
			</tr>
			<tr>
				<td><input id="nationalInutfull" type="checkbox" value="1" name="nationalInutfull"/><b>国籍填写有效</b></td>
				<td></td>
				<td><input id="certifiPeriodfull" type="checkbox" value="1" name="certifiPeriodfull"/><b>身份证有效期填写完整有效</b></td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="applyWorkTure" class="c1Real"/><b>申请单位真实</b></td>
			</tr>
			<tr>
				<td colspan="3">
					<table style="width: 99%;table-layout:fixed" border='1'  id="123">
						<tr >
							<td style="width: 60px;"><b>比对项</b></td>
							<td style="width: 340px;"><b>人行信息</b></td>
							<td style="width: 250px;"><b>申请表信息</b></td>
							<td  class="one" style="width: 70px;"><b>是否一致</b></td>
						</tr>
						<tr>
							<td ><b>单位名称</b></td>
							<td ><p id="companyPboc" name="companyPboc"></p></td>
							<td ><p id="companyC1" name="companyC1"></p></td>
							<td  class="one"><label><b><input type="radio" value="1" name="company" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="company" class="c1Real"/>否
							</b></label></td>
						</tr>
						<tr>
							<td ><b>单位地址</b></td>
							<td ><p id="compAddrPboc" name="compAddrPboc"></p></td>
							<td width=""><p id="compAddrC1" name="compAddrC1"></p></td>
							<td  class="one"><label><b><input type="radio" value="1" name="peobankCompanyNameAddr" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="peobankCompanyNameAddr" class="c1Real"/>否
							</b></label></td>
						</tr>
						<tr>
							<td ><b>单位电话</b></td>
							<td><p id="ccompPhonePboc" name="ccompPhonePboc"></p></td>
							<td width=""><p id="ccompPhoneC1" name="ccompPhoneC1"></p></td>
							<td class="one"><label><b><input type="radio" value="1" name="peobankCompanyNameTel" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="peobankCompanyNameTel" class="c1Real"/>否
							</b></label></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="company114NameAddr"/>114单名+单址</td>
				<td></td>
				<td><input type="checkbox" value="1" name="company114NameTel"/>114单名+单电</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="pyuanCompanyNameAddr"/>鹏元单名+单址</td>
				<td></td>
				<td><input type="checkbox" value="1" name="pyuanCompanyNameTel"/>鹏元单名+单电</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="officwebNameAddr"/>官方单名+单址</td>
				<td></td>
				<td><input type="checkbox" value="1" name="officwebNameTel"/>官方单名+单电</td>
			</tr>
			<tr>	
				<td><input type="checkbox" value="1" name="noOfficwebNameAddr"/>非官方单名+单址</td>
				<td></td>
				<td><input type="checkbox" value="1" name="noOfficwebNameTel"/>非官方单名+单电</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="otherThirdNameAddr"/>其他第三方信息单名+单址</td>
				<td></td>
				<td><input type="checkbox" value="1" name="thirddataAddr"/>第三方信息单址</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="regionalDataListName"/>区域数据单名</td>
				<td></td>
				<td><input type="checkbox" value="1" name="padPositionAddr"/>PAD定位地址</td>
			</tr>
			
			<tr>
				<td><input type="checkbox" value="1" name="applyWorkinfoTure"/><b>申请人工作信息真实</b></td>
				<td></td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="sbandgjj6monthsStatus" />社保公积金信息近6个月缴交正常</td>
				<td></td>
				<td><input type="checkbox" value="1" name="businetworkLegal"/>工商网法人</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="pubPolice"/>增强公安</td>
				<td></td>
				<td><input type="checkbox" value="1" name="businetworkMinor"/>工商网股东</td>
			</tr>
			<tr>
				<td><input type="checkbox"  value="1" name="peobankFirstcard6months"/>人行首张贷记卡发卡日期 > 6个月</td>
				<td></td>
				<td><input type="checkbox" value="1" name="insurance"/>保监会</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="others"/>其他</td>
				<td></td>
				<td>请说明：<input name="otherMemo" id="otherMemo"/></td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="applyerTrue"/><b>申请人真实</b></td>
				<td></td>
			</tr>
			<tr>
				<td colspan="3">
					<table style="width: 690px;table-layout:fixed" border='1' id="123">
						<tr >
							<td style="width: 60px;"><b>比对项</b></td>
							<td style="width: 340px;"><b>人行信息</b></td>
							<td style="width: 250px;"><b>申请表信息</b></td>
							<td  class="one" style="width: 70px;"><b>是否一致</b></td>
						</tr>
						<tr>
							<td><b>手机</b></td>
							<td ><p id="cellPhonePboc" name="cellPhonePboc"></p></td>
							<td ><p id="cellPhoneC1" name="cellPhoneC1"></p></td>
							<td><label><b><input type="radio" value="1" name="peobankPhone" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="peobankPhone" class="c1Real"/>否
							</b></label></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="thirdPhone" class="c1Real"/>第三方信息手机</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="otherthirdInfo" class="c1Real"/>其他第三方信息</td>
				<td><input type="hidden" id="appId" name="appId" value=""></td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="orderAddress" id ="orderAddress"/><b>账单地址</b></td>
			</tr>
			<tr>
				<td colspan="3">
					<table style="width: 690px;table-layout:fixed" border='1' id="123">
						<tr >
							<td style="width: 60px;"><b>比对项</b></td>
							<td style="width: 340px;"><b>人行信息</b></td>
							<td style="width: 250px;"><b>申请表信息</b></td>
							<td  class="one" style="width: 70px;"><b>是否一致</b></td>
						</tr>
						<tr>
							<td><b>账单地址</b></td>
							<td ><p id="billAddress" name="billAddress"></p></td>
							<td ><p id="billAddressC1" name="billAddressC1"></p></td>
							<td><label><b><input type="radio" value="1" name="billAddressCheck" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="billAddressCheck" class="c1Real"/>否</b></label>
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td><input type="checkbox" value="1" name="homeAddress" id ="homeAddress"/><b>住宅地址</b></td>
			</tr>
			<tr> 
				<td colspan="3">
					<table style="width: 690px;table-layout:fixed" border='1' id="123">
						<tr >
							<td style="width: 60px;"><b>比对项</b></td>
							<td style="width: 340px;"><b>人行信息</b></td>
							<td style="width: 250px;"><b>申请表信息</b></td>
							<td  class="one" style="width: 70px;"><b>是否一致</b></td>
						</tr>
						<tr>
							<td><b>住宅地址</b></td>
							<td ><p id="houseAddress" name="houseAddress"></p></td>
							<td ><p id="houseAddressC1" name="houseAddressC1"></p></td>
							<td><label><b><input type="radio" value="1" name="houseAddressCheck" class="c1Real"/>是</b></label>
								<label><b><input type="radio" value="0" name="houseAddressCheck" class="c1Real"/>否</b></label>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</form>
	<div style="text-align: center; padding: 5px">
			<a href="javascript:void(0)" class="easyui-linkbutton"
				onclick="onSave('0')">保存</a>&nbsp;
	</div>
	
	<script>
	/* $(function() {
		//$("#appId").val(parent.appId]);
	}) */
	var infoCollForm=$("#infoCollForm");
	 var url = location.href;
	var appId = url.split("=")[1].split("&")[0];
	var userId = url.split("=")[2];
	var roleObj={"appId":appId};//"1601240945P00101"
	var isSaveSuccess=true;//保存是否成功的标志 父页面调用 
	var isCanCommit = false;//判断是否是  进行父页面是否可提交 	
	var waringMessage="";//保存失败时父页面要用的 提示的信息 
	var bigSaveButtonFlag=false;//判断是否是  进行父页面大保存操作的依据 
	var compareFlag=false;//用于比对页面没有全勾选对提交的控制
	var alreadyFlag=false;//判断子页面是否加载完毕标志
	var revCompInfojsonTwo  = null;
	var restJsonTwo = null;
$(function(){
	autoChecked();
	$('#appId').val(appId);
	//此方法用于循环给单选框赋值，后台返回给前台一个json串，前台循环json串，如果单选框的name等于json串的key，value等于json串的value，就把它勾选
	$cf.ajax({
		url : "/opas-naps/query_info_compare.json",
		data : roleObj,
		onSuccess : function(ret) {
			var revCompInfo = ret.RSP_BODY.revCompInfo;
			var revCompInfojson = eval('(' +revCompInfo+ ')');
		    revCompInfojsonTwo = revCompInfojson;
			for(var item in revCompInfojson){
					var jvalue=revCompInfojson[item];
					$("input[name='"+item+"'][value='"+jvalue+"']").prop("checked", true);
					//该页面只有一个文本框，直接赋值即可，如果需要参考循环赋值，请看info_collect.html页面
					if(item=="otherMemo"){
						$("#otherMemo").val(jvalue);
					}
			}
			var rest = ret.RSP_BODY.rest;
			var flag = ret.RSP_BODY.flag;
			var restJson = eval('(' +rest+ ')');
		    restJsonTwo = restJson;
			var rest_id = new Array("companyPboc:companyPboc","compAddrPboc:compAddrPboc",
					"ccompPhonePboc:ccompPhonePboc","companyC1:companyC1","compAddrC1:compAddrC1",
					"ccompPhoneC1:ccompPhoneC1","cellPhonePboc:cellPhonePboc",
					"cellPhoneC1:cellPhoneC1","billAddress:billAddress","billAddressC1:billAddressC1",
					"houseAddress:houseAddress","houseAddressC1:houseAddressC1");
			for(var i=0;i<rest_id.length;i++){
				var temp=rest_id[i].split(":");
			     $("#"+temp[0]).html(eval('restJson.' +temp[1]));
			     if(flag=='0'){
			    	  $(":radio[name='"+temp[0]+"']").attr("checked", true);   
			     }
			}
			//如果人行信息账单地址与申请表信息账单地址相同，billAddressCheck=“1”被选中，则orderAddress也会被勾选
			/* var billAddressCheckFlag = $("input[name='billAddressCheck'][value='1']").prop("checked");
			if(billAddressCheckFlag){
				$("input[name='orderAddress'][value='1']").prop("checked",true);
			} */
			var orderAddressFlag = $("input[name='orderAddress']").prop("checked");
			if(orderAddressFlag){
				$("input[name='billAddressCheck'][value='1']").prop("checked",true);
			}
			var homeAddressFlag = $("input[name='homeAddress']").prop("checked");
			if(homeAddressFlag){
				$("input[name='houseAddressCheck'][value='1']").prop("checked",true);
			}
			var officwebNameTelFlag = $("input[name='officwebNameTel']").prop("checked");
			if(officwebNameTelFlag){
				$("input[name='applyWorkTure']").prop("checked",true);
			}
			var officwebNameAddrFlag = $("input[name='officwebNameAddr']").prop("checked");
			if(officwebNameAddrFlag	){
				$("input[name='applyWorkTure']").prop("checked",true);
			}
			if(revCompInfojson.applyInputfull != "" && revCompInfojson.applyInputfull != undefined){
				$("input[name='applyInputfull']").attr("disabled", true);
			}
			if(revCompInfojson.signFull != "" && revCompInfojson.signFull != undefined){
				$("input[name='signFull']").attr("disabled", true);
			}
			if(revCompInfojson.certifiPeriodfull != "" && revCompInfojson.certifiPeriodfull != undefined){
				$("input[name='certifiPeriodfull']").attr("disabled", true);
			}
			alreadyFlag = true;
		}
	});
})

	
	 var compareForm = $("#compareForm");
	function onSave(obj) {
	    $("input[name='applyInputfull']").attr("disabled", false);
		$("input[name='signFull']").attr("disabled", false );
		$("input[name='certifiPeriodfull']").attr("disabled", false);
		//截取流水号的第7位看是否是网申进件
		var isWebBolt = appId.substr(6,1);
		isSaveSuccess=true;
		waringMessage="";
		if(parent.bigSaveButtonFlag){
			bigSaveButtonFlag=parent.bigSaveButtonFlag;
		}else{
			bigSaveButtonFlag=false;
		}	
		//解决bug,xuzhiguo=====校验项添加=======
		var applyInputfull = $("#applyInputfull").prop("checked");
		var signFull = $("#signFull").prop("checked");
		var nationalInutfull = $("#nationalInutfull").prop("checked");
		var certifiPeriodfull = $("#certifiPeriodfull").prop("checked");
		
		if(isWebBolt!="B"){//非网申进件 
			if(!(applyInputfull&&signFull&&nationalInutfull&&certifiPeriodfull)&&!confirm('【审查比对项】未全勾选，是否提交通过')){
				isSaveSuccess = false;
				waringMessage = "【审查比对项】未全勾选";
				compareFlag = true;
				parent.comingExamineCommit = false;
				return;
			}
		}else{//网申进件
			if(!(nationalInutfull&&certifiPeriodfull)&&!confirm('网申进件【国籍填写有效】【身份证有效期填写完整有效】未全勾选，是否提交通过')){
				isSaveSuccess = false;
				waringMessage = "网申进件【国籍填写有效】【身份证有效期填写完整有效】未全勾选";
				compareFlag = true;
				parent.comingExamineCommit = false;
				return;
			}
		}
		var jsondata = getFormData(compareForm.serializeArray());
		jsondata["userCode"]=userId;
		jsondata["isWebBolt"]=isWebBolt;
		jsondata['revCompInfojsonTwo']=revCompInfojsonTwo;
		jsondata['restJsonTwo']=restJsonTwo;
		$("input[name='applyInputfull']").attr("disabled", true);
		$("input[name='signFull']").attr("disabled", true );
	    $("input[name='certifiPeriodfull']").attr("disabled", true);
		if(obj=='1'){
			jsondata['commitFlag'] = '1';
		}
		$cf.ajax({
			url : "/opas-naps/info_compare_save.json",
			data : jsondata,
			onSuccess : function(data) {
				if (data.RSP_BODY.isSuccess) {
					isCanCommit = true;
					if(!bigSaveButtonFlag){
						top.$cf.showMsg("比对信息保存成功！");
					}
				} else {
					isCanCommit = false;
					isSaveSuccess = false;
					waringMessage+=data.exMsg;	
					if(!bigSaveButtonFlag){
					$.messager.alert("操作提示", "添加失败:" + data.exMsg, "error");
					}
					onConcle("winEdit");
				}
			}

		});
	}
	
	function getFormData(dataObject) {
		var jsonObject = '{';
		var k = 0;
		$.each(dataObject, function() {
			k++;
			var objName = this.name;
			var objValue = this.value;
			jsonObject += '"' + objName + '":';
			jsonObject += '"' + objValue + '"';
			if (k < dataObject.length) {
				jsonObject += ",";
			}
		});
		jsonObject += '}';
		return eval("(" + jsonObject + ")");
	}
	
	//按钮联动
	var applyWorkTureFlag = false;//申请人单位真实联动标志
	var applyWorkTureFlag2 = false;//申请人单位真实联动标志
	var applyTrueFlag = false;//申请人真实标志
	var applyTrueFlag2 = false;//申请人真实标志
	var applyWorkinfoTureFlag = false;//申请人工作信息真实
	var m = 0 ;
	function people(peopleList){
		for(var i = 0;i<peopleList.length;i++){
			if($("input[name='"+peopleList[i]+"']").prop("checked")){
				m++;
			}
		}
	}
	function applyTrue(){
		var companyFlag = $("input[name='company']").prop("checked");
		var compAddrFlag = $("input[name='peobankCompanyNameAddr']").prop("checked");
		var ccompPhoneFlag = $("input[name='peobankCompanyNameTel']").prop("checked");
		var addList = new Array("company114NameAddr","company114NameTel","pyuanCompanyNameAddr",
				"pyuanCompanyNameTel","officwebNameAddr",
				"officwebNameTel","noOfficwebNameAddr","noOfficwebNameTel",
				"otherThirdNameAddr","thirddataAddr","regionalDataListName","padPositionAddr");
		m = 0;
		people(addList);
		if(m>0){
			applyWorkTureFlag2 = true;
		}
		if(companyFlag&&(compAddrFlag||ccompPhoneFlag)){
			$("input[name='applyWorkTure']").prop("checked",true);
			applyWorkTureFlag = true;
		}else if(applyWorkTureFlag2&&!(companyFlag&&(compAddrFlag||ccompPhoneFlag))){
			$("input[name='applyWorkTure']").prop("checked",true);
			applyWorkTureFlag = false;
		}else{
			$("input[name='applyWorkTure']").prop("checked",false);
			applyWorkTureFlag = false;
		}
	}
	function autoChecked(){
		$("input[name='peobankPhone']").click(function(){
			 if(this.value=='1'&&this.checked==true){
				$("input[name='applyerTrue']").prop("checked",true);
				applyTrueFlag = true;
			}else if(applyTrueFlag2 &&this.value=='0'&&this.checked==true){
				$("input[name='applyerTrue']").prop("checked",true);
				applyTrueFlag = false;
			}else{
				$("input[name='applyerTrue']").prop("checked",false);
				applyTrueFlag = false;
			}
	  	});
		$("input[name='billAddressCheck']").click(function(){
			if(this.value=='0'&&this.checked==true){
				$("input[name='orderAddress']").prop("checked",false);
			}else{
				$("input[name='orderAddress']").prop("checked",true);
			}
	  	});
		$("input[name='houseAddressCheck']").click(function(){
			if(this.value=='0'&&this.checked==true){
				$("input[name='homeAddress']").prop("checked",false);
			}else{
				$("input[name='homeAddress']").prop("checked",true);
			}
	  	});
		
		$("input[name='company']").click(function(){
			applyTrue();
		});
		$("input[name='peobankCompanyNameAddr']").click(function(){
			applyTrue();
		});
		$("input[name='peobankCompanyNameTel']").click(function(){
			applyTrue();
		})
		$("input[name='peobankPhone']").click(function(){
// 			//第三方信息和其他第三方信息
			if($("input[name='thirdPhone']").prop("checked")||$("input[name='otherthirdInfo']").prop("checked")||$("input[name='peobankPhone']").prop("checked")){
				$("input[name='applyerTrue']").prop("checked",true);
				applyTrueFlag = false;
			}else{
				$("input[name='applyerTrue']").prop("checked",false);
				applyTrueFlag = false;
			}
		})
		//114、鹏元、官方、非官方、其他第三方信息  跟申请单位联动
		var addList = new Array("company114NameAddr","company114NameTel","pyuanCompanyNameAddr",
				"pyuanCompanyNameTel","officwebNameAddr",
				"officwebNameTel","noOfficwebNameAddr","noOfficwebNameTel",
				"otherThirdNameAddr","thirddataAddr","regionalDataListName","padPositionAddr");
		for(var i = 0 ;i<addList.length;i++){
			$("input[name='"+addList[i]+"']").click(function(){
				applyTrue();
				people(addList);
				if(this.checked==true ){
					$("input[name='applyWorkTure']").prop("checked",true);
					applyWorkTureFlag2 = true;
				}else if(this.checked==false && applyWorkTureFlag){
					$("input[name='applyWorkTure']").prop("checked",true);
					applyWorkTureFlag2 = false;
				}else if(this.checked==false && !applyWorkTureFlag&&m>=1){
					$("input[name='applyWorkTure']").prop("checked",true);
					applyWorkTureFlag2 = true;
				}else{
					$("input[name='applyWorkTure']").prop("checked",false);
					applyWorkTureFlag2 = false;
				}
				m = 0;
			})
		}
		//社保公积金、工商网法人、增强公安、工商网股东、人行首张贷记卡发卡日期 > 6个月、保监会、其他   跟 申请人工作信息真实
		var workList = new Array("sbandgjj6monthsStatus","businetworkLegal","pubPolice","businetworkMinor",
				"peobankFirstcard6months","insurance","others");
		for(var i = 0 ;i<workList.length;i++){
			$("input[name='"+workList[i]+"']").click(function(){
				people(workList);
				if(m>0){
					$("input[name='applyWorkinfoTure']").prop("checked",true);
				}else{
					$("input[name='applyWorkinfoTure']").prop("checked",false);
				}
				m = 0;
			})
		}
		
		//第三方信息手机、其他第三方信息手机  根申请人真实匹配
		var thirdList = new Array("thirdPhone","otherthirdInfo");
		for(var i = 0 ;i<thirdList.length;i++){
			$("input[name='"+thirdList[i]+"']").click(function(){
				if($("input[name='peobankPhone']").prop("checked")){
					applyTrueFlag = true;
				}
				people(thirdList);
				if(this.checked==true){
					$("input[name='applyerTrue']").prop("checked",true);
					applyTrueFlag2 = true;
				}else if(this.checked == false && applyTrueFlag){
					$("input[name='applyerTrue']").prop("checked",true);
					applyTrueFlag2 = false;
				}else if(this.checked == false && !applyTrueFlag&&m>=1){
					$("input[name='applyerTrue']").prop("checked",true);
					applyTrueFlag2 = true;
				}else{
					$("input[name='applyerTrue']").prop("checked",false);
					applyTrueFlag2 = false;
				}
				m = 0 ;
			})
		}
	}
	document.onkeydown = function(event) {
		if (window.event.altKey && window.event.keyCode == "20") {
			if(window.parent.hrefFlag=='1'){
				window.parent.right_tab.tabs('select', '录入');
				window.parent.hrefFlag='0';
			}else{
				window.parent.right_tab.tabs('select', '比对');
				window.parent.hrefFlag='1';
			}
		}
		window.parent.flag='1';
		if( window.event.keyCode == "13"){
			window.parent.examineSubmitAfterSave();
		}
		if(window.event.keyCode=='32'){
			//获取光标所在的位置
			var inputName = $("input:focus,textarea:focus").attr('name');
			if(("input[name='"+name+"']").prop('checked')){
				$("input[name='"+name+"']").prop("checked",false);
			}else{
				$("input[name='"+name+"']").prop("checked",true);
			}
		}
	}
	</script>
</body>

