<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="../../topui/topui.js"></script>
<script type="text/javascript" src="../../js/author/common.js"></script>

<link rel="stylesheet" href="../../css/common/style.css" type="text/css"></link>
<style type="text/css">
.searchdiv {
	font-size: 10px;
}
</style>
</head>
<body style="font-size: 12px;">
	<div style="width: 99%; font-size: 12px;">
		<form id="seachForm">
			<div
				style="border: 1px solid rgb(149, 184, 231); border-image: none; width: 1364px; height: 30%; margin: 0px 0px 0px 10px">
				<fieldset class="textbox combo"
					style="left: 30px; margin: 5px 0 10px; width: 90%; height: 50px; padding: 0px 30px 10px 20px;">

					<legend align="left">
						<font size="2">查询选项</font>
					</legend>
					<div style="padding: 10px">
						流水号: <input class="easyui-textbox" style="width: 120px"
							name="lsh" id="lsh"> 客户姓名: <input class="easyui-textbox"
							style="width: 120px" name="khxm" id="khxm"> 证件号码: <input
							class="easyui-textbox" style="width: 120px" name="zjhm" id="zjhm">

						单位名称: <input class="easyui-textbox" style="width: 120px"
							name="dwmc" id="dwmc">
					</div>
				</fieldset>
				<fieldset class="textbox combo"
					style="left: 30px; margin: 5px 0 10px; width: 90%; height: 50px; padding: 0px 30px 10px 20px;">

					<legend align="left">
						<font size="2">排序选项</font>
					</legend>
					<div style="padding: 10px">
					<input type="checkbox" name="orderOption" value="GROUP_DATE" />分组天数
						<input type="checkbox" name="orderOption" value="APP_ID" />流水号
						<input type="checkbox" name="orderOption" value="PATCH_STATUS" />补件完成
						<input type="checkbox" name="orderOption" value="C1_CONAME" />单位名称
						流水号: <input class="easyui-textbox" style="width: 120px"
							name="sqjlsh" id="sqjlsh">
						<!-- <input type="checkbox" name="orderOption" value="fpsj" />分配时间 <select
							id="fpsj" class="easyui-combobox" name="fpsj"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> &nbsp; <input type="checkbox" name="orderOption" value="APP_ID" />流水号
						<select id="APP_ID" class="easyui-combobox" name="APP_ID"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> &nbsp; <input type="checkbox" name="orderOption" value="kssq" />快速申请
						<select id="kssq" class="easyui-combobox" name="kssq"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> &nbsp; <input type="checkbox" name="orderOption" value="vip" />VIP
						<select id="vip" class="easyui-combobox" name="vip"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> &nbsp; <input type="checkbox" name="orderOption" value="C1_CONAME" />单位名称
						<select id="C1_CONAME" class="easyui-combobox" name="C1_CONAME"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> &nbsp; <input type="checkbox" name="orderOption" value="bjwc" />补件完成
						<select id="bjwc" class="easyui-combobox" name="bjwc"
							style="width: 70px;">
							<option value="asc">正序</option>
							<option value="desc">倒序</option>
						</select> -->
					</div>
				</fieldset>
				<div align="center" style="padding: 0px 20px 10px 0px">
					<a href="javascript:checkAndSearchTab('seachForm','tblSeach');"
						class="easyui-linkbutton" iconCls="icon-search">搜索</a>&nbsp;&nbsp;&nbsp;<a id="addcomment" href="javascript:opAddWind()" class="easyui-linkbutton">添加备注</a>
				</div>
			</div>
		</form>
		<div style="margin: 0px 0px 0px 10px; width: 1380px">
			<table id="tblSeach" class="easyui-datagrid"
				style="width: 99%; height: 500px" data-options="remoteSort:false,rownumbers:true,singleSelect:true,pagination:true,pageSize:15,pageList:[15,20,50],fitColumns:true,loadMsg:'数据加载中.....',method:'post',toolbar:'#seachCondion'">
				<thead>
					<tr>
						<th field="ck" checkbox="true">操作</th>
						<th field="appId" align="left" data-options="formatter:formatappid">流水号</th>
						<th field="c1Cname" align="left" sortable="true">客户姓名</th>
						<th field="c1Idnbr" align="left" sortable="true">证件号码</th>
						<th field="c1Coname" align="left" sortable="true">单位名称</th>
						<th field="groDate" align="left" sortable="true">分组天数</th>
						<th field="queDate" align="left" sortable="true">进入队列天数</th>
						<th field="quickCardFlag" align="left" sortable="true" data-options="formatter:formatC4RushFlg">快速审批标识</th>
						<th field="telcheckResult" align="left" sortable="true">电核情况</th>
						<th field="teamTelcheckStatus" align="left" sortable="true">集体电核</th>
						<th field="patchStatus" align="left" sortable="true">提示</th>
						<th field="remark" align="left" sortable="true" data-options="formatter:formatremark">备注</th>
						<th field="lastOptUser" align="left" sortable="true">最后操作员</th>
						<th field="lastOptTime" align="left" sortable="true">最后操作时间</th>
						<th field="ydjFlag" hidden="true">易达金标示</th>
					</tr>
				</thead>
			</table>
		</div>



	</div>
	<div id="dd"></div>
	<div id="ddd"></div>
	<!-- <div align="center">
		<a id="addcomment" href="javascript:opAddWind()"
			class="easyui-linkbutton">添加备注</a> <a href="javascript:opAddWind1()"
			class="easyui-linkbutton">授信审批</a> <a href="javascript:opAddWind()"
			class="easyui-linkbutton">补件</a>
	</div> -->
</body>
<script type="text/javascript">
	var ydjFlag='';//易达金标识  1易达金 2标准卡 
	var delStatus='';//人工处理状态 0未完成 1已完成  ...
	var tblObj=$("#tblSeach");
	$(function (){
		var url = location.href;
		delStatus = url.split("=")[1];
		var urlZeroLength=url.split("=")[0].length;
		ydjFlag=url.split("=")[0].substring(urlZeroLength-1,urlZeroLength);
		if(ydjFlag!='1'&&ydjFlag!='2'){
			ydjFlag='';
		}
		var opts = tblObj.datagrid("options");
		opts.url = "/opas-naps/BizInpAppl_zx_list.json";
		var s={"delStatus":delStatus,"currNode":"05","ydjFlag":ydjFlag,"currStatus":"0"};
		tblObj.datagrid("reload", s);
	});
	function formatremark(val, row, index) {
		if(val==0){
			return "";
		}else{
			return "<a href=javascript:opWind();>查看</a>";
		}
	} 
	
	/* function formatappid(val, row, index) {
		return "<a href=javascript:ViewPage('credit_control.html');>"+val+"</a>";
	} */ 
	function formatappid(val, row, index) {
		var check_number=row.appId;
		var autoId=row.invest_autoId;
		return "<a href=javascript:ViewPage('credit_cheat_Investigation_control.html?check_number="+check_number+"&autoId="+autoId+"&node=2');>"+check_number+"</a>";
	} 
	function formatC4RushFlg(val, row, index) {
		if(val==2){
			return "是";
		}else if(val==1){
			return "是";
		}else{
			return "";
		}
	}
	function ViewPage(url){
		var appId = $("#tblSeach").datagrid("getSelected").appId;
		//parent.addTab('审查详情','html/examine/examine_detail.html','56e85d5402d647b39c319730605dc5a8');
		window.open(url+"?appid="+appId,"_blank","channelmode=yes",false);
			
	};
	function opWind() {
		var appId = $("#tblSeach").datagrid("getSelected").appId;
		var opts = $.extend({
			title : '查看备注',
			showType : 'show',
			showSpeed : 400,
			top : 100,
			modal : false,
			onOpen : function() {
				$.messager.progress('close');
			},
			onClose : function() {
				processInsNo = "";
				$(this).dialog('destroy');
				$(this).appendTo($("body"));
			}
		}, {});
		opts.content = '<iframe id="" src="../common/comment.html?appId='+appId+'" allowTransparency="true" scrolling="auto" width="560px" height="500px" frameBorder="0" name=""></iframe>';
		$('#dd').dialog(opts);
		var src = $('div>iframe').attr("src");
		$('#dd').dialog('refresh');
	}
	
	function opAddWind() {
		var sel = $("#tblSeach").datagrid("getSelected");
		if(sel==null){
			alert("请选择!");
		}else{
			var opts = $.extend({
				title : '添加备注',
				showType : 'show',
				showSpeed : 400,
				top : 100,
				modal : false,
				onOpen : function() {
					$.messager.progress('close');
				},
				onClose : function() {
					processInsNo = "";
					$(this).dialog('destroy');
					$(this).appendTo($("body"));
				}
			}, {});
			opts.content = '<iframe id="" src="../common/add_comment.html?sel='+sel.appId+'" allowTransparency="true" width="260px" height="200px" frameBorder="0" name=""></iframe>';
			$('#ddd').dialog(opts);
			var src = $('div>iframe').attr("src");
			$('#ddd').dialog('refresh');
		}
	}
	
	//关闭页面
	function close() {
		$("#dd").window('close');
		$("#ddd").window('close');
	}
	function closeAddComment() {
		$("#ddd").window('close');
	}
	function checkAndSearchTab(formName, tblName) {
		//本方法自己拼装json串传给后台，注意前台多选框取值以及下拉框取值写法以及后台接收的写法
		var lsh=$("#lsh").val();
		var khxm=$("#khxm").val();
		var zjhm=$("#zjhm").val();
		var dwmc=$("#dwmc").val();
		var checkStr="";
		$("input[name='orderOption']:checked").each(function () {
			var checkValue = $(this).val(); //获取选中的标签值
			//这一句是难点，注意看上面定义的元素的属性，以及easyui下拉框取值的写法
			checkStr += checkValue + " "+$("#"+checkValue).combobox('getValue')+",";
		});
		var tblObj = $("#" + tblName + "");
		var formObj = $("#" + formName + "");
		var data = formObj.serializeArray();
		var jsonData = common.formToJson(data);
		var s ={"lsh":lsh,"khxm":khxm,"zjhm":zjhm,"dwmc":dwmc,"checkStr":checkStr};
		var opts = $("#tblSeach").datagrid("options");
		opts.url = "/opas-naps/BizInpAppl_zx_list.json";
		tblObj.datagrid("reload", s);
		
	}
	

</script>
</html>
